<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - LyDian Ultra Pro</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="/styles/common.css" rel="stylesheet">

    <style>
        /* SETTINGS SPECIFIC STYLES */
        .settings-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2rem;
            height: calc(100vh - 80px);
        }

        .settings-sidebar {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            padding: 1.5rem;
            height: fit-content;
        }

        .settings-nav {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .nav-item {
            margin-bottom: 0.5rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            color: var(--text-secondary);
            text-decoration: none;
            transition: var(--transition);
            cursor: pointer;
        }

        .nav-link:hover,
        .nav-link.active {
            background: var(--hover-bg);
            color: var(--text-primary);
        }

        .nav-link.active {
            background: var(--accent-primary);
            color: var(--bg-primary);
        }

        .settings-content {
            background: var(--bg-secondary);
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            padding: 2rem;
            overflow-y: auto;
        }

        .settings-section {
            display: none;
        }

        .settings-section.active {
            display: block;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .section-description {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .setting-group {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        .setting-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .setting-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .setting-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .setting-control {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
        }

        .toggle-switch {
            position: relative;
            width: 48px;
            height: 24px;
            background: var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .toggle-switch.active {
            background: var(--accent-primary);
        }

        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: var(--transition);
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(24px);
        }

        .btn-group {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .btn {
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .btn:hover {
            background: var(--hover-bg);
            border-color: var(--accent-primary);
        }

        .btn.primary {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: var(--bg-primary);
        }

        .btn.primary:hover {
            background: var(--accent-secondary);
        }

        .btn.danger {
            background: #ef4444;
            border-color: #ef4444;
            color: white;
        }

        .btn.danger:hover {
            background: #dc2626;
        }

        /* 2FA SPECIFIC STYLES */
        .qr-code-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            padding: 2rem;
            background: var(--bg-primary);
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            margin: 1rem 0;
        }

        .qr-code {
            width: 200px;
            height: 200px;
            background: white;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-size: 0.875rem;
        }

        .manual-key {
            background: var(--bg-primary);
            padding: 1rem;
            border-radius: var(--radius);
            border: 1px solid var(--border-color);
            font-family: monospace;
            word-break: break-all;
            margin: 1rem 0;
        }

        .backup-codes {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .backup-code {
            padding: 0.5rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-family: monospace;
            text-align: center;
        }

        /* PROFILE PICTURE */
        .profile-picture-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .profile-picture {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--bg-primary);
            font-size: 2rem;
            font-weight: 600;
        }

        .upload-btn {
            background: none;
            border: 1px solid var(--border-color);
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            color: var(--text-primary);
            cursor: pointer;
            font-size: 0.875rem;
        }

        .upload-btn:hover {
            background: var(--hover-bg);
        }

        /* API KEYS SECTION */
        .api-key-item {
            display: flex;
            justify-content: between;
            align-items: center;
            padding: 1rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            margin-bottom: 1rem;
        }

        .api-key-info {
            flex: 1;
        }

        .api-key-name {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .api-key-value {
            font-family: monospace;
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .api-key-actions {
            display: flex;
            gap: 0.5rem;
        }

        /* DANGER ZONE */
        .danger-zone {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .danger-zone-title {
            color: #ef4444;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .danger-zone-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }
    </style>
</head>

<body>
    <div class="main-content">
        <!-- HEADER -->
        <div class="header">
            <button class="sidebar-toggle" onclick="goBack()">
                <i class="ph ph-arrow-left"></i>
            </button>
            <div class="header-title">Settings</div>
            <div class="system-status">
                <div class="status-indicator"></div>
                <div class="status-text">System operational</div>
            </div>
        </div>

        <!-- SETTINGS CONTAINER -->
        <div class="settings-container" style="padding: 2rem;">
            <!-- SIDEBAR -->
            <div class="settings-sidebar">
                <ul class="settings-nav">
                    <li class="nav-item">
                        <a class="nav-link active" onclick="showSection('profile')">
                            <i class="ph ph-user"></i>
                            Profile
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('security')">
                            <i class="ph ph-shield-check"></i>
                            Security
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('notifications')">
                            <i class="ph ph-bell"></i>
                            Notifications
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('ai-models')">
                            <i class="ph ph-brain"></i>
                            AI Models
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('api-keys')">
                            <i class="ph ph-key"></i>
                            API Keys
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('preferences')">
                            <i class="ph ph-gear"></i>
                            Preferences
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('billing')">
                            <i class="ph ph-credit-card"></i>
                            Billing
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="showSection('advanced')">
                            <i class="ph ph-wrench"></i>
                            Advanced
                        </a>
                    </li>
                </ul>
            </div>

            <!-- CONTENT -->
            <div class="settings-content">
                <!-- PROFILE SECTION -->
                <div class="settings-section active" id="profile">
                    <div class="section-title">Profile Settings</div>
                    <div class="section-description">
                        Manage your personal information and profile preferences.
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Profile Picture</div>
                        <div class="setting-description">Upload a profile picture to personalize your account.</div>
                        <div class="profile-picture-container">
                            <div class="profile-picture" id="profilePicture">JD</div>
                            <div>
                                <button class="upload-btn" onclick="uploadProfilePicture()">
                                    <i class="ph ph-upload"></i>
                                    Upload Photo
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Personal Information</div>
                        <div class="setting-description">Update your personal details.</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                            <input type="text" class="form-input" placeholder="First Name" id="firstName" value="John">
                            <input type="text" class="form-input" placeholder="Last Name" id="lastName" value="Doe">
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <input type="email" class="form-input" placeholder="Email" id="email" value="john.doe@company.com">
                        </div>
                        <div style="margin-bottom: 1rem;">
                            <input type="text" class="form-input" placeholder="Username" id="username" value="johndoe">
                        </div>
                        <div class="btn-group">
                            <button class="btn primary" onclick="saveProfile()">Save Changes</button>
                            <button class="btn" onclick="resetProfile()">Reset</button>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Organization</div>
                        <div class="setting-description">Your organization and role information.</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <input type="text" class="form-input" placeholder="Department" id="department" value="Engineering">
                            <input type="text" class="form-input" placeholder="Job Title" id="jobTitle" value="Senior Developer">
                        </div>
                    </div>
                </div>

                <!-- SECURITY SECTION -->
                <div class="settings-section" id="security">
                    <div class="section-title">Security Settings</div>
                    <div class="section-description">
                        Protect your account with strong security measures.
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Change Password</div>
                        <div class="setting-description">Update your password to keep your account secure.</div>
                        <div style="margin-bottom: 1rem;">
                            <input type="password" class="form-input" placeholder="Current Password" id="currentPassword">
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                            <input type="password" class="form-input" placeholder="New Password" id="newPassword">
                            <input type="password" class="form-input" placeholder="Confirm Password" id="confirmPassword">
                        </div>
                        <button class="btn primary" onclick="changePassword()">Update Password</button>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Two-Factor Authentication</div>
                        <div class="setting-description">Add an extra layer of security to your account.</div>
                        <div class="setting-control">
                            <div>
                                <strong>2FA Status:</strong>
                                <span id="twoFactorStatus" style="color: #ef4444;">Disabled</span>
                            </div>
                            <button class="btn primary" id="twoFactorBtn" onclick="setup2FA()">Enable 2FA</button>
                        </div>

                        <!-- 2FA Setup (hidden by default) -->
                        <div id="twoFactorSetup" style="display: none;">
                            <div class="qr-code-container">
                                <div class="qr-code" id="qrCode">
                                    QR Code will appear here
                                </div>
                                <p>Scan this QR code with your authenticator app</p>
                            </div>

                            <div class="setting-title">Manual Entry Key</div>
                            <div class="manual-key" id="manualKey">
                                ABCD EFGH IJKL MNOP QRST UVWX YZ12 3456
                            </div>

                            <div style="margin: 1rem 0;">
                                <input type="text" class="form-input" placeholder="Enter 6-digit code from your app" id="verificationCode">
                            </div>

                            <div class="btn-group">
                                <button class="btn primary" onclick="verify2FA()">Verify & Enable</button>
                                <button class="btn" onclick="cancel2FA()">Cancel</button>
                            </div>
                        </div>

                        <!-- Backup Codes (shown after 2FA is enabled) -->
                        <div id="backupCodes" style="display: none;">
                            <div class="setting-title">Backup Codes</div>
                            <div class="setting-description">Save these backup codes in a safe place. You can use them to access your account if you lose your authenticator device.</div>
                            <div class="backup-codes">
                                <div class="backup-code">12345678</div>
                                <div class="backup-code">87654321</div>
                                <div class="backup-code">11111111</div>
                                <div class="backup-code">22222222</div>
                                <div class="backup-code">33333333</div>
                                <div class="backup-code">44444444</div>
                                <div class="backup-code">55555555</div>
                                <div class="backup-code">66666666</div>
                                <div class="backup-code">77777777</div>
                                <div class="backup-code">88888888</div>
                            </div>
                            <button class="btn" onclick="downloadBackupCodes()">Download Codes</button>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Session Management</div>
                        <div class="setting-description">Manage your active sessions and devices.</div>
                        <div id="activeSessions">
                            <!-- Sessions will be populated here -->
                        </div>
                        <button class="btn danger" onclick="terminateAllSessions()">Terminate All Other Sessions</button>
                    </div>
                </div>

                <!-- NOTIFICATIONS SECTION -->
                <div class="settings-section" id="notifications">
                    <div class="section-title">Notification Settings</div>
                    <div class="section-description">
                        Configure how and when you receive notifications.
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Email Notifications</div>
                        <div class="setting-control">
                            <span>System updates and security alerts</span>
                            <div class="toggle-switch active" onclick="toggleSetting(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Push Notifications</div>
                        <div class="setting-control">
                            <span>Real-time notifications in browser</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">AI Model Alerts</div>
                        <div class="setting-control">
                            <span>Notifications when AI models are updated</span>
                            <div class="toggle-switch active" onclick="toggleSetting(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI MODELS SECTION -->
                <div class="settings-section" id="ai-models">
                    <div class="section-title">AI Model Preferences</div>
                    <div class="section-description">
                        Configure your preferred AI models and settings.
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Default Model</div>
                        <div class="setting-control">
                            <select class="form-select" id="defaultModel">
                                <option value="azure-gpt-4o">Azure GPT-4 Omni</option>
                                <option value="claude-3.5-sonnet" selected>Claude-3.5 Sonnet</option>
                                <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                <option value="gemini-2.0-flash">Gemini-2.0 Flash</option>
                            </select>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Response Style</div>
                        <div class="setting-control">
                            <select class="form-select" id="responseStyle">
                                <option value="balanced">Balanced</option>
                                <option value="creative">Creative</option>
                                <option value="precise">Precise</option>
                                <option value="detailed">Detailed</option>
                            </select>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Auto-save Conversations</div>
                        <div class="setting-control">
                            <span>Automatically save all conversations</span>
                            <div class="toggle-switch active" onclick="toggleSetting(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- API KEYS SECTION -->
                <div class="settings-section" id="api-keys">
                    <div class="section-title">API Keys</div>
                    <div class="section-description">
                        Manage your API keys for external integrations.
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Your API Keys</div>
                        <div id="apiKeysList">
                            <div class="api-key-item">
                                <div class="api-key-info">
                                    <div class="api-key-name">Production API Key</div>
                                    <div class="api-key-value">ak_live_********************************</div>
                                </div>
                                <div class="api-key-actions">
                                    <button class="btn" onclick="copyApiKey('ak_live_********************************')">
                                        <i class="ph ph-copy"></i>
                                    </button>
                                    <button class="btn danger" onclick="revokeApiKey('ak_live_prod')">
                                        <i class="ph ph-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button class="btn primary" onclick="generateApiKey()">Generate New API Key</button>
                    </div>
                </div>

                <!-- PREFERENCES SECTION -->
                <div class="settings-section" id="preferences">
                    <div class="section-title">Preferences</div>
                    <div class="section-description">
                        Customize your experience with LyDian Ultra Pro.
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Theme</div>
                        <div class="setting-control">
                            <select class="form-select" id="theme">
                                <option value="dark" selected>Dark</option>
                                <option value="light">Light</option>
                                <option value="auto">Auto</option>
                            </select>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Language</div>
                        <div class="setting-control">
                            <select class="form-select" id="language">
                                <option value="tr" selected>Türkçe</option>
                                <option value="en">English</option>
                                <option value="es">Español</option>
                                <option value="fr">Français</option>
                            </select>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Sidebar Default State</div>
                        <div class="setting-control">
                            <span>Open sidebar by default</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- BILLING SECTION -->
                <div class="settings-section" id="billing">
                    <div class="section-title">Billing & Usage</div>
                    <div class="section-description">
                        View your subscription and usage information.
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Current Plan</div>
                        <div style="padding: 1rem; background: var(--bg-primary); border-radius: var(--radius); border: 1px solid var(--border-color);">
                            <div style="font-weight: 600; color: var(--accent-primary);">Enterprise Plan</div>
                            <div style="color: var(--text-secondary); font-size: 0.875rem;">Unlimited AI models and advanced features</div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Usage This Month</div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div style="padding: 1rem; background: var(--bg-primary); border-radius: var(--radius); border: 1px solid var(--border-color);">
                                <div style="font-weight: 600;">API Calls</div>
                                <div style="font-size: 1.5rem; color: var(--accent-primary);">12,847</div>
                            </div>
                            <div style="padding: 1rem; background: var(--bg-primary); border-radius: var(--radius); border: 1px solid var(--border-color);">
                                <div style="font-weight: 600;">Tokens Used</div>
                                <div style="font-size: 1.5rem; color: var(--accent-primary);">2.4M</div>
                            </div>
                            <div style="padding: 1rem; background: var(--bg-primary); border-radius: var(--radius); border: 1px solid var(--border-color);">
                                <div style="font-weight: 600;">Storage</div>
                                <div style="font-size: 1.5rem; color: var(--accent-primary);">847 MB</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ADVANCED SECTION -->
                <div class="settings-section" id="advanced">
                    <div class="section-title">Advanced Settings</div>
                    <div class="section-description">
                        Advanced configuration options for power users.
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Developer Mode</div>
                        <div class="setting-control">
                            <span>Enable advanced developer features</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Debug Logging</div>
                        <div class="setting-control">
                            <span>Enable detailed debug logs</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <div class="setting-title">Export Data</div>
                        <div class="setting-description">Export all your data including conversations, settings, and usage history.</div>
                        <button class="btn" onclick="exportData()">
                            <i class="ph ph-download"></i>
                            Export All Data
                        </button>
                    </div>

                    <div class="danger-zone">
                        <div class="danger-zone-title">Danger Zone</div>
                        <div class="danger-zone-description">
                            These actions cannot be undone. Please proceed with caution.
                        </div>
                        <div class="btn-group">
                            <button class="btn danger" onclick="deleteAllData()">Delete All Data</button>
                            <button class="btn danger" onclick="deleteAccount()">Delete Account</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // GLOBAL STATE
        let currentSection = 'profile';
        let twoFactorEnabled = false;

        // INITIALIZATION
        document.addEventListener('DOMContentLoaded', () => {
            loadUserSettings();
            loadActiveSessions();
        });

        // NAVIGATION
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.settings-section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionId).classList.add('active');

            // Add active class to selected nav link
            event.target.classList.add('active');

            currentSection = sectionId;
        }

        // PROFILE FUNCTIONS
        function uploadProfilePicture() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    console.log('Uploading profile picture:', file.name);
                    alert('Profile picture uploaded successfully!');
                }
            };
            input.click();
        }

        function saveProfile() {
            const profileData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                username: document.getElementById('username').value,
                department: document.getElementById('department').value,
                jobTitle: document.getElementById('jobTitle').value
            };

            console.log('Saving profile:', profileData);
            alert('Profile saved successfully!');
        }

        function resetProfile() {
            if (confirm('Are you sure you want to reset your profile changes?')) {
                loadUserSettings();
            }
        }

        // SECURITY FUNCTIONS
        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                alert('Please fill in all password fields.');
                return;
            }

            if (newPassword !== confirmPassword) {
                alert('New passwords do not match.');
                return;
            }

            if (newPassword.length < 8) {
                alert('Password must be at least 8 characters long.');
                return;
            }

            console.log('Changing password...');
            alert('Password changed successfully!');

            // Clear form
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        function setup2FA() {
            if (twoFactorEnabled) {
                if (confirm('Are you sure you want to disable 2FA? This will make your account less secure.')) {
                    disable2FA();
                }
                return;
            }

            document.getElementById('twoFactorSetup').style.display = 'block';
            document.getElementById('twoFactorBtn').textContent = 'Cancel Setup';
            document.getElementById('twoFactorBtn').onclick = cancel2FA;

            // Simulate QR code generation
            document.getElementById('qrCode').innerHTML = '<i class="ph ph-qr-code" style="font-size: 4rem;"></i>';
        }

        function verify2FA() {
            const code = document.getElementById('verificationCode').value;

            if (!code || code.length !== 6) {
                alert('Please enter a valid 6-digit code.');
                return;
            }

            // Simulate verification
            console.log('Verifying 2FA code:', code);

            twoFactorEnabled = true;
            document.getElementById('twoFactorStatus').textContent = 'Enabled';
            document.getElementById('twoFactorStatus').style.color = 'var(--accent-primary)';
            document.getElementById('twoFactorBtn').textContent = 'Disable 2FA';
            document.getElementById('twoFactorBtn').onclick = setup2FA;

            document.getElementById('twoFactorSetup').style.display = 'none';
            document.getElementById('backupCodes').style.display = 'block';

            alert('2FA enabled successfully! Please save your backup codes.');
        }

        function cancel2FA() {
            document.getElementById('twoFactorSetup').style.display = 'none';
            document.getElementById('twoFactorBtn').textContent = 'Enable 2FA';
            document.getElementById('twoFactorBtn').onclick = setup2FA;
            document.getElementById('verificationCode').value = '';
        }

        function disable2FA() {
            twoFactorEnabled = false;
            document.getElementById('twoFactorStatus').textContent = 'Disabled';
            document.getElementById('twoFactorStatus').style.color = '#ef4444';
            document.getElementById('twoFactorBtn').textContent = 'Enable 2FA';
            document.getElementById('twoFactorBtn').onclick = setup2FA;
            document.getElementById('backupCodes').style.display = 'none';

            alert('2FA disabled successfully.');
        }

        function downloadBackupCodes() {
            const codes = Array.from(document.querySelectorAll('.backup-code')).map(el => el.textContent);
            const content = 'LyDian Ultra Pro - Backup Codes\n\n' + codes.join('\n');

            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'LyDian-backup-codes.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        function terminateAllSessions() {
            if (confirm('Are you sure you want to terminate all other sessions? You will need to log in again on other devices.')) {
                console.log('Terminating all sessions...');
                alert('All other sessions terminated successfully.');
                loadActiveSessions();
            }
        }

        // UTILITY FUNCTIONS
        function toggleSetting(element) {
            element.classList.toggle('active');
        }

        function generateApiKey() {
            const keyName = prompt('Enter a name for this API key:');
            if (keyName) {
                const newKey = 'ak_live_' + Math.random().toString(36).substr(2, 32);
                console.log('Generated new API key:', newKey);
                alert(`New API key generated: ${newKey}\n\nMake sure to copy it now - you won't be able to see it again!`);
                loadApiKeys();
            }
        }

        function copyApiKey(key) {
            navigator.clipboard.writeText(key).then(() => {
                alert('API key copied to clipboard!');
            });
        }

        function revokeApiKey(keyId) {
            if (confirm('Are you sure you want to revoke this API key? Applications using this key will stop working.')) {
                console.log('Revoking API key:', keyId);
                alert('API key revoked successfully.');
                loadApiKeys();
            }
        }

        function exportData() {
            if (confirm('This will export all your data including conversations, settings, and usage history. Continue?')) {
                console.log('Exporting user data...');
                alert('Data export started. You will receive an email when it\'s ready for download.');
            }
        }

        function deleteAllData() {
            const confirmation = prompt('Type "DELETE ALL DATA" to confirm this action:');
            if (confirmation === 'DELETE ALL DATA') {
                console.log('Deleting all user data...');
                alert('All data deletion initiated. This process cannot be undone.');
            }
        }

        function deleteAccount() {
            const confirmation = prompt('Type "DELETE MY ACCOUNT" to confirm this action:');
            if (confirmation === 'DELETE MY ACCOUNT') {
                console.log('Deleting user account...');
                alert('Account deletion initiated. You will receive a confirmation email.');
            }
        }

        function loadUserSettings() {
            // Load user settings from API or localStorage
            console.log('Loading user settings...');
        }

        function loadActiveSessions() {
            const sessionsContainer = document.getElementById('activeSessions');
            sessionsContainer.innerHTML = `
                <div style="padding: 1rem; background: var(--bg-primary); border-radius: var(--radius); border: 1px solid var(--border-color); margin-bottom: 0.5rem;">
                    <div style="display: flex; justify-content: between; align-items: center;">
                        <div>
                            <strong>Current Session</strong>
                            <div style="color: var(--text-secondary); font-size: 0.875rem;">Chrome on MacOS • Active now</div>
                        </div>
                        <span style="color: var(--accent-primary); font-size: 0.875rem;">Current</span>
                    </div>
                </div>
                <div style="padding: 1rem; background: var(--bg-primary); border-radius: var(--radius); border: 1px solid var(--border-color);">
                    <div style="display: flex; justify-content: between; align-items: center;">
                        <div>
                            <strong>Mobile Session</strong>
                            <div style="color: var(--text-secondary); font-size: 0.875rem;">Safari on iPhone • 2 hours ago</div>
                        </div>
                        <button class="btn danger" style="padding: 0.5rem;">Terminate</button>
                    </div>
                </div>
            `;
        }

        function loadApiKeys() {
            // Refresh API keys list
            console.log('Refreshing API keys list...');
        }

        function goBack() {
            window.location.href = '/';
        }
    </script>
</body>
</html>