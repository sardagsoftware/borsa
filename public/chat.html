<!-- Cache-Buster: 1759577324 --><!doctype html>
<html lang="tr">
  <head>
    <link rel="dns-prefetch" href="https://www.googletagmanager.com" />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover, interactive-widget=resizes-content"
    />

    <!-- Favicon - Lydian Grape Logo -->
    <link rel="icon" type="image/svg+xml" href="/icons/grape-icon-simple.svg" />
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/grape-favicon-16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/grape-favicon-32.png" />
    <link rel="icon" type="image/png" sizes="48x48" href="/icons/grape-favicon-48.png" />
    <link rel="icon" type="image/x-icon" href="/icons/grape-favicon.ico" />
    <link rel="shortcut icon" href="/icons/grape-favicon.ico" />
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-180.png" />

    <!-- GeoIP Auto-Language Detection (MUST BE FIRST) -->
    <script src="/js/geo-language.js"></script>

    <!-- Premium Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="" />
    <!-- Fonts - Inline critical fonts for instant load -->
    <style>
      /* Righteous font for Logo - Inline for instant load */
      @font-face {
        font-family: 'Righteous';
        font-style: normal;
        font-weight: 400;
        font-display: block;
        src: url(https://fonts.gstatic.com/s/righteous/v14/1cXxaUPXBpj2rGoU7C9WhnGFucE.woff2)
          format('woff2');
        unicode-range:
          U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F,
          U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
      }
    </style>
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&amp;family=JetBrains+Mono:wght@400;500;600;700&amp;family=Orbitron:wght@400;500;600;700;800;900&amp;family=Righteous&amp;display=swap"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&amp;family=JetBrains+Mono:wght@400;500;600;700&amp;family=Orbitron:wght@400;500;600;700;800;900&amp;family=Righteous&amp;display=swap"
      rel="stylesheet"
      crossorigin="anonymous"
    />

    <style>
      /* ============================================================
   ‚ú® CLEAN WHITE PREMIUM CHAT INTERFACE 2025
   ============================================================ */

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        /* Premium Neon Black Color System */
        --bg-0: #0a0b0d;
        --bg-1: #111214;
        --glass: rgba(255, 255, 255, 0.05);
        --glass-2: rgba(255, 255, 255, 0.03);
        --stroke: rgba(255, 255, 255, 0.08);
        --txt-1: #ffffff;
        --txt-2: #b0b0b0;
        --accent-1: #00e0ae; /* Neon green */
        --accent-2: #6e84ff; /* Electric blue */
        --accent-3: #b86bff; /* Purple */
        --warning: #fdb022; /* Gold warning */

        /* Neon Gradients */
        --gradient-primary: linear-gradient(135deg, var(--accent-1), var(--accent-2));
        --gradient-subtle: linear-gradient(
          135deg,
          rgba(0, 224, 174, 0.1),
          rgba(110, 132, 255, 0.1)
        );
        --gradient-accent: linear-gradient(
          135deg,
          rgba(0, 224, 174, 0.15),
          rgba(110, 132, 255, 0.15)
        );

        /* Background System */
        --bg-primary: var(--bg-0);
        --bg-secondary: var(--bg-1);
        --bg-tertiary: var(--glass);
        --bg-hover: var(--glass);

        /* Text Colors */
        --text-primary: var(--txt-1);
        --text-secondary: var(--txt-2);
        --text-tertiary: #888888;
        --text-muted: #666666;

        /* Neon Shadows */
        --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.3);
        --shadow-base: 0 8px 24px rgba(0, 0, 0, 0.4);
        --shadow-md: 0 12px 32px rgba(0, 0, 0, 0.5);
        --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.6);
        --shadow-xl: 0 24px 64px rgba(0, 0, 0, 0.7);
        --shadow-green: 0 8px 24px rgba(0, 224, 174, 0.3);
        --shadow-orange: 0 8px 24px rgba(110, 132, 255, 0.3);
        --shadow-hover: 0 12px 32px rgba(0, 224, 174, 0.25);
        --shadow-neon: 0 0 20px rgba(0, 224, 174, 0.5);

        /* Borders */
        --border-light: 1px solid var(--stroke);
        --border-medium: 1px solid rgba(255, 255, 255, 0.12);
        --border-green: 1px solid var(--accent-1);
        --border-orange: 1px solid var(--accent-2);
      }

      /* ============================================================
   üåä KEYFRAME ANIMATIONS
   ============================================================ */

      @keyframes gradientFlow {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      @keyframes borderRotate {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes hoverLift {
        0% {
          transform: translateY(0);
          box-shadow:
            0 1px 3px 0 rgba(0, 0, 0, 0.1),
            0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        100% {
          transform: translateY(-2px);
          box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }
      }

      @keyframes borderShine {
        0%,
        100% {
          border-color: #10a37f;
        }
        50% {
          border-color: #ff6b4a;
        }
      }

      @keyframes neonPulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes slideOutLeft {
        from {
          opacity: 1;
          transform: translateX(0);
          max-height: 100px;
        }
        to {
          opacity: 0;
          transform: translateX(-20px);
          max-height: 0;
          padding-top: 0;
          padding-bottom: 0;
          margin-bottom: 0;
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes fadeInScale {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes messageAppear {
        from {
          opacity: 0;
          transform: translateY(20px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      @keyframes typingDot {
        0%,
        60%,
        100% {
          transform: translateY(0);
          opacity: 0.4;
        }
        30% {
          transform: translateY(-12px);
          opacity: 1;
        }
      }

      @keyframes floatParticle {
        0% {
          transform: translateY(100vh) translateX(0) rotate(0deg);
          opacity: 0;
        }
        10% {
          opacity: 1;
        }
        90% {
          opacity: 1;
        }
        100% {
          transform: translateY(-100vh) translateX(100px) rotate(360deg);
          opacity: 0;
        }
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      @keyframes shimmer {
        0% {
          background-position: -1000px 0;
        }
        100% {
          background-position: 1000px 0;
        }
      }

      @keyframes scaleIn {
        from {
          transform: scale(0);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      @keyframes buttonPress {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(0.95);
        }
        100% {
          transform: scale(1);
        }
      }

      @keyframes subtleGlow {
        0%,
        100% {
          box-shadow:
            0 1px 3px 0 rgba(0, 0, 0, 0.1),
            0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        50% {
          box-shadow:
            0 4px 6px -1px rgba(0, 0, 0, 0.1),
            0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
      }

      /* üîÑ Loading dots animation */
      .loading-dots {
        display: inline-flex;
        align-items: center;
        padding: 1rem;
      }

      /* Plus dropdown show class (matches 'active' functionality) */
      .plus-dropdown.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      /* ============================================================
   üé® BASE STYLES
   ============================================================ */

      body {
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          'SF Pro Display',
          sans-serif;
        background:
          radial-gradient(1400px 900px at 70% 15%, rgba(184, 107, 255, 0.1), transparent 60%),
          radial-gradient(1200px 700px at 20% 80%, rgba(110, 132, 255, 0.1), transparent 65%),
          var(--bg-0);
        color: var(--txt-1);
        overflow: hidden;
        height: 100vh;
        position: relative;
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* ============================================================
   üìê LAYOUT
   ============================================================ */

      .chat-container {
        display: flex;
        height: 100vh;
        position: relative;
        z-index: 1;
      }

      /* ============================================================
   üéØ CLEAN SIDEBAR (MODERN & MINIMAL)
   ============================================================ */

      /* ========== SIDEBAR (Dark with WHITE text) ========== */
      .sidebar {
        width: 280px;
        background: #1a1a1a;
        border-right: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        flex-direction: column;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        z-index: 100;
        box-shadow: 4px 0 24px rgba(0, 0, 0, 0.3);
      }

      /* Force ALL sidebar text to be WHITE */
      .sidebar,
      .sidebar *,
      .sidebar-header,
      .sidebar-header *,
      .logo,
      .conversation-item,
      .conversation-item *,
      .user-name,
      .user-email {
        color: #ffffff !important;
      }

      .sidebar.collapsed {
        transform: translateX(-280px);
      }

      /* ========== PREMIUM DARK SIDEBAR HEADER ========== */
      .sidebar-header {
        padding: 1.5rem;
        border-bottom: none;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        background: transparent; /* Match chat page background - no dark area */
      }

      .logo {
        font-family: 'Inter', sans-serif !important;
        font-size: 2rem;
        font-weight: 900 !important;
        color: #ffffff; /* White text for dark theme */
        letter-spacing: 0.08em !important;
        transition: all 0.3s ease;
      }

      .logo:hover {
        transform: scale(1.05);
      }

      /* üîò Sidebar Toggle Button - Visible on desktop, inside sidebar */
      .sidebar-toggle {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        width: 40px;
        height: 40px;
        background: transparent;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: flex !important; /* Show on desktop */
        align-items: center;
        justify-content: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 101;
        padding: 0;
      }

      .sidebar-toggle:hover {
        transform: translateY(-50%) scale(1.1);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .sidebar-toggle svg {
        width: 20px;
        height: 20px;
        fill: #ffffff !important;
        transition: all 0.3s;
      }

      .sidebar-toggle img {
        width: 40px !important;
        height: 40px !important;
        border-radius: 50%;
        object-fit: cover;
      }

      .sidebar-toggle:hover svg {
        fill: #ffffff !important;
      }

      .sidebar-toggle:hover img {
        transform: scale(1.1);
      }

      .sidebar.collapsed .sidebar-toggle {
        left: 1rem !important; /* Stay visible when collapsed */
        position: fixed !important;
        z-index: 1000 !important;
        transform: translateY(-50%) translateX(280px) !important; /* Move out from collapsed sidebar */
      }

      /* Floating Open Button - Visible on Dark Background */
      .sidebar-open-btn {
        position: fixed;
        left: 1.5rem;
        top: 1.5rem;
        width: 48px;
        height: 48px;
        background: rgba(255, 255, 255, 0.15);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 14px;
        cursor: pointer;
        display: none;
        align-items: center;
        justify-content: center;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 99;
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
      }

      .sidebar.collapsed ~ .main-chat .sidebar-open-btn {
        display: flex;
      }

      .sidebar-open-btn:hover {
        background: rgba(255, 255, 255, 0.25);
        border-color: rgba(255, 255, 255, 0.5);
        transform: scale(1.1);
        box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
      }

      .sidebar-open-btn svg {
        width: 24px;
        height: 24px;
        fill: #ffffff !important;
        filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.5));
      }

      /* ‚≠ê New Chat Button - WHITE/GRAY */
      /* ========== PREMIUM NEW CHAT BUTTON (Dark Theme) ========== */
      .new-chat-btn {
        margin: 1.5rem;
        padding: 1.2rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 14px;
        color: #ffffff;
        font-weight: 700;
        font-size: 1rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-family: 'Inter', sans-serif;
        position: relative;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      .new-chat-btn:hover {
        transform: translateY(-2px) scale(1.02);
        background: rgba(255, 255, 255, 0.1);
        border-color: rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      }

      .new-chat-btn:active {
        transform: translateY(0);
      }

      .new-chat-btn svg {
        width: 20px;
        height: 20px;
        fill: none;
        stroke: #ffffff;
        position: relative;
        z-index: 1;
        transition: transform 0.3s;
      }

      .new-chat-btn:hover svg {
        transform: rotate(90deg);
      }

      .new-chat-btn span {
        position: relative;
        z-index: 1;
      }

      /* üìú Chat History */
      .chat-history {
        flex: 1;
        overflow-y: auto;
        padding: 1rem;
        scrollbar-width: thin;
        scrollbar-color: #10a37f transparent;
      }

      .chat-history::-webkit-scrollbar {
        width: 6px;
      }

      .chat-history::-webkit-scrollbar-track {
        background: transparent;
      }

      .chat-history::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        border-radius: 10px;
      }

      .chat-item {
        padding: 0.875rem 1rem;
        margin-bottom: 0.5rem;
        background: transparent; /* No background */
        border: none; /* No border */
        border-left: none;
        border-radius: 0;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        animation: slideInLeft 0.4s ease;
        box-shadow: none; /* No shadow */
        position: relative;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 0.5rem;
      }

      .chat-item:hover {
        background: rgba(31, 41, 55, 0.05); /* Very subtle hover */
        border-left: none;
        transform: translateX(2px);
        box-shadow: none;
      }

      .chat-item-content {
        flex: 1;
        min-width: 0;
      }

      .chat-item-title {
        font-weight: 600;
        font-size: 0.9rem;
        color: #1f2937;
        margin-bottom: 0.25rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .chat-item-preview {
        font-size: 0.75rem;
        color: #6b7280;
      }

      .chat-item-delete {
        width: 28px;
        height: 28px;
        background: transparent;
        border: 1px solid 1px solid #e5e7eb;
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
        opacity: 0;
        flex-shrink: 0;
      }

      .chat-item:hover .chat-item-delete {
        opacity: 1;
      }

      .chat-item-delete:hover {
        background: #8b0000; /* Dark red - same as send button */
        border-color: #8b0000;
        transform: scale(1.1);
      }

      .chat-item-delete svg {
        width: 14px;
        height: 14px;
        fill: #6b7280;
        transition: fill 0.3s;
      }

      .chat-item-delete:hover svg {
        fill: #ffffff;
      }

      /* üîç Sidebar Search */
      .sidebar-search {
        padding: 0.125rem 0.5rem;
        height: 24px;
        min-height: 24px;
        max-height: 24px;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        margin: 1rem;
        transition: all 0.3s;
      }

      .sidebar-search:focus-within {
        border-color: #10a37f;
        box-shadow: 0 2px 8px rgba(16, 163, 127, 0.15);
      }

      .sidebar-search svg {
        width: 16px;
        height: 16px;
        fill: #10a37f !important;
        stroke: none !important;
        color: #10a37f !important;
        flex-shrink: 0;
      }

      .sidebar-search input {
        flex: 1;
        border: none;
        background: transparent;
        color: #1f2937;
        font-size: 0.8rem;
        line-height: 1;
        padding: 0;
        outline: none;
      }

      .sidebar-search input::placeholder {
        color: #6b7280;
      }

      /* üë§ Sidebar Footer & User Menu */
      .sidebar-footer {
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding: 1rem;
        background: transparent;
      }

      .user-menu {
        position: relative;
      }

      /* ========== PREMIUM USER INFO (Dark Theme) ========== */
      .user-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem;
        background: rgba(255, 255, 255, 0.05); /* Subtle dark background */
        border: 1px solid rgba(255, 255, 255, 0.1); /* Light border */
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .user-info:hover {
        border-color: #10a37f; /* Green hover */
        box-shadow: 0 0 20px rgba(16, 163, 127, 0.2); /* Green glow */
        background: rgba(255, 255, 255, 0.08);
      }

      .user-avatar {
        width: 40px;
        height: 40px;
        background: transparent;
        border: 2px solid #ffffff !important;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .user-avatar svg {
        width: 24px;
        height: 24px;
        fill: none;
        stroke: #ffffff !important;
      }

      .user-details {
        flex: 1;
        min-width: 0;
      }

      .user-name {
        font-size: 0.9rem;
        font-weight: 600;
        color: #ffffff; /* White for dark theme */
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .user-email {
        font-size: 0.75rem;
        color: rgba(255, 255, 255, 0.6); /* Light gray for dark theme */
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .user-menu-arrow {
        width: 20px;
        height: 20px;
        fill: #ffffff !important;
        transition: transform 0.3s;
      }

      .user-info.active .user-menu-arrow {
        transform: rotate(180deg);
      }

      /* User Dropdown */
      .user-dropdown {
        position: absolute;
        bottom: 100%;
        left: 0;
        right: 0;
        margin-bottom: 0.5rem;
        background: #1a1a1a; /* FIXED: Solid background matching entire interface */
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 14px;
        box-shadow:
          0 20px 25px -5px rgba(0, 0, 0, 0.5),
          0 10px 10px -5px rgba(0, 0, 0, 0.3);
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 1000;
        overflow: hidden;
      }

      .user-dropdown.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .dropdown-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.875rem 1rem;
        color: #ffffff !important;
        text-decoration: none;
        font-size: 0.9rem;
        font-weight: 500;
        transition: all 0.2s;
      }

      .dropdown-item:hover {
        background: rgba(16, 163, 127, 0.1);
        color: #10a37f !important;
      }

      .dropdown-item.logout:hover {
        background: rgba(255, 107, 74, 0.1);
        color: #ff6b4a !important;
      }

      .dropdown-item svg {
        width: 20px;
        height: 20px;
        fill: currentColor;
      }

      .dropdown-divider {
        height: 1px;
        background: rgba(255, 255, 255, 0.1);
        margin: 0.5rem 0;
      }

      /* ============================================================
   üí¨ MAIN CHAT AREA
   ============================================================ */

      /* ========== PREMIUM CHAT AREA BACKGROUND (Dark Theme) ========== */
      .main-chat {
        flex: 1;
        display: flex;
        flex-direction: column;
        position: relative;
        background: #1a1a1a; /* FIXED: Solid background matching entire interface */
      }

      /* üéØ Top Header (Dark Theme) */
      .chat-header {
        padding: 1rem 2rem;
        background: #1a1a1a;
        border-bottom: none;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1.5rem;
        position: fixed;
        top: 0;
        left: 280px; /* FIXED - Account for sidebar width */
        width: calc(100% - 280px); /* FIXED - Full width minus sidebar */
        z-index: 150; /* FIXED: Higher than sidebar (100) to stay above messages */
        box-shadow: none;
        /* REMOVED: No transition, stays fixed */
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      /* Model selector removed */

      /* üìä Token Counter */
      .token-counter {
        padding: 0.75rem 1.25rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      .token-counter-label {
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.7);
        font-weight: 500;
      }

      .token-counter-value {
        font-size: 1rem;
        font-weight: 700;
        font-family: 'JetBrains Mono', monospace;
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* üîß Header Actions */
      .header-actions {
        display: flex;
        gap: 0.75rem;
        align-items: center;
      }

      .header-btn {
        min-width: 48px;
        height: 48px;
        padding: 0.75rem 1rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        font-weight: 600;
        color: #ffffff;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        white-space: nowrap;
      }

      .header-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: #10a37f;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(16, 163, 127, 0.3);
      }

      .header-btn:active {
        transform: translateY(0);
      }

      .header-btn svg {
        width: 20px;
        height: 20px;
        fill: #ffffff;
        stroke: #ffffff;
        transition: all 0.3s;
        flex-shrink: 0;
      }

      .header-btn span {
        display: inline-block;
      }

      /* Prominent Header Buttons (Download & Share) - CYAN like neon icons */
      .header-btn-prominent {
        background: transparent;
        border: 2px solid #00e0ae;
        color: #00e0ae;
        min-width: 110px;
      }

      .header-btn-prominent svg {
        fill: none;
        stroke: #00e0ae;
      }

      .header-btn-prominent:hover {
        background: transparent;
        transform: translateY(-2px) scale(1.05);
        box-shadow: none;
      }

      /* üéØ Header Buttons - Minimal Icon-Only Style */
      .header-btn-icon {
        width: 32px;
        height: 32px;
        background: transparent;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.25s ease;
        padding: 0;
      }

      .header-btn-icon svg {
        fill: #ffffff !important; /* White for dark theme */
        transition: transform 0.25s ease;
      }

      .header-btn-icon:hover {
        transform: scale(1.2);
      }

      .header-btn-icon:hover svg {
        transform: scale(1.1);
      }

      .header-btn-icon:active {
        transform: scale(0.95);
      }

      /* ============================================================
   üí≠ MESSAGES AREA
   ============================================================ */

      /* ========== GOOGLE STUDIO LAYOUT: CENTERED CHAT AREA ========== */
      .messages-container {
        flex: 1;
        overflow-y: auto;
        padding: 2rem;
        padding-top: 100px; /* Space below navbar to prevent overlap */
        padding-bottom: 180px; /* Space for fixed bottom input */
        display: flex;
        flex-direction: column;
        gap: 2rem; /* Google Studio generous spacing */
        scroll-behavior: smooth;
        scrollbar-width: thin;
        scrollbar-color: #10a37f transparent;
        /* Center chat area with max-width */
        max-width: 900px;
        margin: 0 auto;
        width: 100%;
        /* Prevent overflow above navbar */
        max-height: calc(100vh - 80px);
        position: relative;
        z-index: 1; /* Below navbar (z-index: 150) */
      }

      .messages-container::-webkit-scrollbar {
        width: 8px;
      }

      .messages-container::-webkit-scrollbar-track {
        background: transparent;
      }

      .messages-container::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        border-radius: 10px;
      }

      /* üåü Empty State */
      .empty-state {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding-top: 2rem;
        gap: 1.5rem;
        position: relative;
        animation: fadeInScale 0.6s ease;
        width: 100%;
        max-width: 900px;
        margin: 0 auto;
      }

      .particles {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        overflow: hidden;
        pointer-events: none;
      }

      .particle {
        display: none;
      }

      /* üß† NEURAL QUANTUM BRAIN LOADER - Centered in Response Area */
      .mini-spinner-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 120px;
        height: 120px;
        animation:
          fadeInScale 0.8s ease,
          floatAnimation 3s ease-in-out infinite;
        z-index: 10;
        filter: drop-shadow(0 0 24px rgba(124, 92, 255, 0.15));
      }

      .mini-spinner {
        width: 100%;
        height: 100%;
        position: relative;
        display: grid;
        place-items: center;
      }

      /* Floating animation for AI brain */
      @keyframes floatAnimation {
        0%,
        100% {
          transform: translate(-50%, -50%) translateY(0px);
        }
        50% {
          transform: translate(-50%, -50%) translateY(-10px);
        }
      }

      /* üåå LYDIAN ORBIT ANIMATION - Premium Interactive SVG Orbit */

      /* üë§ USER WELCOME TEXT - Above Orbit */
      .user-welcome-text {
        position: absolute;
        top: 20%;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        z-index: 11;
        pointer-events: none;
      }

      .welcome-user-name {
        display: none;
      }

      .welcome-message {
        font-size: 1.5rem;
        font-weight: 600;
        color: #ffffff;
        letter-spacing: 0.5px;
      }

      /* LyDian Orbit SVG Animations */
      .lydian-orbit-ring-1 {
        transform-origin: center;
        animation: orbitRotate1 36s linear infinite;
      }

      .lydian-orbit-ring-2 {
        transform-origin: center;
        animation: orbitRotate2 24s linear infinite reverse;
      }

      .lydian-orbit-ring-3 {
        transform-origin: center;
        animation: orbitRotate3 12s linear infinite;
      }

      @keyframes orbitRotate1 {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      @keyframes orbitRotate2 {
        from {
          transform: rotate(360deg);
        }
        to {
          transform: rotate(0deg);
        }
      }

      @keyframes orbitRotate3 {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(-360deg);
        }
      }

      /* Lissajous satellite motion */
      .lydian-lissajous {
        animation: lissajousFly 10s linear infinite;
      }

      @keyframes lissajousFly {
        0% {
          transform: translate(0, 0);
        }
        25% {
          transform: translate(45px, -35px);
        }
        50% {
          transform: translate(0, -60px);
        }
        75% {
          transform: translate(-45px, -35px);
        }
        100% {
          transform: translate(0, 0);
        }
      }

      /* Pyramid animations removed - replaced with LyDian Orbit */

      /* üí° Suggestion Chips */
      .suggestion-chips {
        display: none;
        animation: slideInUp 0.8s ease 0.3s both;
      }

      .suggestion-chip {
        padding: 0.875rem 1.5rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 20px;
        color: #ffffff;
        font-size: 0.9rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .suggestion-chip:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: #10a37f;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(16, 163, 127, 0.35);
        color: #10a37f;
      }

      /* ============================================================
   üí¨ MESSAGE BUBBLES (CLEAN DESIGN)
   ============================================================ */

      /* ========== ORIGINAL CENTERED LAYOUT (No Icons) ========== */
      .message {
        display: flex;
        gap: 0.75rem;
        animation: messageAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        max-width: 85%; /* Wider bubbles for better readability */
        padding: 0;
      }

      /* User messages: Right aligned */
      .message.user {
        align-self: flex-end; /* Align to right */
        flex-direction: row-reverse;
      }

      /* AI messages: Left aligned, FULL WIDTH for square/wide layout */
      .message.assistant {
        align-self: flex-start; /* Align to left */
        flex-direction: row;
        max-width: 100%; /* Full width for AI responses */
      }

      /* ========== AVATARS HIDDEN (Icon-less Layout) ========== */
      .message-avatar {
        display: none; /* Hide all avatars */
      }

      /* User Avatar: Green gradient with glow */
      .message.user .message-avatar {
        background: rgba(255, 255, 255, 0.1);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      /* AI Assistant Avatar: subtle dark */
      .message.assistant .message-avatar {
        background: rgba(255, 255, 255, 0.08);
        box-shadow:
          0 2px 4px rgba(14, 165, 233, 0.2),
          0 4px 8px rgba(16, 163, 127, 0.15),
          0 0 16px rgba(14, 165, 233, 0.2);
        position: relative;
      }

      /* Premium hover effect with rotation & glow */
      .message:hover .message-avatar {
        transform: scale(1.15) rotate(5deg);
        box-shadow:
          0 4px 8px rgba(16, 163, 127, 0.3),
          0 8px 16px rgba(16, 163, 127, 0.2),
          0 0 24px rgba(16, 163, 127, 0.3);
      }

      .message.assistant:hover .message-avatar {
        box-shadow:
          0 4px 8px rgba(14, 165, 233, 0.3),
          0 8px 16px rgba(14, 165, 233, 0.2),
          0 0 24px rgba(14, 165, 233, 0.3);
      }

      .message-avatar svg {
        width: 20px; /* Proportional to 32px avatar */
        height: 20px;
        position: relative;
        z-index: 1;
      }

      .message.user .message-avatar svg {
        fill: #ffffff; /* White on gradient */
      }

      /* Pulse animation for user icon */
      @keyframes pulse-user {
        0%,
        100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.1);
          opacity: 0.9;
        }
      }

      .message.user .message-avatar svg {
        animation: pulse-user 2s ease-in-out infinite;
      }

      .message.assistant .message-avatar svg {
        fill: none;
        stroke: #ffffff; /* White on gradient */
        stroke-width: 2;
      }

      /* Spinning orbit animation for Lydian */
      @keyframes spin-orbit {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      .message.assistant .message-avatar svg {
        animation: spin-orbit 3s linear infinite;
      }

      /* üí¨ Message Content */
      .message-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      /* üìé File Preview in Messages (ChatGPT Style) */
      .message-file-preview {
        margin-bottom: 0.5rem;
        border-radius: 12px;
        overflow: hidden;
      }

      .message-image-preview {
        max-width: 300px;
        max-height: 300px;
        border-radius: 12px;
        cursor: pointer;
        transition:
          transform 0.2s,
          box-shadow 0.2s;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .message-image-preview:hover {
        transform: scale(1.02);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      }

      .message-file-doc {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 16px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        max-width: 280px;
      }

      .message-file-doc .file-name {
        flex: 1;
        font-size: 0.9rem;
        color: #fff;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .message-file-doc .file-size {
        font-size: 0.75rem;
        color: rgba(255, 255, 255, 0.5);
      }

      /* üñºÔ∏è Image Modal */
      .image-modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 100000;
        padding: 2rem;
        animation: fadeIn 0.2s ease-out;
      }

      .image-modal-content {
        position: relative;
        max-width: 90vw;
        max-height: 90vh;
      }

      .image-modal-content img {
        max-width: 100%;
        max-height: 90vh;
        border-radius: 8px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      }

      .image-modal-close {
        position: absolute;
        top: -40px;
        right: 0;
        background: rgba(255, 255, 255, 0.1);
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        color: #fff;
        transition: background 0.2s;
      }

      .image-modal-close:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      @media (max-width: 768px) {
        .message-image-preview {
          max-width: 100%;
          max-height: 250px;
        }

        .message-file-doc {
          max-width: 100%;
        }
      }

      /* ========== MESSAGE BUBBLES (Original Style with Background) ========== */
      .message-text {
        padding: 0.75rem 1.5rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 16px;
        line-height: 1.7;
        font-size: 0.95rem;
        position: relative;
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: #ffffff;
        box-shadow:
          0 1px 2px rgba(0, 0, 0, 0.3),
          0 4px 8px rgba(0, 0, 0, 0.4),
          0 8px 16px rgba(0, 0, 0, 0.5);
      }

      .message.user .message-text {
        border-left: 4px solid rgba(255, 255, 255, 0.2);
        background: rgba(255, 255, 255, 0.05);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      .message.assistant .message-text {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-left: 4px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        /* Neon white text */
        color: #ffffff;

        font-weight: 400;
        letter-spacing: 0.01em;
      }

      /* Premium hover effect with lift & glow */
      .message:hover .message-text {
        transform: translateY(-3px) scale(1.01);
        box-shadow:
          0 4px 6px rgba(0, 0, 0, 0.1),
          0 12px 24px rgba(0, 0, 0, 0.08),
          0 24px 48px rgba(0, 0, 0, 0.06);
      }

      .message.user:hover .message-text {
        box-shadow:
          0 4px 6px rgba(16, 163, 127, 0.2),
          0 12px 24px rgba(16, 163, 127, 0.15),
          0 24px 48px rgba(16, 163, 127, 0.1);
        border-left-color: #0d8a68;
      }

      .message-text p {
        margin-bottom: 0.75rem;
      }

      .message-text p:last-child {
        margin-bottom: 0;
      }

      .message-text strong {
        font-weight: 700;
        color: #ffffff; /* Clean white, no colors */
      }

      .message-text em {
        font-style: italic;
        color: #ffffff; /* Clean white, no colors */
      }

      .message-text code {
        background: rgba(255, 255, 255, 0.08);
        padding: 0.2rem 0.5rem;
        border-radius: 6px;
        font-family: 'JetBrains Mono', monospace;
        font-size: 0.875rem;
        border: 1px solid rgba(255, 255, 255, 0.15);
        color: #ffffff; /* Clean white, no colors */
      }

      /* üïí Message Timestamp */
      .message-timestamp {
        font-size: 0.7rem;
        color: rgba(255, 255, 255, 0.6);
        margin-top: 0.5rem;
        opacity: 0.7;
        font-weight: 400;
      }

      /* üìä RESPONSE CONFIDENCE BADGE */
      .response-confidence {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-top: 0.75rem;
        margin-bottom: 0.25rem;
      }

      .confidence-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        padding: 0.35rem 0.75rem;
        font-size: 0.75rem;
        font-weight: 500;
        border-radius: 20px;
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
      }

      .confidence-badge svg {
        flex-shrink: 0;
      }

      .confidence-badge.confidence-high {
        background: rgba(16, 163, 127, 0.15);
        border: 1px solid rgba(16, 163, 127, 0.3);
        color: #10a37f;
      }

      .confidence-badge.confidence-medium {
        background: rgba(255, 193, 7, 0.15);
        border: 1px solid rgba(255, 193, 7, 0.3);
        color: #ffc107;
      }

      .confidence-badge.confidence-low {
        background: rgba(239, 68, 68, 0.15);
        border: 1px solid rgba(239, 68, 68, 0.3);
        color: #ef4444;
      }

      .research-tip {
        display: inline-flex;
        align-items: center;
        padding: 0.3rem 0.6rem;
        font-size: 0.7rem;
        font-weight: 500;
        background: rgba(139, 92, 246, 0.15);
        border: 1px solid rgba(139, 92, 246, 0.3);
        border-radius: 16px;
        color: #a78bfa;
      }

      /* ‚ö° Message Actions */
      .message-actions {
        display: flex;
        gap: 0.375rem;
        opacity: 0;
        transform: translateY(-5px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        margin-top: 0.5rem;
      }

      .message-content:hover .message-actions {
        opacity: 1;
        transform: translateY(0);
      }

      /* User message actions - align right */
      .message-actions.user-actions {
        justify-content: flex-end;
      }

      .message-action-btn {
        padding: 0.5rem 1rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 8px;
        color: rgba(255, 255, 255, 0.9);
        font-size: 0.8rem;
        font-weight: 500;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      /* Small copy button - icon only */
      .copy-btn-small {
        padding: 0.35rem !important;
        background: transparent !important;
        border: none !important;
        border-radius: 6px;
        color: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }

      .copy-btn-small:hover {
        background: rgba(255, 255, 255, 0.1) !important;
        color: rgba(255, 255, 255, 0.9);
      }

      .copy-btn-small svg {
        fill: currentColor;
      }

      .message-action-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: #10a37f;
        color: #10a37f;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(16, 163, 127, 0.3);
      }

      .message-action-btn svg {
        width: 14px;
        height: 14px;
        fill: currentColor;
      }

      /* üîÑ Typing Indicator - ChatGPT Style "D√º≈ü√ºn√ºyor..." */
      .typing-indicator {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1rem;
      }

      .typing-text {
        color: rgba(255, 255, 255, 0.8);
        font-size: 0.95rem;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 2px;
      }

      .typing-dots {
        display: inline-flex;
        gap: 2px;
        margin-left: 2px;
      }

      .typing-dots span {
        display: inline-block;
        width: 4px;
        height: 4px;
        background: #10a37f;
        border-radius: 50%;
        animation: typingDotBounce 1.4s infinite ease-in-out;
      }

      .typing-dots span:nth-child(1) {
        animation-delay: 0s;
      }
      .typing-dots span:nth-child(2) {
        animation-delay: 0.2s;
      }
      .typing-dots span:nth-child(3) {
        animation-delay: 0.4s;
      }

      @keyframes typingDotBounce {
        0%,
        60%,
        100% {
          transform: translateY(0);
          opacity: 0.4;
        }
        30% {
          transform: translateY(-4px);
          opacity: 1;
        }
      }

      /* Legacy typing dots (keeping for compatibility) */
      .typing-dot {
        width: 10px;
        height: 10px;
        background: #10a37f;
        border-radius: 50%;
        animation: typingDot 1.4s infinite;
      }

      .typing-dot:nth-child(2) {
        animation-delay: 0.2s;
      }

      .typing-dot:nth-child(3) {
        animation-delay: 0.4s;
      }

      /* ============================================================
   ‚úçÔ∏è INPUT AREA (CLEAN & MODERN)
   ============================================================ */

      /* ========== GOOGLE STUDIO LAYOUT: FIXED BOTTOM INPUT ========== */
      .input-container {
        padding: 1rem 2rem 1rem;
        position: fixed; /* Fixed at bottom like Google Studio */
        bottom: 0;
        left: 280px; /* Account for sidebar width - FIXED */
        width: calc(100% - 280px); /* Full width minus sidebar - FIXED */
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        background: #1a1a1a; /* FIXED: Solid background matching entire interface */
        border-top: none; /* Remove border for cleaner look */
        z-index: 50;
        /* REMOVED: No transition, stays fixed */
      }

      /* Input container i√ßinde empty state'de olduƒüunda */
      .empty-state .input-container {
        padding: 0;
        max-width: 900px;
      }

      /* üìã LYDIAN AI DISCLAIMER - Professional Corporate Notice */
      .ai-disclaimer {
        margin-top: 0.5rem;
        padding: 0.625rem 1rem;
        text-align: center;
        font-size: 0.75rem;
        line-height: 1.5;
        color: rgba(255, 255, 255, 0.45);
        font-weight: 400;
        letter-spacing: 0.3px;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
      }

      .ai-disclaimer strong {
        font-weight: 600;
        color: rgba(255, 255, 255, 0.65);
      }

      .ai-disclaimer a {
        color: rgba(16, 163, 127, 0.8);
        text-decoration: none;
        border-bottom: 1px dotted rgba(16, 163, 127, 0.3);
        transition: all 0.2s ease;
      }

      .ai-disclaimer a:hover {
        color: #10a37f;
        border-bottom-color: #10a37f;
      }

      /* ‚ö° AI MODE SELECTORS */
      .input-mode-selectors {
        display: none; /* HIDDEN - Replaced with inline neon icons */
        gap: 0.75rem;
        align-items: center;
        justify-content: center;
        padding: 0.75rem;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        flex-wrap: wrap;
      }

      .mode-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.875rem 1.25rem;
        background: transparent;
        border: 1px solid transparent;
        border-radius: 12px;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 600;
        color: #4b5563;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        white-space: nowrap;
      }

      .mode-btn svg {
        width: 20px;
        height: 20px;
        fill: #4b5563;
        transition: all 0.3s;
      }

      .mode-btn:hover {
        background: rgba(16, 163, 127, 0.1);
        border-color: rgba(16, 163, 127, 0.3);
        color: #10a37f;
        transform: translateY(-2px);
      }

      .mode-btn:hover svg {
        fill: #10a37f;
      }

      .mode-btn.active {
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        border-color: transparent;
        color: #ffffff;
        box-shadow: 0 4px 12px rgba(16, 163, 127, 0.25);
      }

      .mode-btn.active svg {
        fill: #ffffff;
      }

      .mode-btn:active {
        transform: translateY(0);
      }

      /* üîÑ PROMINENT LOADING ANIMATION */
      .loading-indicator {
        display: none;
        align-items: center;
        justify-content: center;
        gap: 1rem;
        padding: 1.5rem 2rem;
        margin: 1rem 0;
        background: linear-gradient(
          135deg,
          rgba(16, 163, 127, 0.1) 0%,
          rgba(255, 107, 74, 0.1) 100%
        );
        border: 2px solid #10a37f;
        border-radius: 16px;
        animation: fadeInScale 0.3s ease;
      }

      .loading-indicator.active {
        display: flex;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 3px solid #e5e7eb;
        border-top-color: #10a37f;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      .loading-text {
        font-size: 1rem;
        font-weight: 600;
        color: #1f2937;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .loading-dots {
        display: inline-flex;
        gap: 0.25rem;
      }

      .loading-dots span {
        width: 8px;
        height: 8px;
        background: #1f2937;
        border-radius: 50%;
        animation: bounce 1.4s infinite ease-in-out both;
      }

      .loading-dots span:nth-child(1) {
        animation-delay: -0.32s;
      }

      .loading-dots span:nth-child(2) {
        animation-delay: -0.16s;
      }

      @keyframes bounce {
        0%,
        80%,
        100% {
          transform: scale(0);
        }
        40% {
          transform: scale(1);
        }
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      @keyframes fadeInScale {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      /* ========== PREMIUM CHATGPT-STYLE INPUT ========== */
      .input-wrapper {
        max-width: 680px;
        width: calc(100% - 3rem);
        margin: 0 auto;
        /* Dark theme matching - darker background */
        background: rgba(32, 33, 36, 0.95);
        backdrop-filter: blur(16px) saturate(180%);
        -webkit-backdrop-filter: blur(16px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 26px;
        padding: 0.75rem 1rem;
        /* Premium shadow */
        box-shadow:
          0 0 0 1px rgba(0, 0, 0, 0.2),
          0 4px 16px rgba(0, 0, 0, 0.4),
          0 12px 32px rgba(0, 0, 0, 0.3);
        position: relative;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        /* Flex layout for components */
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .input-wrapper:focus-within {
        background: rgba(40, 41, 45, 0.98);
        border-color: rgba(100, 120, 200, 0.3);
        box-shadow:
          0 0 0 1px rgba(100, 120, 200, 0.15),
          0 4px 16px rgba(0, 0, 0, 0.4),
          0 12px 32px rgba(0, 0, 0, 0.3),
          0 0 30px rgba(100, 120, 200, 0.08);
      }

      /* üìä STATS - Hidden completely */
      .mobile-input-stats {
        display: none !important;
      }

      /* üìä Desktop Stats & Disclaimer - Hidden completely */
      .desktop-stats-disclaimer {
        display: none !important;
      }

      .desktop-stats-row {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.5rem 1rem;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 20px;
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.5);
      }

      .desktop-stat-item {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        font-family: 'JetBrains Mono', monospace;
        white-space: nowrap;
      }

      .desktop-stat-item svg {
        opacity: 0.6;
      }

      .desktop-stat-item.token-stat {
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 600;
      }

      .desktop-stat-item.token-stat svg {
        stroke: #10a37f;
        opacity: 0.8;
      }

      .desktop-stat-divider {
        color: rgba(255, 255, 255, 0.2);
        font-weight: 300;
      }

      .desktop-disclaimer {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        color: rgba(255, 255, 255, 0.4);
        font-size: 0.75rem;
        white-space: nowrap;
      }

      .desktop-disclaimer svg {
        opacity: 0.5;
        color: rgba(255, 200, 100, 0.6);
        stroke: currentColor;
      }

      /* Mobile responsive */
      @media (max-width: 768px) {
        /* Hide file/voice buttons in input-actions on mobile - use + dropdown instead */
        .file-upload-btn,
        .voice-chat-btn {
          display: none !important;
        }
      }

      .input-area {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .input-row {
        display: flex;
        gap: 1rem;
        align-items: flex-end;
      }

      /* ========== CHATGPT-STYLE AUTO-GROW TEXTAREA ========== */
      #messageInput {
        flex: 1;
        background: transparent;
        border: none;
        outline: none;
        color: #ffffff;
        font-size: 1rem;
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        line-height: 1.5;
        resize: none;
        min-height: 24px;
        max-height: 200px;
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: rgba(16, 163, 127, 0.5) transparent;
        padding: 0.5rem 0;
        padding-right: 120px; /* Space for buttons on right */
      }

      #messageInput::placeholder {
        color: rgba(255, 255, 255, 0.5);
      }

      #messageInput::-webkit-scrollbar {
        width: 6px;
      }

      #messageInput::-webkit-scrollbar-thumb {
        background: #10a37f;
        border-radius: 10px;
      }

      /* üé¨ Input Actions - RIGHT SIDE, FLEX ALIGNED */
      .input-actions {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        z-index: 60;
        pointer-events: auto;
        flex-shrink: 0;
      }

      /* üö´ NEON AI MODE ICONS - COMPLETELY HIDDEN */
      .neon-icons-container {
        display: none !important;
        visibility: hidden !important;
      }

      /* üåü MOBILE ONLY ELEMENTS - Hidden on desktop */
      .mobile-plus-btn,
      .mobile-plus-container,
      .mobile-plus-dropdown,
      .mobile-search-btn,
      .mobile-toggle-btn,
      .mobile-logo-toggle,
      .mobile-logo-text,
      .mobile-logo-container,
      .mobile-dropdown-trigger,
      .mobile-dropdown-menu,
      .mobile-sidebar {
        display: none;
      }

      /* üåü NEON ICONS - COMPACT PREMIUM DESIGN */
      .neon-icon {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        background: transparent;
        border: none;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        padding: 0;
        opacity: 0.7;
      }

      .neon-icon svg {
        width: 20px;
        height: 20px;
        transition: transform 0.2s ease;
        fill: #ffffff !important; /* White for dark theme */
      }

      .neon-icon:hover {
        transform: scale(1.15);
        opacity: 1;
      }

      .neon-icon:hover svg {
        transform: scale(1.05);
      }

      .neon-icon:active {
        transform: scale(0.95);
      }

      /* Active state for neon icons - WITH PULSE ANIMATION */
      .neon-icon.active {
        opacity: 1;
        background: rgba(16, 163, 127, 0.15);
        border-radius: 8px;
        animation: iconPulse 2s ease-in-out infinite;
      }

      .neon-icon.active svg {
        fill: #10a37f !important; /* Teal highlight when active */
        animation: iconRotate 3s ease-in-out infinite;
      }

      /* Pulse animation for active icon */
      @keyframes iconPulse {
        0%,
        100% {
          box-shadow: 0 0 0 0 rgba(16, 163, 127, 0.7);
          transform: scale(1);
        }
        50% {
          box-shadow: 0 0 0 8px rgba(16, 163, 127, 0);
          transform: scale(1.05);
        }
      }

      /* Subtle rotate/bounce for SVG inside */
      @keyframes iconRotate {
        0%,
        100% {
          transform: scale(1) rotate(0deg);
        }
        25% {
          transform: scale(1.1) rotate(-5deg);
        }
        50% {
          transform: scale(1.15) rotate(0deg);
        }
        75% {
          transform: scale(1.1) rotate(5deg);
        }
      }

      /* Ripple animation on icon click */
      @keyframes rippleAnimation {
        from {
          transform: scale(0);
          opacity: 1;
        }
        to {
          transform: scale(2.5);
          opacity: 0;
        }
      }

      /* REMOVED: Plus Button & Dropdown - CSS kaldƒ±rƒ±ldƒ±, bo≈ü i≈ülevi yok */

      .input-action-btn {
        width: 40px;
        height: 40px;
        background: linear-gradient(
          135deg,
          rgba(16, 163, 127, 0.1) 0%,
          rgba(255, 107, 74, 0.1) 100%
        );
        border: 1px solid #10a37f;
        border-radius: 10px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 4px 12px rgba(16, 163, 127, 0.15);
      }

      .input-action-btn:hover {
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        border-color: transparent;
        transform: scale(1.1);
        box-shadow:
          0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }

      .input-action-btn:hover svg {
        fill: #ffffff;
      }

      .input-action-btn svg {
        width: 20px;
        height: 20px;
        fill: #1f2937;
        stroke: #1f2937;
        transition: all 0.3s;
      }

      /* üöÄ Send Button - Gray Neon Style */
      #sendBtn {
        width: 36px;
        height: 36px;
        background: rgba(120, 130, 150, 0.3);
        border: 1px solid rgba(150, 160, 180, 0.3);
        border-radius: 10px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        flex-shrink: 0;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      }

      #sendBtn:hover {
        background: rgba(140, 150, 170, 0.4);
        border-color: rgba(180, 190, 210, 0.4);
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(120, 130, 150, 0.3);
      }

      #sendBtn:active {
        transform: scale(0.95);
      }

      #sendBtn:disabled {
        background: rgba(255, 255, 255, 0.05);
        border-color: rgba(255, 255, 255, 0.08);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      #sendBtn:disabled svg {
        fill: rgba(255, 255, 255, 0.2);
      }

      #sendBtn svg {
        width: 18px;
        height: 18px;
        fill: rgba(255, 255, 255, 0.8);
      }

      /* üé§ Voice Chat Button - Premium Teal */
      .voice-chat-btn {
        width: 36px;
        height: 36px;
        background: transparent;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        color: rgba(255, 255, 255, 0.6);
      }

      .voice-chat-btn:hover {
        background: rgba(16, 163, 127, 0.2);
        color: #10a37f;
      }

      .voice-chat-btn:active {
        transform: scale(0.95);
      }

      .voice-chat-btn svg {
        width: 20px;
        height: 20px;
        fill: currentColor;
      }

      /* üìÅ File Upload Button */
      .file-upload-btn {
        width: 36px;
        height: 36px;
        background: transparent;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        color: rgba(255, 255, 255, 0.6);
      }

      .file-upload-btn:hover {
        background: rgba(110, 132, 255, 0.2);
        color: #6e84ff;
      }

      .file-upload-btn:active {
        transform: scale(0.95);
      }

      .file-upload-btn svg {
        width: 20px;
        height: 20px;
        fill: currentColor;
      }

      /* üìä Input Stats - BELOW INPUT FORM */
      .input-stats {
        display: none; /* Hidden on desktop by default - shown above form on mobile */
      }

      .char-count {
        font-family: 'JetBrains Mono', monospace;
      }

      .token-count {
        font-family: 'JetBrains Mono', monospace;
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 600;
      }

      /* ============================================================
   üé® MODALS & OVERLAYS
   ============================================================ */

      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(20px);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        animation: fadeInScale 0.3s ease;
      }

      .modal-overlay.active {
        display: flex;
      }

      .modal {
        background: rgba(26, 26, 26, 0.98);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 24px;
        padding: 2rem;
        max-width: 600px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        box-shadow:
          0 20px 25px -5px rgba(0, 0, 0, 0.5),
          0 10px 10px -5px rgba(0, 0, 0, 0.4);
        animation: slideInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }

      .modal-title {
        font-size: 1.5rem;
        font-weight: 800;
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .modal-close {
        width: 36px;
        height: 36px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 8px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .modal-close:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: #ff6b4a;
        transform: rotate(90deg);
        box-shadow: 0 4px 12px rgba(255, 107, 74, 0.3);
      }

      .modal-close svg {
        width: 20px;
        height: 20px;
        fill: #ffffff;
        transition: fill 0.3s;
      }

      .modal-close:hover svg {
        fill: #ff6b4a;
      }

      /* üì§ SHARE MODAL STYLES */
      .share-modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        padding: 1rem;
        animation: fadeIn 0.2s ease;
      }

      .share-modal {
        background: rgba(32, 33, 36, 0.98);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 20px;
        max-width: 480px;
        width: 100%;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        animation: slideUp 0.3s ease;
      }

      .share-modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1.25rem 1.5rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .share-modal-header h3 {
        font-size: 1.25rem;
        font-weight: 600;
        color: #fff;
        margin: 0;
      }

      .share-modal-close {
        background: rgba(255, 255, 255, 0.1);
        border: none;
        border-radius: 10px;
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.2s;
      }

      .share-modal-close:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .share-modal-close svg {
        fill: rgba(255, 255, 255, 0.7);
      }

      .share-modal-content {
        padding: 1.5rem;
      }

      .share-warning {
        display: flex;
        align-items: flex-start;
        gap: 0.75rem;
        background: rgba(255, 193, 7, 0.1);
        border: 1px solid rgba(255, 193, 7, 0.3);
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1.25rem;
        font-size: 0.875rem;
        color: rgba(255, 255, 255, 0.9);
        line-height: 1.5;
      }

      .share-warning svg {
        flex-shrink: 0;
        color: #ffc107;
      }

      .share-url-box {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }

      .share-url-box input {
        flex: 1;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 10px;
        padding: 0.75rem 1rem;
        color: #fff;
        font-size: 0.875rem;
        font-family: 'SF Mono', 'Menlo', monospace;
      }

      .share-url-box input:focus {
        outline: none;
        border-color: #10a37f;
      }

      .copy-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1rem;
        background: rgba(16, 163, 127, 0.2);
        border: 1px solid rgba(16, 163, 127, 0.4);
        border-radius: 10px;
        color: #10a37f;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
        white-space: nowrap;
      }

      .copy-btn:hover {
        background: rgba(16, 163, 127, 0.3);
      }

      .copy-btn svg {
        fill: #10a37f;
      }

      .whatsapp-share-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        width: 100%;
        padding: 1rem 1.5rem;
        background: #25d366;
        border: none;
        border-radius: 12px;
        color: #fff;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.2s;
        margin-bottom: 1rem;
      }

      .whatsapp-share-btn:hover {
        background: #22c55e;
        transform: translateY(-1px);
      }

      .whatsapp-share-btn svg {
        fill: #fff;
      }

      .share-expiry {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.5);
      }

      .share-expiry svg {
        stroke: rgba(255, 255, 255, 0.5);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      /* üé® Theme Options */
      .theme-options {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1rem;
      }

      .theme-option {
        padding: 1.25rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 14px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        text-align: center;
      }

      .theme-option:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(16, 163, 127, 0.3);
        border-color: #10a37f;
      }

      .theme-option.active {
        border-color: #10a37f;
        background: rgba(255, 255, 255, 0.1);
        box-shadow: 0 4px 12px rgba(16, 163, 127, 0.25);
      }

      .theme-preview {
        width: 100%;
        height: 60px;
        border-radius: 8px;
        margin-bottom: 0.75rem;
        display: flex;
        gap: 4px;
        padding: 8px;
      }

      .theme-preview-color {
        flex: 1;
        border-radius: 4px;
      }

      .theme-name {
        font-weight: 600;
        font-size: 0.9rem;
        color: #ffffff;
      }

      /* ============================================================
   üì± RESPONSIVE DESIGN
   ============================================================ */

      /* ============================================================
   üì± RESPONSIVE DESIGN - MOBILE FIRST
   ============================================================ */

      /* Safe Area Support for iPhone X+ notch */
      @supports (padding: env(safe-area-inset-top)) {
        body {
          padding-top: env(safe-area-inset-top);
          padding-bottom: env(safe-area-inset-bottom);
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
        }

        .chat-header {
          padding-top: max(0.75rem, env(safe-area-inset-top));
        }

        .input-container {
          padding-bottom: max(1rem, env(safe-area-inset-bottom));
        }

        .sidebar {
          padding-top: env(safe-area-inset-top);
          padding-bottom: env(safe-area-inset-bottom);
        }
      }

      /* Touch-friendly scrolling for iOS */
      .messages-container,
      .sidebar {
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
      }

      /* Tablet & Below (768px) */
      @media (max-width: 768px) {
        .sidebar {
          position: fixed;
          left: 0;
          top: 0;
          transform: translateX(-280px); /* Start hidden on mobile */
          height: 100vh;
          width: 280px;
          z-index: 1000;
          transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar.collapsed {
          transform: translateX(-100%);
        }

        /* Sidebar toggle remains hidden on mobile - use .mobile-logo-toggle instead */
        .sidebar-toggle {
          display: none !important;
        }

        .main-content {
          margin-left: 0;
          width: 100%;
        }

        .chat-container {
          padding: 0;
        }

        .chat-header {
          padding: 0.75rem 1rem;
          padding-left: 140px; /* Space for mobile logo container */
          flex-wrap: nowrap;
          gap: 0.5rem;
          justify-content: flex-end;
          background: transparent !important;
          border: none !important;
          position: relative;
          z-index: 100;
        }

        .header-left {
          display: none; /* Hide on mobile */
        }

        .header-actions {
          gap: 0.25rem;
          width: auto;
          justify-content: flex-end;
          background: transparent !important;
          flex-shrink: 0;
        }

        /* Show download/share icons on mobile with proper styling */
        .header-btn-icon#downloadBtn,
        .header-btn-icon#shareBtn {
          display: flex !important;
          width: 36px !important;
          height: 36px !important;
          padding: 6px !important;
          background: rgba(255, 255, 255, 0.08) !important;
          border: 1px solid rgba(255, 255, 255, 0.1) !important;
          border-radius: 10px !important;
          align-items: center;
          justify-content: center;
        }

        .header-btn-icon#downloadBtn:active,
        .header-btn-icon#shareBtn:active {
          transform: scale(0.95);
          background: rgba(16, 163, 127, 0.2) !important;
        }

        .header-btn-icon#downloadBtn svg,
        .header-btn-icon#shareBtn svg {
          width: 18px !important;
          height: 18px !important;
        }

        /* Compact recall status on mobile */
        .recall-status-indicator {
          padding: 4px 8px !important;
          font-size: 11px !important;
        }

        .recall-status-text {
          display: none !important; /* Hide text, show only dot */
        }

        .recall-status-dot {
          width: 8px !important;
          height: 8px !important;
        }

        .header-btn {
          width: 44px;
          height: 44px;
          padding: 0.5rem;
          min-width: 44px;
          background: transparent !important; /* No background */
          border: none !important; /* No border */
          -webkit-tap-highlight-color: transparent;
        }

        .header-btn:active {
          transform: scale(0.95);
        }

        .header-btn-icon {
          width: 44px;
          height: 44px;
          min-width: 44px;
          background: transparent !important;
          border: none !important;
          -webkit-tap-highlight-color: transparent;
        }

        .header-btn-icon:active {
          transform: scale(0.95);
        }

        .header-btn svg,
        .header-btn-icon svg {
          width: 20px;
          height: 20px;
          fill: #ffffff; /* White icons */
        }

        .logo {
          font-size: 1.5rem;
        }

        .messages-container {
          padding: 1rem 0.75rem;
          padding-top: 70px; /* Space for fixed header */
          padding-bottom: 140px; /* Space for fixed input */
          min-height: 100vh;
          min-height: 100dvh; /* Dynamic viewport height for mobile */
          max-height: none;
          overflow-y: auto;
          box-sizing: border-box;
        }

        .message {
          max-width: 100%;
          padding: 1rem;
          margin-bottom: 1rem;
        }

        .message-content {
          font-size: 0.95rem;
          line-height: 1.6;
        }

        .message-actions {
          gap: 0.5rem;
          margin-top: 1rem !important; /* Mobilde butonlardan uzak */
        }

        .action-btn {
          padding: 0.5rem;
          font-size: 0.75rem;
        }

        /* Kullanƒ±cƒ± mesajƒ±na daha fazla bottom margin - butonlara deƒümesin */
        .user-message {
          margin-bottom: 1.5rem !important;
          padding-bottom: 1rem !important;
        }

        .input-wrapper {
          padding: 0.5rem;
          margin: 0;
          width: 100%;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }

        .input-container {
          position: fixed !important;
          bottom: 0 !important;
          left: 0 !important;
          right: 0 !important;
          width: 100% !important;
          max-width: 100% !important;
          padding: 0.75rem;
          gap: 0.5rem;
          margin: 0;
          background: #1a1a1a;
          z-index: 9999 !important;
          box-sizing: border-box;
          padding-bottom: max(0.75rem, env(safe-area-inset-bottom));
        }

        /* Neon white glow for mobile input */
        .input-wrapper {
          border: 1px solid rgba(255, 255, 255, 0.4) !important;
          box-shadow:
            0 0 10px rgba(255, 255, 255, 0.2),
            0 0 20px rgba(255, 255, 255, 0.1),
            inset 0 0 10px rgba(255, 255, 255, 0.05) !important;
          border-radius: 16px !important;
          background: rgba(26, 26, 26, 0.95) !important;
        }

        /* Neon white plus button with icon */
        .mobile-plus-btn,
        #mobilePlusBtn,
        .neon-icon-btn {
          color: #ffffff !important;
          border: 1px solid rgba(255, 255, 255, 0.5) !important;
          box-shadow:
            0 0 10px rgba(255, 255, 255, 0.4),
            0 0 20px rgba(255, 255, 255, 0.2) !important;
          background: transparent !important;
          border-radius: 12px !important;
        }

        .mobile-plus-btn svg,
        #mobilePlusBtn svg,
        .neon-icon-btn svg {
          fill: #ffffff !important;
          stroke: #ffffff !important;
          filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.8)) !important;
        }

        /* Neon white send button with icon */
        #sendBtn {
          color: #ffffff !important;
          border: 1px solid rgba(255, 255, 255, 0.5) !important;
          box-shadow:
            0 0 10px rgba(255, 255, 255, 0.4),
            0 0 20px rgba(255, 255, 255, 0.2) !important;
          background: transparent !important;
          border-radius: 12px !important;
        }

        #sendBtn svg,
        #sendBtn path {
          fill: #ffffff !important;
          stroke: #ffffff !important;
          filter: drop-shadow(0 0 4px rgba(255, 255, 255, 0.8)) !important;
        }

        #sendBtn:not(:disabled):hover,
        .mobile-plus-btn:hover,
        #mobilePlusBtn:hover {
          box-shadow:
            0 0 15px rgba(255, 255, 255, 0.6),
            0 0 30px rgba(255, 255, 255, 0.3) !important;
        }

        /* Input actions icons neon white */
        .input-actions button svg,
        .input-actions button path {
          fill: #ffffff !important;
          filter: drop-shadow(0 0 3px rgba(255, 255, 255, 0.6)) !important;
        }

        .chat-header {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          width: 100% !important;
          z-index: 110;
        }

        /* Input area as flex column */
        .input-area {
          display: flex;
          flex-direction: column;
          gap: 0;
        }

        .input-row {
          order: 2;
        }

        #messageInput {
          font-size: 1rem;
          min-height: 44px;
          padding: 0.75rem 0.5rem !important;
          flex: 1;
          line-height: 1.5;
          border-radius: 12px;
          text-align: left;
        }

        #messageInput::placeholder {
          font-size: 0.95rem;
          opacity: 0.7;
          letter-spacing: 0.01em;
          text-align: left;
        }

        .input-actions {
          position: relative;
          left: auto;
          top: auto;
          transform: none;
          gap: 0.25rem;
          z-index: 10;
          flex-shrink: 0;
        }

        /* üö´ Hide non-functional neon icons on mobile */
        .neon-icons-container {
          display: none !important;
        }

        /* üéØ MOBILE PLUS BUTTON - Grey tone, no green glow */
        .mobile-plus-btn {
          display: flex !important;
          align-items: center;
          justify-content: center;
          width: 44px;
          height: 44px;
          background: rgba(255, 255, 255, 0.08);
          border: 1.5px solid rgba(255, 255, 255, 0.2);
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: none;
        }

        .mobile-plus-btn svg {
          width: 24px;
          height: 24px;
          fill: rgba(255, 255, 255, 0.8);
          transition: transform 0.3s ease;
        }

        .mobile-plus-btn.active svg {
          transform: rotate(45deg);
        }

        .mobile-plus-btn:active {
          transform: scale(0.95);
        }

        /* üì± MOBILE PLUS CONTAINER */
        .mobile-plus-container {
          position: relative;
          display: flex;
          align-items: center;
          flex-shrink: 0;
        }

        /* üìã MOBILE PLUS DROPDOWN */
        .mobile-plus-dropdown {
          position: absolute;
          bottom: calc(100% + 0.5rem);
          left: 0;
          background: rgba(32, 33, 36, 0.98);
          border: 1px solid rgba(255, 255, 255, 0.12);
          border-radius: 16px;
          padding: 0.5rem;
          display: none;
          flex-direction: column;
          gap: 0.25rem;
          min-width: 160px;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(20px);
          -webkit-backdrop-filter: blur(20px);
          z-index: 1000;
          animation: slideUp 0.2s ease-out;
        }

        .mobile-plus-dropdown.show {
          display: flex;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(8px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .plus-dropdown-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.75rem 1rem;
          background: transparent;
          border: none;
          border-radius: 12px;
          color: rgba(255, 255, 255, 0.9);
          font-size: 0.9rem;
          font-family: inherit;
          cursor: pointer;
          transition: all 0.2s ease;
          white-space: nowrap;
        }

        .plus-dropdown-item:hover,
        .plus-dropdown-item:active {
          background: rgba(16, 163, 127, 0.2);
        }

        .plus-dropdown-item svg {
          width: 20px;
          height: 20px;
          fill: #10a37f;
          flex-shrink: 0;
        }

        .plus-dropdown-item span {
          color: rgba(255, 255, 255, 0.9);
        }

        /* üö´ COMPLETELY HIDE NEON ICONS ON MOBILE - Not functional */
        .neon-icons-container,
        .neon-icons-container.show,
        .neon-icon {
          display: none !important;
          visibility: hidden !important;
          opacity: 0 !important;
          pointer-events: none !important;
          width: 0 !important;
          height: 0 !important;
          overflow: hidden !important;
        }

        .neon-icon:hover {
          background: rgba(255, 255, 255, 0.1);
          border-color: rgba(16, 163, 127, 0.4);
        }

        .neon-icon svg {
          width: 28px;
          height: 28px;
        }

        /* Active state on mobile - more visible */
        .neon-icon.active {
          background: rgba(16, 163, 127, 0.3);
          border-color: rgba(16, 163, 127, 0.8);
          box-shadow: 0 0 16px rgba(16, 163, 127, 0.5);
        }

        /* Token/char counter - Below input, no background */
        .input-stats {
          position: relative !important;
          display: flex !important;
          justify-content: center !important;
          gap: 1rem !important;
          margin-top: 0.5rem !important;
          padding: 0 !important;
          background: transparent !important;
          border: none !important;
          backdrop-filter: none !important;
          font-size: 0.75rem !important;
          order: 3 !important;
        }

        .input-stats span {
          color: rgba(255, 255, 255, 0.6) !important;
          opacity: 1 !important;
          white-space: nowrap !important;
          font-weight: 400 !important;
        }

        /* Mobilde sadece sayƒ±lar ve ikonlar - yazƒ±larƒ± gizle */
        .input-stats .count-label {
          display: none !important;
        }

        .input-stats svg {
          opacity: 0.8 !important;
        }

        /* üé§ Voice Chat Button - Mobile optimized */
        .voice-chat-btn {
          position: relative !important;
          right: auto !important;
          top: auto !important;
          transform: none !important;
          width: 44px !important;
          height: 44px !important;
          flex-shrink: 0;
          order: 2;
        }

        /* Hide mobile search button */
        .mobile-search-btn {
          display: none !important;
        }

        /* üéõÔ∏è MOBILE TOGGLE BUTTON - Hide old one */
        .mobile-toggle-btn {
          display: none !important;
        }

        /* üì± Mobile Logo Toggle - Show on mobile, aligned with header */
        .mobile-logo-toggle {
          display: flex !important;
          position: relative !important; /* Changed from fixed to relative */
          width: auto !important; /* Auto width for logo + text */
          height: 36px !important;
          background: transparent !important;
          border: none !important;
          padding: 0 !important;
          align-items: center;
          justify-content: flex-start;
          gap: 0.5rem; /* Space between logo and text */
        }

        .mobile-logo-toggle img {
          width: 36px !important;
          height: 36px !important;
          border-radius: 50% !important;
          object-fit: cover !important;
          flex-shrink: 0;
        }

        .mobile-logo-text {
          display: inline-block !important;
          font-size: 1.125rem !important;
          font-weight: 600 !important;
          color: #ffffff !important;
          white-space: nowrap;
        }

        /* üì± Mobile Logo Container - Flex wrapper */
        .mobile-logo-container {
          display: flex !important;
          position: fixed !important;
          top: 0.75rem !important;
          left: 1rem !important;
          z-index: 9999 !important;
          align-items: center;
          gap: 0.25rem;
        }

        /* üì± Mobile Dropdown Trigger - V icon button */
        .mobile-dropdown-trigger {
          display: flex !important;
          align-items: center;
          justify-content: center;
          width: 20px !important;
          height: 20px !important;
          background: transparent !important;
          border: none !important;
          padding: 0 !important;
          cursor: pointer;
          transition: transform 0.2s;
        }

        .mobile-dropdown-trigger:active {
          transform: scale(0.9);
        }

        .mobile-dropdown-trigger.open {
          transform: rotate(180deg);
        }

        /* üì± Mobile Dropdown Menu - Simple list, no shadow/border */
        .mobile-dropdown-menu {
          display: none;
          position: fixed;
          top: 2.75rem; /* Right below logo text */
          left: 4rem; /* Align with logo text, not icon */
          z-index: 9998;
          background: transparent;
          flex-direction: column;
          gap: 0.15rem;
        }

        .mobile-dropdown-menu.show {
          display: flex !important;
        }

        /* üì± Mobile Dropdown Items - Minimal style */
        .mobile-dropdown-item {
          font-size: 0.875rem !important;
          font-weight: 400 !important;
          color: #ffffff !important;
          text-decoration: none !important;
          padding: 0.25rem 0 !important;
          background: transparent !important;
          border: none !important;
          white-space: nowrap;
          transition: opacity 0.2s;
        }

        .mobile-dropdown-item:hover {
          opacity: 0.7;
        }

        /* üì± MOBILE SIDEBAR MENU - Slide from right */
        .mobile-sidebar {
          display: flex !important; /* Show on mobile */
          position: fixed;
          top: 0;
          right: -280px;
          width: 280px;
          height: 100vh;
          background: rgba(11, 15, 25, 0.98);
          backdrop-filter: blur(20px);
          border-left: 1px solid rgba(255, 255, 255, 0.1);
          box-shadow: -4px 0 24px rgba(0, 0, 0, 0.5);
          transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
          z-index: 10000;
          flex-direction: column;
          padding: 1rem;
          gap: 0.5rem;
        }

        .mobile-sidebar.open {
          right: 0;
        }

        .mobile-sidebar-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 0.5rem 0 1rem 0;
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .mobile-sidebar-title {
          font-size: 1.1rem;
          font-weight: 600;
          color: #ffffff;
        }

        .mobile-sidebar-close {
          width: 36px;
          height: 36px;
          display: flex;
          align-items: center;
          justify-content: center;
          background: rgba(255, 255, 255, 0.05);
          border: 1px solid rgba(255, 255, 255, 0.15);
          border-radius: 8px;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .mobile-sidebar-close:active {
          transform: scale(0.95);
          background: rgba(255, 255, 255, 0.1);
        }

        .mobile-sidebar-close svg {
          width: 20px;
          height: 20px;
          fill: rgba(255, 255, 255, 0.8);
        }

        .mobile-menu-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.875rem 1rem;
          background: rgba(255, 255, 255, 0.03);
          border: 1px solid rgba(255, 255, 255, 0.08);
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.2s ease;
          color: rgba(255, 255, 255, 0.9);
          font-size: 0.95rem;
        }

        .mobile-menu-item:active {
          transform: scale(0.98);
          background: rgba(255, 255, 255, 0.06);
        }

        .mobile-menu-item svg {
          width: 20px;
          height: 20px;
          fill: rgba(255, 255, 255, 0.7);
        }

        /* Hide header actions when sidebar is open */
        .header-actions.hide-on-sidebar-open {
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.3s ease;
        }

        .input-action-btn,
        #sendBtn {
          min-width: 40px;
          min-height: 40px;
          width: 40px;
          height: 40px;
          padding: 0.5rem;
          position: relative;
          right: auto;
          top: auto;
          transform: none;
          flex-shrink: 0;
        }

        .plus-dropdown {
          min-width: 200px;
          left: 0;
          right: auto;
        }

        .plus-dropdown-item {
          padding: 0.75rem 1rem;
          font-size: 0.9rem;
        }

        .empty-state {
          padding-top: 1rem;
          gap: 1rem;
          padding-left: 1rem;
          padding-right: 1rem;
        }

        .mini-spinner-container {
          width: 80px;
          height: 80px;
        }

        .chat-item {
          padding: 0.875rem;
          margin-bottom: 0.5rem;
        }

        .chat-item-title {
          font-size: 0.9rem;
        }

        .chat-item-preview {
          font-size: 0.75rem;
        }

        .new-chat-btn {
          padding: 0.875rem;
          font-size: 0.9rem;
        }

        .sidebar-footer {
          padding: 0.875rem;
        }

        .user-menu {
          padding: 0.75rem;
        }

        .user-name {
          font-size: 0.9rem;
        }

        .user-email {
          font-size: 0.75rem;
        }

        .user-dropdown {
          bottom: 100%;
          top: auto;
          margin-bottom: 0.5rem;
        }

        .input-stats {
          padding: 0.5rem 1rem;
          font-size: 0.75rem;
          flex-wrap: wrap;
        }
      }

      /* Mobile Small (480px) */
      @media (max-width: 480px) {
        .sidebar {
          width: 85vw;
          max-width: 280px;
        }

        .logo {
          font-size: 1.25rem;
        }

        .chat-header {
          padding: 0.5rem 0.75rem;
          padding-left: 120px; /* Smaller space for mobile logo on small screens */
        }

        .header-btn {
          width: 40px;
          height: 40px;
          padding: 0.4rem;
        }

        /* Even more compact header on small screens */
        .header-actions {
          gap: 0.125rem;
        }

        /* Visitor badge compact on small screens */
        .visitor-city-badge {
          padding: 4px 8px !important;
          font-size: 10px !important;
          min-height: 36px !important;
        }

        .visitor-city-text {
          max-width: 50px !important;
        }

        .visitor-device-icon {
          display: none !important;
        }

        .messages-container {
          padding: 0.5rem;
          padding-top: 65px !important; /* Keep space for fixed header */
          padding-bottom: 130px !important; /* Keep space for fixed input */
        }

        .message {
          padding: 0.875rem;
          border-radius: 12px;
          max-width: 95%; /* Wider on mobile */
        }

        .message.assistant {
          max-width: 100%; /* Full width for AI on mobile */
        }

        .message-content {
          font-size: 0.9rem;
        }

        .input-wrapper {
          padding: 0.5rem 0.75rem;
        }

        .input-container {
          padding: 0.5rem !important;
          position: fixed !important;
          bottom: 0 !important;
          left: 0 !important;
          right: 0 !important;
          width: 100% !important;
        }

        #messageInput {
          font-size: 16px;
          padding: 0.625rem 0.875rem;
        }

        .input-action-btn,
        #sendBtn {
          min-width: 36px;
          min-height: 36px;
          padding: 0.4rem;
        }

        .plus-dropdown {
          min-width: 180px;
        }

        .plus-dropdown-item {
          padding: 0.625rem 0.875rem;
          font-size: 0.85rem;
        }

        .mini-spinner-container {
          width: 70px;
          height: 70px;
        }

        .empty-state {
          padding-top: 0.75rem;
          gap: 0.75rem;
        }

        .chat-item {
          padding: 0.75rem;
        }

        .new-chat-btn {
          padding: 0.75rem;
          font-size: 0.85rem;
        }

        .sidebar-footer {
          padding: 0.75rem;
        }

        .input-stats {
          font-size: 0.7rem;
          gap: 0.75rem;
        }
      }

      /* Landscape Mobile */
      @media (max-width: 768px) and (orientation: landscape) {
        .messages-container {
          max-height: calc(100vh - 160px);
        }

        .sidebar {
          width: 260px;
        }
      }

      /* Tablet Portrait (769px - 1024px) */
      @media (min-width: 769px) and (max-width: 1024px) {
        .sidebar {
          width: 280px;
        }

        .main-content {
          margin-left: 280px;
        }

        .messages-container {
          padding: 1.5rem;
        }

        .message {
          max-width: 90%;
        }

        .input-container {
          max-width: 900px;
        }
      }

      /* ============================================================
   üéØ UTILITY CLASSES
   ============================================================ */

      .hidden {
        display: none !important;
      }

      .fade-in {
        animation: fadeInScale 0.5s ease;
      }

      .slide-in-up {
        animation: slideInUp 0.5s ease;
      }

      .slide-in-left {
        animation: slideInLeft 0.5s ease;
      }

      .slide-in-right {
        animation: slideInRight 0.5s ease;
      }

      /* ============================================================
   üåü SPECIAL EFFECTS
   ============================================================ */

      /* Clean Gradient Text */
      .gradient-text {
        background: linear-gradient(135deg, #10a37f 0%, #ff6b4a 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* Border Shine Animation */
      @keyframes borderPulse {
        0%,
        100% {
          border-color: #10a37f;
        }
        50% {
          border-color: #ff6b4a;
        }
      }

      .border-animated {
        animation: borderPulse 3s ease-in-out infinite;
      }

      /* ============================================================
   üí° SUGGESTION CHIPS - ChatGPT Kompakt Stil
   ============================================================ */

      .suggestion-chips-container {
        display: flex;
        flex-direction: column;
        gap: 0.375rem;
        margin-top: 0.75rem;
        padding: 0;
        animation: fadeInUp 0.3s ease-out;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(6px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .suggestion-chip {
        display: inline-flex;
        align-items: center;
        padding: 0.5rem 0.875rem;
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 18px;
        color: rgba(255, 255, 255, 0.75);
        font-size: 0.8125rem;
        font-weight: 400;
        cursor: pointer;
        transition: all 0.2s ease;
        text-align: left;
        width: fit-content;
        line-height: 1.3;
      }

      .suggestion-chip:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.25);
        color: #ffffff;
      }

      .suggestion-chip:active {
        transform: scale(0.98);
      }

      /* Mobile'da suggestion chips */
      @media (max-width: 768px) {
        .suggestion-chips-container {
          gap: 0.25rem;
          margin-top: 0.5rem;
        }

        .suggestion-chip {
          padding: 0.4rem 0.75rem;
          font-size: 0.75rem;
          border-radius: 16px;
        }
      }

      /* Suggestion chips header */
      .suggestions-header {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
        color: rgba(255, 255, 255, 0.5);
        font-size: 0.75rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .suggestions-header svg {
        width: 14px;
        height: 14px;
        opacity: 0.6;
      }

      /* ============================================================
   üé¨ LOADING STATES
   ============================================================ */

      .loading {
        pointer-events: none;
        opacity: 0.6;
      }

      .spinner {
        width: 20px;
        height: 20px;
        border: 2px solid #10a37f;
        border-top-color: transparent;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }

      /* ============================================================
   ‚ú® FIRE SPARKS ANIMATION
   ============================================================ */

      .fire-sparks {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        overflow: hidden;
      }

      .spark {
        position: absolute;
        bottom: 0;
        width: 5px;
        height: 5px;
        background: var(--text-secondary);
        border-radius: 50%;
        opacity: 0;
        animation: sparkRise linear forwards;
        box-shadow: 0 0 4px var(--text-secondary);
      }

      @keyframes sparkRise {
        0% {
          transform: translateY(0) translateX(0) scale(1);
          opacity: 0.8;
        }
        50% {
          opacity: 0.6;
        }
        100% {
          transform: translateY(-100vh) translateX(var(--drift)) scale(0.3);
          opacity: 0;
        }
      }

      /* ========== SIDEBAR SEARCH OVERRIDE (ULTRA PRIORITY) ========== */
      .chat-sidebar .sidebar-search {
        padding: 0.125rem 0.5rem !important;
        height: 24px !important;
        min-height: 24px !important;
        max-height: 24px !important;
        line-height: 1 !important;
      }

      .chat-sidebar .sidebar-search svg {
        width: 16px !important;
        height: 16px !important;
        fill: #10a37f !important;
        stroke: none !important;
      }

      .chat-sidebar .sidebar-search input {
        font-size: 0.8rem !important;
        line-height: 1 !important;
        padding: 0 !important;
      }

      /* ========== MICROPHONE RECORDING ANIMATION ========== */
      .neon-mic.recording {
        animation: pulse-recording 1s ease-in-out infinite;
        background: rgba(239, 68, 68, 0.2) !important;
      }

      /* ============================================================
   ‚è±Ô∏è GUEST TIMER COUNTDOWN - 5 MINUTE LIMIT
   ============================================================ */
      .guest-timer {
        position: fixed;
        top: 20px;
        right: 20px;
        color: #ff6b4a;
        font-weight: 700;
        font-size: 14px;
        z-index: 10001;
        display: flex;
        align-items: center;
        gap: 10px;
        animation: slideInFromRight 0.5s ease-out;
      }

      .guest-timer.warning {
        animation: pulseWarning 1s ease-in-out infinite;
      }

      .guest-timer.warning .guest-timer-time {
        color: #ef4444;
      }

      /* Modern Premium Hourglass Icon */
      .guest-timer-icon {
        width: 32px;
        height: 32px;
        position: relative;
        animation: hourglassFlip 3s ease-in-out infinite;
      }

      @keyframes hourglassFlip {
        0%,
        100% {
          transform: rotate(0deg);
        }
        50% {
          transform: rotate(180deg);
        }
      }

      .guest-timer-text {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        gap: 2px;
      }

      .guest-timer-label {
        font-size: 10px;
        opacity: 0.9;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .guest-timer-time {
        font-size: 20px;
        font-weight: 900 !important;
        letter-spacing: 1px;
        font-family: 'JetBrains Mono', monospace;
      }

      @keyframes slideInFromRight {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @keyframes pulseWarning {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.08);
        }
      }

      /* Mobile responsive */
      @media (max-width: 768px) {
        .guest-timer {
          top: 10px;
          right: 10px;
          padding: 10px 16px;
          font-size: 12px;
        }

        .guest-timer-icon {
          font-size: 16px;
        }

        .guest-timer-label {
          font-size: 9px;
        }

        .guest-timer-time {
          font-size: 18px;
        }
      }

      @media (max-width: 480px) {
        .guest-timer {
          top: 70px;
          right: 10px;
          padding: 8px 14px;
        }

        .guest-timer-text {
          gap: 0;
        }

        .guest-timer-time {
          font-size: 16px;
        }
      }

      @keyframes pulse-recording {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
        }
        50% {
          transform: scale(1.1);
          box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
        }
      }

      .neon-mic.recording svg {
        fill: #ef4444 !important;
      }
    </style>

    <!-- ü§ñ Ailydian AI Client - LyDian Acceleration-first Fallback Strategy -->
    <script src="/js/ai-client-unified.js"></script>
    <!-- üß† AI Recall Client - RAG with Online/Offline Support -->
    <script src="/js/recall-client.js"></script>

    <!-- SEO Meta Tags (TR) -->
    <title>AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform</title>
    <meta
      name="description"
      content="10+ AI modeli tek platformda. LyDian Quantum Reasoning, LyDian Velocity Engine, LyDian Vision. G√∂rsel, kod, analiz. √úcretsiz ba≈üla ve AI g√ºc√ºn√º ke≈üfet."
    />
    <meta
      name="keywords"
      content="ai chat, yapay zeka sohbet, lydian ai, √ßok modelli ai, quantum ai, velocity engine"
    />
    <link rel="canonical" href="https://www.ailydian.com/tr/chat.html" />

    <!-- hreflang Tags -->
    <link rel="alternate" hreflang="tr" href="https://www.ailydian.com/tr/chat.html" />
    <link rel="alternate" hreflang="en" href="https://www.ailydian.com/en/chat.html" />
    <link rel="alternate" hreflang="de" href="https://www.ailydian.com/de/chat.html" />
    <link rel="alternate" hreflang="ar" href="https://www.ailydian.com/ar/chat.html" />
    <link rel="alternate" hreflang="ru" href="https://www.ailydian.com/ru/chat.html" />
    <link rel="alternate" hreflang="zh" href="https://www.ailydian.com/zh/chat.html" />
    <link rel="alternate" hreflang="x-default" href="https://www.ailydian.com/en/chat.html" />

    <!-- GEO Targeting -->
    <meta name="geo.region" content="TR" />
    <meta name="geo.placename" content="ƒ∞stanbul" />
    <meta name="geo.position" content="41.0082;28.9784" />
    <meta name="ICBM" content="41.0082;28.9784" />

    <!-- Open Graph -->
    <meta
      property="og:title"
      content="AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform"
    />
    <meta
      property="og:description"
      content="10+ AI modeli tek platformda. LyDian Quantum Reasoning, LyDian Velocity Engine, LyDian Vision. G√∂rsel, kod, analiz. √úcretsiz ba≈üla ve AI g√ºc√ºn√º ke≈üfet."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.ailydian.com/tr/chat.html" />
    <meta property="og:image" content="https://www.ailydian.com/og-images/chat-tr.png" />
    <meta property="og:locale" content="tr_TR" />
    <meta property="og:site_name" content="LyDian AI" />

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lydianai" />
    <meta name="twitter:title" content="AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI" />
    <meta
      name="twitter:description"
      content="10+ AI modeli tek platformda. LyDian Quantum, LyDian Ultra, LyDian Vision Pro. G√∂rsel, kod, analiz. √úcretsiz ba≈üla ve AI g√ºc√ºn√º ke≈üfet."
    />
    <meta name="twitter:image" content="https://www.ailydian.com/twitter-cards/chat-tr.png" />

    <!-- Additional Meta -->
    <meta
      name="robots"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />
    <meta name="googlebot" content="index, follow" />
    <meta name="bingbot" content="index, follow" />
    <meta name="author" content="LyDian AI Ecosystem" />
    <meta name="language" content="TR" />

    <!-- Schema.org: Organization -->

    <meta property="og:image" content="https://www.ailydian.com/og-images/chat.png" />
    <meta property="og:image:secure_url" content="https://www.ailydian.com/og-images/chat.png" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta
      property="og:image:alt"
      content="AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform"
    />
    <meta name="twitter:image" content="https://www.ailydian.com/twitter-cards/chat.png" />
    <meta
      name="twitter:image:alt"
      content="AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform"
    />
    <meta property="og:image" content="https://www.ailydian.com/og-images/chat-2.png" />
    <meta property="og:image" content="https://www.ailydian.com/og-images/chat-3.png" />
    <meta property="og:image" content="https://www.ailydian.com/og-images/chat-4.png" />

    <meta name="msapplication-TileImage" content="https://www.ailydian.com/mstile/chat.png" />
    <meta
      name="msapplication-square70x70logo"
      content="https://www.ailydian.com/mstile-70/chat.png"
    />
    <meta
      name="msapplication-square150x150logo"
      content="https://www.ailydian.com/mstile-150/chat.png"
    />

    <!-- üèÜ Premium SEO - LyDian AI Ecosystem -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Web Browser, iOS, Android",
        "description": "AI sohbet asistanƒ± - Akƒ±llƒ± konu≈üma ve destek",
        "image": [
          "https://www.ailydian.com/images/gallery/chat-1.jpg",
          "https://www.ailydian.com/images/gallery/chat-2.jpg",
          "https://www.ailydian.com/images/gallery/chat-3.jpg"
        ],
        "screenshot": [
          "https://www.ailydian.com/images/gallery/chat-1.jpg",
          "https://www.ailydian.com/images/gallery/chat-2.jpg",
          "https://www.ailydian.com/images/gallery/chat-3.jpg"
        ],
        "url": "https://www.ailydian.com/chat",
        "publisher": {
          "@type": "Organization",
          "name": "LyDian AI",
          "logo": {
            "@type": "ImageObject",
            "url": "https://www.ailydian.com/images/logo/lydian-ai.png",
            "width": 512,
            "height": 512
          }
        },
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "TRY",
          "availability": "https://schema.org/InStock"
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.9",
          "reviewCount": "1542",
          "bestRating": "5"
        },
        "inLanguage": ["tr", "en", "de", "ru", "uk", "zh", "it"]
      }
    </script>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform",
        "description": "AI sohbet asistanƒ± - Akƒ±llƒ± konu≈üma ve destek",
        "image": {
          "@type": "ImageObject",
          "url": "https://www.ailydian.com/images/hero/chat.jpg",
          "width": 1200,
          "height": 630,
          "caption": "AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform"
        },
        "publisher": {
          "@type": "Organization",
          "name": "LyDian AI",
          "logo": {
            "@type": "ImageObject",
            "url": "https://www.ailydian.com/images/logo/lydian-ai.png",
            "width": 512,
            "height": 512
          }
        },
        "datePublished": "2024-01-15",
        "dateModified": "2025-12-20",
        "inLanguage": "tr-TR"
      }
    </script>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "VideoObject",
        "name": "AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform - Video Rehber",
        "description": "AI sohbet asistanƒ± - Akƒ±llƒ± konu≈üma ve destek",
        "thumbnailUrl": "https://www.ailydian.com/images/video/chat-preview.jpg",
        "uploadDate": "2024-01-15",
        "duration": "PT8M",
        "contentUrl": "https://www.ailydian.com/videos/chat.mp4",
        "embedUrl": "https://www.ailydian.com/chat#video",
        "publisher": {
          "@type": "Organization",
          "name": "LyDian AI"
        }
      }
    </script>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Ana Sayfa",
            "item": "https://www.ailydian.com"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Chat",
            "item": "https://www.ailydian.com/chat"
          }
        ]
      }
    </script>

    <meta property="og:type" content="website" />
    <meta
      property="og:title"
      content="AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform"
    />
    <meta property="og:description" content="AI sohbet asistanƒ± - Akƒ±llƒ± konu≈üma ve destek" />
    <meta property="og:url" content="https://www.ailydian.com/chat" />
    <meta property="og:image" content="https://www.ailydian.com/images/og/chat.jpg" />
    <meta property="og:image:secure_url" content="https://www.ailydian.com/images/og/chat.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta
      property="og:image:alt"
      content="AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform"
    />
    <meta property="og:site_name" content="LyDian AI" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform"
    />
    <meta name="twitter:description" content="AI sohbet asistanƒ± - Akƒ±llƒ± konu≈üma ve destek" />
    <meta name="twitter:image" content="https://www.ailydian.com/images/twitter/chat.jpg" />
    <meta
      name="twitter:image:alt"
      content="AI Chat ‚Äî √áok Modelli Yapay Zeka | LyDian Ultra AI Platform"
    />

    <!-- /Premium SEO -->
    <link rel="preload" type="font/woff2" href="/fonts/main.woff2" crossorigin="anonymous" />
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#C4A962" />
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="aiLyDian AI" />
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152.png" />
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/apple-touch-icon-167.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180.png" />
    <!-- Apple Splash Screens -->
    <link
      rel="apple-touch-startup-image"
      href="/icons/splash/iphone-x.png"
      media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/icons/splash/iphone-xr.png"
      media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/icons/splash/iphone-12.png"
      media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/icons/splash/ipad.png"
      media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/icons/splash/ipad-pro-11.png"
      media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)"
    />
    <link
      rel="apple-touch-startup-image"
      href="/icons/splash/ipad-pro-12.png"
      media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)"
    />
    <!-- Android/Chrome -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="aiLyDian AI" />
    <!-- Microsoft -->
    <meta name="msapplication-TileColor" content="#C4A962" />
    <meta name="msapplication-TileImage" content="/icons/ms-icon-144.png" />
    <meta name="msapplication-config" content="/browserconfig.xml" />
    <!-- Favicon (SVG preferred + PNG fallbacks) -->
    <link rel="icon" type="image/svg+xml" href="/icons/grape-icon-simple.svg" />
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32.png" />
    <link rel="icon" type="image/png" sizes="48x48" href="/icons/favicon-48.png" />
    <link rel="icon" type="image/x-icon" href="/icons/favicon.ico" />
    <link rel="shortcut icon" type="image/svg+xml" href="/icons/grape-icon-simple.svg" />

    <!-- ================================ -->
    <!-- AILYDIAN SEO META TAGS (TR) -->
    <!-- Auto-generated for multi-language SEO -->
    <!-- ================================ -->

    <!-- Primary Meta Tags -->
    <title>AI Chat - AILYDIAN | Geli≈ümi≈ü AI, Kurumsal AI, Yapay Zeka T√ºrk√ße</title>
    <meta name="title" content="AI Chat - AILYDIAN | Geli≈ümi≈ü AI, Kurumsal AI, Yapay Zeka T√ºrk√ße" />
    <meta
      name="description"
      content="Geli≈ümi≈ü AI chat deneyimi. Geli≈ümi≈ü AI-4, Kurumsal AI 3, Yapay Zeka Pro ile T√ºrk√ße sohbet edin. √úcretsiz, hƒ±zlƒ± ve g√ºvenli yapay zeka sohbet platformu."
    />
    <meta
      name="keywords"
      content="ai chat, geli≈ümi≈ü ai t√ºrk√ße, kurumsal ai t√ºrk√ße, yapay zeka t√ºrk√ße, yapay zeka sohbet, √ºcretsiz ai chat"
    />
    <meta name="author" content="AILYDIAN" />
    <meta
      name="robots"
      content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"
    />
    <meta name="language" content="tr" />
    <link rel="canonical" href="https://www.ailydian.com/chat.html" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.ailydian.com/chat.html" />
    <meta
      property="og:title"
      content="AI Chat - AILYDIAN | Geli≈ümi≈ü AI, Kurumsal AI, Yapay Zeka T√ºrk√ße"
    />
    <meta
      property="og:description"
      content="Geli≈ümi≈ü AI chat deneyimi. Geli≈ümi≈ü AI-4, Kurumsal AI 3, Yapay Zeka Pro ile T√ºrk√ße sohbet edin. √úcretsiz, hƒ±zlƒ± ve g√ºvenli yapay zeka sohbet platformu."
    />
    <meta property="og:image" content="https://www.ailydian.com/images/logo.png" />
    <meta property="og:site_name" content="AILYDIAN" />
    <meta property="og:locale" content="tr_TR" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://www.ailydian.com/chat.html" />
    <meta
      name="twitter:title"
      content="AI Chat - AILYDIAN | Geli≈ümi≈ü AI, Kurumsal AI, Yapay Zeka T√ºrk√ße"
    />
    <meta
      name="twitter:description"
      content="Geli≈ümi≈ü AI chat deneyimi. Geli≈ümi≈ü AI-4, Kurumsal AI 3, Yapay Zeka Pro ile T√ºrk√ße sohbet edin. √úcretsiz, hƒ±zlƒ± ve g√ºvenli yapay zeka sohbet platformu."
    />
    <meta name="twitter:image" content="https://www.ailydian.com/images/logo.png" />
    <meta name="twitter:site" content="@ailydian" />
    <meta name="twitter:creator" content="@ailydian" />

    <!-- AI Search Optimization -->
    <meta
      name="ai:context"
      content="AILYDIAN Chat, kullanƒ±cƒ±larƒ±n LyDian Quantum, LyDian Ultra ve LyDian Vision gibi en geli≈ümi≈ü AI motorlarƒ±yla doƒüal dilde sohbet etmesini saƒülayan √ºcretsiz platformdur. T√ºrk√ße, ƒ∞ngilizce ve 20+ dilde destek sunar."
    />
    <meta
      name="ai:keywords"
      content="ai chat, lydian ai t√ºrk√ße, yapay zeka t√ºrk√ße, yapay zeka sohbet, √ºcretsiz ai chat"
    />
    <meta name="ai:language" content="tr" />

    <!-- LyDian AI Optimization -->
    <meta
      name="description:ai"
      content="AILYDIAN Chat, kullanƒ±cƒ±larƒ±n LyDian Quantum, LyDian Ultra ve LyDian Vision gibi en geli≈ümi≈ü AI motorlarƒ±yla doƒüal dilde sohbet etmesini saƒülayan √ºcretsiz platformdur. T√ºrk√ße, ƒ∞ngilizce ve 20+ dilde destek sunar."
    />
    <meta
      name="summary"
      content="Geli≈ümi≈ü AI chat deneyimi. LyDian Quantum, LyDian Ultra, LyDian Vision ile T√ºrk√ße sohbet edin. √úcretsiz, hƒ±zlƒ± ve g√ºvenli yapay zeka sohbet platformu."
    />

    <!-- Geo Targeting -->
    <meta name="geo.region" content="TR" />
    <meta name="geo.placename" content="Istanbul" />

    <!-- Mobile Optimization -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="AILYDIAN" />

    <!-- Hreflang Tags for International SEO -->
    <link rel="alternate" hreflang="tr" href="https://www.ailydian.com/chat.html" />
    <link rel="alternate" hreflang="en" href="https://www.ailydian.com/en/chat.html" />
    <link rel="alternate" hreflang="ar" href="https://www.ailydian.com/ar/chat.html" />
    <link rel="alternate" hreflang="es" href="https://www.ailydian.com/es/chat.html" />
    <link rel="alternate" hreflang="fr" href="https://www.ailydian.com/fr/chat.html" />
    <link rel="alternate" hreflang="de" href="https://www.ailydian.com/de/chat.html" />
    <link rel="alternate" hreflang="it" href="https://www.ailydian.com/it/chat.html" />
    <link rel="alternate" hreflang="pt" href="https://www.ailydian.com/pt/chat.html" />
    <link rel="alternate" hreflang="ru" href="https://www.ailydian.com/ru/chat.html" />
    <link rel="alternate" hreflang="zh" href="https://www.ailydian.com/zh/chat.html" />
    <link rel="alternate" hreflang="ja" href="https://www.ailydian.com/ja/chat.html" />
    <link rel="alternate" hreflang="ko" href="https://www.ailydian.com/ko/chat.html" />
    <link rel="alternate" hreflang="hi" href="https://www.ailydian.com/hi/chat.html" />
    <link rel="alternate" hreflang="id" href="https://www.ailydian.com/id/chat.html" />
    <link rel="alternate" hreflang="nl" href="https://www.ailydian.com/nl/chat.html" />
    <link rel="alternate" hreflang="pl" href="https://www.ailydian.com/pl/chat.html" />
    <link rel="alternate" hreflang="sv" href="https://www.ailydian.com/sv/chat.html" />
    <link rel="alternate" hreflang="no" href="https://www.ailydian.com/no/chat.html" />
    <link rel="alternate" hreflang="da" href="https://www.ailydian.com/da/chat.html" />
    <link rel="alternate" hreflang="fi" href="https://www.ailydian.com/fi/chat.html" />
    <link rel="alternate" hreflang="x-default" href="https://www.ailydian.com/chat.html" />

    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "AILYDIAN Chat",
        "applicationCategory": "CommunicationApplication",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        }
      }
    </script>

    <!-- Organization Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "TechnologyCompany",
        "name": "AILYDIAN",
        "url": "https://www.ailydian.com",
        "logo": "https://www.ailydian.com/images/logo.png",
        "sameAs": [
          "https://twitter.com/ailydian",
          "https://linkedin.com/company/ailydian",
          "https://github.com/ailydian"
        ],
        "contactPoint": {
          "@type": "ContactPoint",
          "email": "info@ailydian.com",
          "contactType": "customer service"
        }
      }
    </script>

    <!-- ================================ -->
    <!-- END AILYDIAN SEO META TAGS -->
    <!-- ================================ -->
  </head>
  <body>
    <!-- üöÄ MAIN CHAT CONTAINER -->
    <div class="chat-container">
      <!-- üìÇ SIDEBAR -->
      <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <button class="sidebar-toggle" id="sidebarToggle">
            <img
              src="/icons/grape-icon-simple.svg"
              alt="LyDian Logo"
              loading="eager"
              fetchpriority="high"
              width="800"
              height="600"
            />
          </button>
          <div
            class="logo"
            style="
              display: flex;
              align-items: center;
              gap: 8px;
              font-family: 'Inter', sans-serif !important;
              font-weight: 900 !important;
            "
          >
            <span>LyDian</span>
          </div>
        </div>

        <button class="new-chat-btn" id="newChatBtn">
          <svg viewBox="0 0 24 24">
            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path>
          </svg>
          <span>Yeni Sohbet</span>
        </button>

        <div class="chat-history" id="chatHistory">
          <!-- Chat history items will be added here -->
        </div>

        <!-- üë§ USER MENU (Bottom of sidebar) -->
        <div class="sidebar-footer">
          <div class="sidebar-search">
            <svg viewBox="0 0 24 24">
              <path
                d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"
              ></path>
            </svg>
            <input type="text" placeholder="Ara..." id="sidebarSearch" />
          </div>

          <div class="user-menu">
            <div class="user-info" id="userMenuBtn">
              <div class="user-avatar">
                <svg viewBox="0 0 24 24">
                  <path
                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                  ></path>
                </svg>
              </div>
              <div class="user-details">
                <div class="user-name">Kullanƒ±cƒ±</div>
                <div class="user-email">user@example.com</div>
              </div>
              <svg class="user-menu-arrow" viewBox="0 0 24 24">
                <path d="M7 10l5 5 5-5z"></path>
              </svg>
            </div>

            <div class="user-dropdown" id="userDropdown">
              <a href="/settings.html" class="dropdown-item">
                <svg viewBox="0 0 24 24">
                  <path
                    d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"
                  ></path>
                </svg>
                Ayarlar
              </a>
              <a href="/billing.html" class="dropdown-item">
                <svg viewBox="0 0 24 24">
                  <path
                    d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"
                  ></path>
                </svg>
                √ñdeme &amp; Plan
              </a>
              <a href="/api-reference.html" class="dropdown-item">
                <svg viewBox="0 0 24 24">
                  <path
                    d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"
                  ></path>
                </svg>
                API Anahtarlarƒ±
              </a>
              <a href="/help.html" class="dropdown-item">
                <svg viewBox="0 0 24 24">
                  <path
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"
                  ></path>
                </svg>
                Yardƒ±m &amp; Destek
              </a>
              <div class="dropdown-divider"></div>
              <a href="/login.html" class="dropdown-item logout">
                <svg viewBox="0 0 24 24">
                  <path
                    d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"
                  ></path>
                </svg>
                √áƒ±kƒ±≈ü Yap
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- üí¨ MAIN CHAT AREA -->
      <div class="main-chat">
        <!-- üéØ HEADER -->
        <!-- üéõÔ∏è MOBILE LOGO WITH DROPDOWN -->
        <div class="mobile-logo-container">
          <button class="mobile-logo-toggle" id="mobileToggleBtn" title="Men√º">
            <img
              src="/icons/grape-icon-simple.svg"
              alt="LyDian Logo"
              loading="eager"
              width="800"
              height="600"
            />
            <span class="mobile-logo-text">LyDian</span>
          </button>
          <button class="mobile-dropdown-trigger" id="mobileDropdownBtn" aria-label="Men√º">
            <svg
              width="12"
              height="8"
              viewBox="0 0 12 8"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M1 1L6 6L11 1"
                stroke="white"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              ></path>
            </svg>
          </button>
          <div class="mobile-dropdown-menu" id="mobileDropdownMenu">
            <a
              href="/lydian-iq.html"
              target="_blank"
              rel="noopener noreferrer"
              class="mobile-dropdown-item"
              >IQ</a
            >
            <a
              href="/medical-expert.html"
              target="_blank"
              rel="noopener noreferrer"
              class="mobile-dropdown-item"
              >TIP</a
            >
            <a
              href="/knowledge-base.html"
              target="_blank"
              rel="noopener noreferrer"
              class="mobile-dropdown-item"
              >BANK</a
            >
          </div>
        </div>

        <!-- üì± MOBILE SIDEBAR MENU (Slide from right) -->
        <div class="mobile-sidebar" id="mobileSidebar">
          <div class="mobile-sidebar-header">
            <span class="mobile-sidebar-title">Men√º</span>
            <button class="mobile-sidebar-close" id="mobileSidebarClose">
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path
                  fill="currentColor"
                  d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                ></path>
              </svg>
            </button>
          </div>

          <div class="mobile-menu-item" id="menuDownload">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path
                fill="currentColor"
                d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"
              ></path>
            </svg>
            <span>Sohbeti ƒ∞ndir</span>
          </div>

          <div class="mobile-menu-item" id="menuShare">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path
                fill="currentColor"
                d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"
              ></path>
            </svg>
            <span>Sohbeti Payla≈ü</span>
          </div>
        </div>

        <div class="chat-header">
          <div class="header-left" style="display: flex; align-items: center; gap: 10px">
            <!-- Logo removed per user request -->
          </div>

          <div class="header-actions">
            <!-- üß† AI Connection Status Indicator -->
            <div class="recall-status-indicator" data-status="hybrid" id="recallStatus">
              <div class="recall-status-dot"></div>
              <span class="recall-status-text">üü° Hibrit</span>
            </div>

            <!-- üìç Visitor City Display -->
            <div id="visitor-city"></div>

            <!-- üì• Download Button - Minimal (Icon only) -->
            <button class="header-btn-icon" id="downloadBtn" title="Sohbeti ƒ∞ndir">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                <path
                  d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"
                ></path>
              </svg>
            </button>
            <!-- üîó Share Button - Minimal (Icon only) -->
            <button class="header-btn-icon" id="shareBtn" title="Sohbeti Payla≈ü">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                <path
                  d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"
                ></path>
              </svg>
            </button>
          </div>
        </div>

        <!-- üí≠ MESSAGES -->
        <div class="messages-container" id="messagesContainer">
          <div class="empty-state" id="emptyState">
            <!-- Particles background -->
            <div class="particles" id="particles"></div>

            <!-- üë§ USER WELCOME TEXT -->
            <div class="user-welcome-text" id="userWelcomeText">
              <div class="welcome-user-name" id="welcomeUserName">Ho≈ügeldiniz</div>
              <div class="welcome-message">Size Nasƒ±l Yardƒ±mcƒ± Olabilirim?</div>
            </div>

            <!-- üåå LyDian Orbit Loader -->
            <div class="mini-spinner-container">
              <div class="mini-spinner">
                <svg
                  viewBox="-60 -60 120 120"
                  width="120"
                  height="120"
                  role="img"
                  aria-label="LyDian orbit"
                >
                  <defs>
                    <radialGradient id="g-core" cx="50%" cy="50%" r="50%">
                      <stop offset="0%" stop-color="#7C5CFF" stop-opacity="1"></stop>
                      <stop offset="60%" stop-color="#00E0FF" stop-opacity="0.4"></stop>
                      <stop offset="100%" stop-color="#0B0F19" stop-opacity="0"></stop>
                    </radialGradient>
                    <linearGradient id="g-1" x1="0%" y1="0%" x2="100%" y2="100%">
                      <stop offset="0%" stop-color="#7C5CFF"></stop>
                      <stop offset="100%" stop-color="#00E0FF"></stop>
                    </linearGradient>
                    <linearGradient id="g-2" x1="0%" y1="100%" x2="100%" y2="0%">
                      <stop offset="0%" stop-color="#00E0FF"></stop>
                      <stop offset="100%" stop-color="#FF9D00"></stop>
                    </linearGradient>
                    <linearGradient id="g-3" x1="100%" y1="0%" x2="0%" y2="100%">
                      <stop offset="0%" stop-color="#FF9D00"></stop>
                      <stop offset="100%" stop-color="#7C5CFF"></stop>
                    </linearGradient>
                  </defs>

                  <!-- Background aura -->
                  <circle r="48" fill="url(#g-core)" opacity="0.2"></circle>

                  <!-- Orbit 1 - Outer ellipse -->
                  <g class="lydian-orbit-ring-1">
                    <ellipse
                      rx="50"
                      ry="30"
                      fill="none"
                      stroke="url(#g-1)"
                      stroke-opacity="0.7"
                      stroke-width="0.8"
                    ></ellipse>
                    <circle cx="50" cy="0" r="2" fill="#00E0FF"></circle>
                    <circle cx="-50" cy="0" r="2" fill="#00E0FF"></circle>
                  </g>

                  <!-- Orbit 2 - Middle circle -->
                  <g class="lydian-orbit-ring-2">
                    <circle
                      r="38"
                      fill="none"
                      stroke="url(#g-2)"
                      stroke-opacity="0.8"
                      stroke-width="0.8"
                    ></circle>
                    <circle cx="38" cy="0" r="1.5" fill="#FF9D00"></circle>
                    <circle cx="-38" cy="0" r="1.5" fill="#FF9D00"></circle>
                    <circle cx="0" cy="38" r="1.5" fill="#FF9D00"></circle>
                    <circle cx="0" cy="-38" r="1.5" fill="#FF9D00"></circle>
                  </g>

                  <!-- Orbit 3 - Inner circle -->
                  <g class="lydian-orbit-ring-3">
                    <circle
                      r="25"
                      fill="none"
                      stroke="url(#g-3)"
                      stroke-opacity="0.9"
                      stroke-width="1"
                      stroke-dasharray="1.5 5"
                    ></circle>
                  </g>

                  <!-- Lissajous satellites -->
                  <g class="lydian-lissajous">
                    <circle r="2.5" fill="#7C5CFF"></circle>
                  </g>

                  <!-- Core nucleus -->
                  <circle r="12" fill="#111827"></circle>
                  <circle r="12" fill="url(#g-core)" opacity="0.35"></circle>
                  <circle r="0.8" fill="#7C5CFF"></circle>
                </svg>
              </div>
            </div>
          </div>

          <!-- ‚ö° PROMINENT LOADING INDICATOR (Shows during AI queries) -->
          <div class="loading-indicator" id="loadingIndicator">
            <div class="loading-spinner"></div>
            <div class="loading-text">
              <span>AI d√º≈ü√ºn√ºyor</span>
              <div class="loading-dots">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>

          <!-- ‚ú® FIRE SPARKS CONTAINER -->
          <div id="fireSparks" class="fire-sparks"></div>
        </div>

        <!-- ‚úçÔ∏è INPUT AREA -->
        <div class="input-container" id="mainInputContainer">
          <!-- ‚ö° AI MODE SELECTORS (VISIBLE & PROMINENT) -->
          <div class="input-mode-selectors">
            <button class="mode-btn active" data-mode="general" title="Genel Sohbet">
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path
                  d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"
                ></path>
              </svg>
              <span>Genel</span>
            </button>
            <button
              class="mode-btn"
              data-mode="deep-think"
              title="Derin D√º≈ü√ºnce (ERNIE)"
              data-ai-type="deep-think"
            >
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path
                  d="M9 11.75c-.69 0-1.25.56-1.25 1.25s.56 1.25 1.25 1.25 1.25-.56 1.25-1.25-.56-1.25-1.25-1.25zm6 0c-.69 0-1.25.56-1.25 1.25s.56 1.25 1.25 1.25 1.25-.56 1.25-1.25-.56-1.25-1.25-1.25zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8 0-.29.02-.58.05-.86 2.36-1.05 4.23-2.98 5.21-5.37C11.07 8.33 14.05 10 17.42 10c.78 0 1.53-.09 2.25-.26.21.71.33 1.47.33 2.26 0 4.41-3.59 8-8 8z"
                ></path>
              </svg>
              <span>Derin D√º≈ü√ºnce</span>
            </button>
            <button
              class="mode-btn"
              data-mode="web-search"
              title="Web Arama (LyDian Acceleration)"
              data-ai-type="web-search"
            >
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path
                  d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"
                ></path>
              </svg>
              <span>Web Arama</span>
            </button>
          </div>

          <!-- ü§ñ AI MODEL SELECTORS (Advanced, Premium, Ultra) -->
          <div
            class="input-mode-selectors"
            style="
              margin-top: 0.5rem;
              border-top: 1px solid var(--border-light);
              padding-top: 0.5rem;
            "
          >
            <button class="mode-btn" data-model="model-a" title="Advanced Mode">
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path
                  d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                ></path>
              </svg>
              <span>Advanced</span>
            </button>
            <button class="mode-btn active" data-model="model-p" title="Premium Mode">
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path
                  d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5zm0 18.5c-3.87-1.18-6.5-4.85-6.5-8.5V8.3l6.5-3.11 6.5 3.11V12c0 3.65-2.63 7.32-6.5 8.5z"
                ></path>
              </svg>
              <span>Premium</span>
            </button>
            <button class="mode-btn" data-model="model-u" title="Ultra Mode">
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path
                  d="M12 2L1 12l11 10 11-10L12 2zm0 2.83L19.17 12 12 19.17 4.83 12 12 4.83z"
                ></path>
              </svg>
              <span>Ultra</span>
            </button>
            <button class="mode-btn" data-model="model-r" title="Research Mode">
              <svg viewBox="0 0 24 24" width="20" height="20">
                <path
                  d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"
                ></path>
              </svg>
              <span>Research</span>
            </button>
          </div>

          <!-- üìä MOBILE STATS - Above form on mobile -->
          <div class="mobile-input-stats" id="mobileInputStats">
            <span class="stat-item"> <span id="mobileCharCount">0</span> karakter </span>
            <span class="stat-divider">‚Ä¢</span>
            <span class="stat-item token-highlight">
              ~<span id="mobileTokenCount">0</span> token
            </span>
            <span class="stat-item speed-item" id="mobileSpeedDisplay" style="display: none">
              <span class="stat-divider">‚Ä¢</span>
              <span id="mobileSpeedValue">0</span> t/s
            </span>
          </div>

          <!-- üéØ PREMIUM INPUT WRAPPER -->
          <div class="input-wrapper">
            <!-- üì± Mobile Plus Button (Left side) -->
            <div class="mobile-plus-container">
              <button class="mobile-plus-btn" id="mobilePlusBtn" title="Se√ßenekler">
                <svg viewBox="0 0 24 24" width="24" height="24">
                  <path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
                </svg>
              </button>

              <!-- üìã Mobile Plus Dropdown -->
              <div class="mobile-plus-dropdown" id="mobilePlusDropdown">
                <button class="plus-dropdown-item" id="plusVoiceBtn">
                  <svg viewBox="0 0 24 24" width="20" height="20">
                    <path
                      fill="currentColor"
                      d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"
                    />
                    <path
                      fill="currentColor"
                      d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"
                    />
                  </svg>
                  <span>Sesli Giri≈ü</span>
                </button>
                <button class="plus-dropdown-item" id="plusFileBtn">
                  <svg viewBox="0 0 24 24" width="20" height="20">
                    <path
                      fill="currentColor"
                      d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"
                    />
                  </svg>
                  <span>Dosya Y√ºkle</span>
                </button>
              </div>
            </div>

            <textarea
              id="messageInput"
              placeholder="LyDian'a bir ≈üey sorun..."
              rows="1"
              autocomplete="off"
              autocorrect="on"
              autocapitalize="sentences"
              spellcheck="true"
            ></textarea>

            <!-- üé¨ Input Actions - Right side -->
            <div class="input-actions">
              <!-- üìÅ File Upload Button -->
              <button class="file-upload-btn" id="fileUploadBtn" title="Dosya Y√ºkle">
                <svg viewBox="0 0 24 24" width="20" height="20">
                  <path
                    fill="currentColor"
                    d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"
                  />
                </svg>
              </button>

              <!-- üé§ Voice Chat Button -->
              <button class="voice-chat-btn" id="voiceChatBtn" title="Sesli Sohbet">
                <svg viewBox="0 0 24 24" width="20" height="20">
                  <path
                    fill="currentColor"
                    d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"
                  />
                  <path
                    fill="currentColor"
                    d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"
                  />
                </svg>
              </button>

              <!-- üöÄ Send Button -->
              <button id="sendBtn" disabled>
                <svg viewBox="0 0 24 24">
                  <path
                    d="M3.4 20.4l17.45-7.48c.81-.35.81-1.49 0-1.84L3.4 3.6c-.66-.29-1.39.2-1.39.91L2 9.12c0 .5.37.93.87.99L17 12 2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91z"
                  ></path>
                </svg>
              </button>
            </div>

            <!-- Hidden file input -->
            <input
              type="file"
              id="mainFileInput"
              accept="image/*,.pdf,.doc,.docx,.txt,.md,.csv"
              style="display: none"
            />
          </div>

          <!-- üìä DESKTOP STATS & DISCLAIMER - Below input form -->
          <div class="desktop-stats-disclaimer" id="desktopStatsDisclaimer">
            <div class="desktop-stats-row">
              <span class="desktop-stat-item">
                <svg
                  viewBox="0 0 24 24"
                  width="14"
                  height="14"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                  <polyline points="14 2 14 8 20 8" />
                  <line x1="16" y1="13" x2="8" y2="13" />
                  <line x1="16" y1="17" x2="8" y2="17" />
                </svg>
                <span id="desktopCharCount">0</span> karakter
              </span>
              <span class="desktop-stat-divider">|</span>
              <span class="desktop-stat-item token-stat">
                <svg
                  viewBox="0 0 24 24"
                  width="14"
                  height="14"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <path d="M12 6v6l4 2" />
                </svg>
                ~<span id="desktopTokenCount">0</span> token
              </span>
              <span class="desktop-stat-divider">|</span>
              <span class="desktop-disclaimer">
                <svg
                  viewBox="0 0 24 24"
                  width="14"
                  height="14"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <line x1="12" y1="8" x2="12" y2="12" />
                  <line x1="12" y1="16" x2="12.01" y2="16" />
                </svg>
                LyDian hata yapabilir
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- üé® THEME MODAL -->
    <div class="modal-overlay" id="themeModal">
      <div class="modal">
        <div class="modal-header">
          <h2 class="modal-title">Tema Se√ßin</h2>
          <button class="modal-close" id="closeThemeModalBtn">
            <svg viewBox="0 0 24 24">
              <path
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
              ></path>
            </svg>
          </button>
        </div>
        <div class="theme-options">
          <div class="theme-option active" data-theme="dark">
            <div class="theme-preview">
              <div class="theme-preview-color" style="background: #10a37f"></div>
              <div class="theme-preview-color" style="background: #ff6b4a"></div>
              <div class="theme-preview-color" style="background: #fff"></div>
            </div>
            <div class="theme-name">Neon Dark</div>
          </div>
          <div class="theme-option" data-theme="ocean">
            <div class="theme-preview">
              <div class="theme-preview-color" style="background: #00d4ff"></div>
              <div class="theme-preview-color" style="background: #4ae3ff"></div>
              <div class="theme-preview-color" style="background: #00a8cc"></div>
            </div>
            <div class="theme-name">Ocean Blue</div>
          </div>
          <div class="theme-option" data-theme="forest">
            <div class="theme-preview">
              <div class="theme-preview-color" style="background: #00ff88"></div>
              <div class="theme-preview-color" style="background: #4affaa"></div>
              <div class="theme-preview-color" style="background: #00cc6a"></div>
            </div>
            <div class="theme-name">Forest Green</div>
          </div>
          <div class="theme-option" data-theme="purple">
            <div class="theme-preview">
              <div class="theme-preview-color" style="background: #b24bf3"></div>
              <div class="theme-preview-color" style="background: #c77dff"></div>
              <div class="theme-preview-color" style="background: #9333ea"></div>
            </div>
            <div class="theme-name">Purple Dream</div>
          </div>
          <div class="theme-option" data-theme="sunset">
            <div class="theme-preview">
              <div class="theme-preview-color" style="background: #ff6b9d"></div>
              <div class="theme-preview-color" style="background: #ff8fab"></div>
              <div class="theme-preview-color" style="background: #e64a7a"></div>
            </div>
            <div class="theme-name">Sunset Pink</div>
          </div>
          <div class="theme-option" data-theme="minimal-dark">
            <div class="theme-preview">
              <div class="theme-preview-color" style="background: #fff"></div>
              <div class="theme-preview-color" style="background: #e5e5e5"></div>
              <div class="theme-preview-color" style="background: #d0d0d0"></div>
            </div>
            <div class="theme-name">Minimal Dark</div>
          </div>
        </div>
      </div>
    </div>

    <!-- üé¨ IMAGE MODAL -->
    <div class="modal-overlay" id="imageModal">
      <div class="modal">
        <div class="modal-header">
          <h2 class="modal-title">G√∂rsel Olu≈ütur</h2>
          <button class="modal-close" id="closeImageModalBtn">
            <svg viewBox="0 0 24 24">
              <path
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
              ></path>
            </svg>
          </button>
        </div>
        <div style="padding: 1rem 0">
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 1rem">
            LyDian AI ile g√∂rsel olu≈ütur
          </p>
          <textarea
            id="imagePromptInput"
            placeholder="G√∂rsel a√ßƒ±klamasƒ±..."
            style="
              width: 100%;
              min-height: 100px;
              padding: 1rem;
              background: rgba(255, 255, 255, 0.05);
              border: 1px solid rgba(255, 255, 255, 0.15);
              border-radius: 12px;
              color: #ffffff;
              font-family: inherit;
              resize: vertical;
            "
          ></textarea>
          <button id="generateImageBtn">Olu≈ütur</button>
        </div>
      </div>
    </div>

    <!-- üé¨ VIDEO MODAL -->
    <div class="modal-overlay" id="videoModal">
      <div class="modal">
        <div class="modal-header">
          <h2 class="modal-title">Video Olu≈ütur</h2>
          <button class="modal-close" id="closeVideoModalBtn">
            <svg viewBox="0 0 24 24">
              <path
                d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
              ></path>
            </svg>
          </button>
        </div>
        <div style="padding: 1rem 0">
          <p style="color: rgba(255, 255, 255, 0.7); margin-bottom: 1rem">
            LyDian AI ile video olu≈ütur
          </p>
          <textarea
            id="videoPromptInput"
            placeholder="Video a√ßƒ±klamasƒ±..."
            style="
              width: 100%;
              min-height: 100px;
              padding: 1rem;
              background: rgba(255, 255, 255, 0.05);
              border: 1px solid rgba(255, 255, 255, 0.15);
              border-radius: 12px;
              color: #ffffff;
              font-family: inherit;
              resize: vertical;
            "
          ></textarea>
          <div style="margin-top: 1rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem">
            <div>
              <label
                style="
                  display: block;
                  margin-bottom: 0.5rem;
                  color: rgba(255, 255, 255, 0.7);
                  font-size: 0.9rem;
                "
                >S√ºre (saniye)</label
              >
              <input
                type="number"
                id="videoDuration"
                value="5"
                min="3"
                max="30"
                style="
                  width: 100%;
                  padding: 0.75rem;
                  background: rgba(255, 255, 255, 0.05);
                  border: 1px solid rgba(255, 255, 255, 0.15);
                  border-radius: 8px;
                  color: #ffffff;
                  font-family: inherit;
                "
              />
            </div>
            <div>
              <label
                style="
                  display: block;
                  margin-bottom: 0.5rem;
                  color: rgba(255, 255, 255, 0.7);
                  font-size: 0.9rem;
                "
                >√á√∂z√ºn√ºrl√ºk</label
              >
              <select
                id="videoResolution"
                style="
                  width: 100%;
                  padding: 0.75rem;
                  background: rgba(255, 255, 255, 0.05);
                  border: 1px solid rgba(255, 255, 255, 0.15);
                  border-radius: 8px;
                  color: #ffffff;
                  font-family: inherit;
                "
              >
                <option value="720p">720p</option>
                <option value="1080p" selected="">1080p</option>
                <option value="4k">4K</option>
              </select>
            </div>
          </div>
          <button id="generateVideoBtn">Video Olu≈ütur</button>
          <div
            id="videoGenerationStatus"
            style="
              margin-top: 1rem;
              padding: 1rem;
              background: rgba(16, 163, 127, 0.1);
              border: 1px solid #10a37f;
              border-radius: 12px;
              display: none;
            "
          >
            <p id="videoStatusText" style="color: #ffffff"></p>
          </div>
        </div>
      </div>
    </div>

    <!-- üöÄ JAVASCRIPT -->
    <script>
      // ========== STATE ==========
      const state = {
        messages: [],
        currentChatId: null,
        isTyping: false,
        selectedModel: 'enterprise-ai', // Default: Premium AI
        selectedAiType: 'general', // üéØ Track specialized AI mode
      };

      // ========== ELEMENTS ==========
      const elements = {
        sidebar: document.getElementById('sidebar'),
        sidebarToggle: document.getElementById('sidebarToggle'),
        sidebarOpenBtn: document.getElementById('sidebarOpenBtn'),
        newChatBtn: document.getElementById('newChatBtn'),
        chatHistory: document.getElementById('chatHistory'),
        messagesContainer: document.getElementById('messagesContainer'),
        messageInput: document.getElementById('messageInput'),
        sendBtn: document.getElementById('sendBtn'),
        charCount: document.getElementById('charCount'),
        tokenCount: document.getElementById('tokenCount'),
        tokenCountHeader: document.getElementById('tokenCountHeader'),
        // Desktop stats elements
        desktopCharCount: document.getElementById('desktopCharCount'),
        desktopTokenCount: document.getElementById('desktopTokenCount'),
        // Mobile stats elements
        mobileCharCount: document.getElementById('mobileCharCount'),
        mobileTokenCount: document.getElementById('mobileTokenCount'),
        emptyState: document.getElementById('emptyState'),
        themeBtn: document.getElementById('themeBtn'),
        themeModal: document.getElementById('themeModal'),
        closeThemeModalBtn: document.getElementById('closeThemeModalBtn'),
        imageBtn: document.getElementById('imageBtn'),
        imageModal: document.getElementById('imageModal'),
        closeImageModalBtn: document.getElementById('closeImageModalBtn'),
        videoBtn: document.getElementById('videoBtn'),
        videoModal: document.getElementById('videoModal'),
        closeVideoModalBtn: document.getElementById('closeVideoModalBtn'),
        downloadBtn: document.getElementById('downloadBtn'),
        deepThinkBtn: document.getElementById('deepThinkBtn'),
        webSearchBtn: document.getElementById('webSearchBtn'),
        shareBtn: document.getElementById('shareBtn'),
        speedDisplay: document.getElementById('speedDisplay'),
        speedValue: document.getElementById('speedValue'),
        responseTokens: document.getElementById('responseTokens'),
        responseTokenValue: document.getElementById('responseTokenValue'),
        plusBtn: document.getElementById('plusBtn'),
        plusDropdown: document.getElementById('plusDropdown'),
        // üåü Neon AI Mode Icons
        neonDeepThinkBtn: document.getElementById('neonDeepThinkBtn'),
        neonWebSearchBtn: document.getElementById('neonWebSearchBtn'),
        neonImageBtn: document.getElementById('neonImageBtn'),
        neonVideoBtn: document.getElementById('neonVideoBtn'),
        neonMicBtn: document.getElementById('neonMicBtn'),
        neonCodeBtn: document.getElementById('neonCodeBtn'),
      };

      // ========== EVENT LISTENERS ==========

      // Sidebar toggle
      if (elements.sidebarToggle && elements.sidebar) {
        elements.sidebarToggle.addEventListener('click', () => {
          // DEBUG: console.log('üîò Sidebar toggle clicked');
          elements.sidebar.classList.toggle('collapsed');
        });
        // DEBUG: console.log('‚úÖ Sidebar toggle listener added');
      } else {
        console.error('‚ùå Sidebar toggle elements not found:', {
          sidebarToggle: !!elements.sidebarToggle,
          sidebar: !!elements.sidebar,
        });
      }

      if (elements.sidebarOpenBtn && elements.sidebar) {
        elements.sidebarOpenBtn.addEventListener('click', () => {
          // DEBUG: console.log('üìÇ Sidebar open clicked');
          elements.sidebar.classList.remove('collapsed');
        });
        // DEBUG: console.log('‚úÖ Sidebar open listener added');
      }

      // New chat
      if (elements.newChatBtn) {
        elements.newChatBtn.addEventListener('click', () => {
          // DEBUG: console.log('üÜï New chat button clicked');
          startNewChat();
        });
        // DEBUG: console.log('‚úÖ New chat listener added');
      } else {
        console.error('‚ùå New chat button not found');
      }

      // Message input - with null checks
      if (elements.messageInput) {
        elements.messageInput.addEventListener('input', e => {
          // Auto-resize
          e.target.style.height = 'auto';
          e.target.style.height = e.target.scrollHeight + 'px';

          // Update counters
          const text = e.target.value;
          const charCount = text.length;
          const tokenCount = Math.ceil(charCount / 4); // Rough estimate

          if (elements.charCount) elements.charCount.textContent = charCount;
          if (elements.tokenCount) elements.tokenCount.textContent = tokenCount;
          if (elements.tokenCountHeader) elements.tokenCountHeader.textContent = tokenCount;

          // Update desktop & mobile stats
          if (elements.desktopCharCount) elements.desktopCharCount.textContent = charCount;
          if (elements.desktopTokenCount) elements.desktopTokenCount.textContent = tokenCount;
          if (elements.mobileCharCount) elements.mobileCharCount.textContent = charCount;
          if (elements.mobileTokenCount) elements.mobileTokenCount.textContent = tokenCount;

          // Enable/disable send button
          if (elements.sendBtn) elements.sendBtn.disabled = text.trim().length === 0;
        });

        elements.messageInput.addEventListener('keydown', e => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMessage();
          }
        });
      } else {
        console.error('[CHAT] Message input element not found!');
      }

      // Send button - with null check
      if (elements.sendBtn) {
        elements.sendBtn.addEventListener('click', sendMessage);
      } else {
        console.error('[CHAT] Send button element not found!');
      }

      // Theme modal (LEGACY - Theme system removed, keeping for safety)
      if (elements.themeBtn && elements.themeModal && elements.closeThemeModalBtn) {
        elements.themeBtn.addEventListener('click', () => {
          elements.themeModal.classList.add('active');
          updateActiveThemeOption();
        });

        elements.closeThemeModalBtn.addEventListener('click', () => {
          elements.themeModal.classList.remove('active');
        });

        elements.themeModal.addEventListener('click', e => {
          if (e.target === elements.themeModal) {
            elements.themeModal.classList.remove('active');
          }
        });

        // Theme options
        document.querySelectorAll('.theme-option').forEach(option => {
          option.addEventListener('click', () => {
            const themeName = option.dataset.theme;
            setTheme(themeName);
            localStorage.setItem('lydian_theme', themeName);
            updateActiveThemeOption();
            showToast(`‚ú® ${option.querySelector('.theme-name').textContent} aktif!`);
            setTimeout(() => {
              elements.themeModal.classList.remove('active');
            }, 600);
          });
        });
      }

      // Image modal (LEGACY - Buttons removed from header, keeping modals for safety)
      if (elements.imageBtn && elements.imageModal && elements.closeImageModalBtn) {
        elements.imageBtn.addEventListener('click', () => {
          elements.imageModal.classList.add('active');
        });

        elements.closeImageModalBtn.addEventListener('click', () => {
          elements.imageModal.classList.remove('active');
        });

        const generateImageBtn = document.getElementById('generateImageBtn');
        if (generateImageBtn) {
          generateImageBtn.addEventListener('click', async () => {
            const imagePromptInput = document.getElementById('imagePromptInput');
            const prompt = imagePromptInput?.value.trim();
            if (!prompt) {
              alert('L√ºtfen g√∂rsel a√ßƒ±klamasƒ± girin!');
              return;
            }

            elements.imageModal.classList.remove('active');
            addMessage(
              'assistant',
              `üé® **G√∂rsel Olu≈üturuluyor...**\n\n**Prompt:** ${prompt}\n\n*LyDian AI ile g√∂rsel olu≈üturuluyor...*`
            );
          });
        }
      }

      // Video modal (LEGACY - Buttons removed from header, keeping modals for safety)
      if (elements.videoBtn && elements.videoModal && elements.closeVideoModalBtn) {
        elements.videoBtn.addEventListener('click', () => {
          elements.videoModal.classList.add('active');
        });

        elements.closeVideoModalBtn.addEventListener('click', () => {
          elements.videoModal.classList.remove('active');
        });

        const generateVideoBtn = document.getElementById('generateVideoBtn');
        if (generateVideoBtn) {
          generateVideoBtn.addEventListener('click', async () => {
            const videoPromptInput = document.getElementById('videoPromptInput');
            const prompt = videoPromptInput?.value.trim();
            if (!prompt) {
              alert('L√ºtfen video a√ßƒ±klamasƒ± girin!');
              return;
            }

            const videoDuration = document.getElementById('videoDuration');
            const videoResolution = document.getElementById('videoResolution');
            const duration = videoDuration?.value;
            const resolution = videoResolution?.value;

            elements.videoModal.classList.remove('active');
            addMessage(
              'assistant',
              `üé¨ **Video Olu≈üturuluyor...**\n\n**Prompt:** ${prompt}\n**S√ºre:** ${duration}s\n**√á√∂z√ºn√ºrl√ºk:** ${resolution}\n\n*LyDian AI ile video olu≈üturuluyor...*`
            );
          });
        }
      }

      // Download
      if (elements.downloadBtn) {
        elements.downloadBtn.addEventListener('click', () => {
          const format = prompt(
            'ƒ∞ndirme formatƒ± se√ßin:\n1. JSON\n2. TXT\n3. MD (Markdown)\n4. CSV\n\nNumara girin (1-4):',
            '1'
          );

          if (!format) return;

          const formatMap = {
            1: 'json',
            2: 'txt',
            3: 'md',
            4: 'csv',
          };

          const selectedFormat = formatMap[format] || 'json';
          downloadConversation(selectedFormat);
        });
      }

      // üß† Deep Think Button (ERNIE multi-language)
      if (elements.deepThinkBtn) {
        elements.deepThinkBtn.addEventListener('click', () => {
          state.selectedAiType = 'reasoning'; // Uses LyDian AI Reasoning Engine
          showToast('üß† Derin D√º≈ü√ºnce Modu Aktif (ERNIE/Zhipu)');
        });
      }

      // üåê Web Search Button (LyDian Acceleration)
      if (elements.webSearchBtn) {
        elements.webSearchBtn.addEventListener('click', () => {
          state.selectedAiType = 'web-search';
          showToast('üåê Web Arama Modu Aktif (LyDian Acceleration)');
        });
      }

      // üåü NEON AI MODE ICON HANDLERS (Premium Inline Icons)
      // Helper function to toggle active neon icon with animation
      function toggleNeonIcon(activeIcon) {
        // Remove active class from all neon icons
        const allNeonIcons = [
          elements.neonDeepThinkBtn,
          elements.neonWebSearchBtn,
          elements.neonImageBtn,
          elements.neonVideoBtn,
          elements.neonMicBtn,
          elements.neonCodeBtn,
        ].filter(Boolean);

        allNeonIcons.forEach(icon => icon.classList.remove('active'));

        // Add active class to clicked icon with animation
        if (activeIcon) {
          activeIcon.classList.add('active');

          // Trigger click animation (scale bounce)
          activeIcon.style.animation = 'none';
          setTimeout(() => {
            activeIcon.style.animation = '';
          }, 10);

          // Create ripple effect
          createRippleEffect(activeIcon);
        }
      }

      // Create ripple effect on icon click
      function createRippleEffect(element) {
        const ripple = document.createElement('span');
        const rect = element.getBoundingClientRect();

        ripple.style.cssText = `
                position: absolute;
                width: ${rect.width}px;
                height: ${rect.height}px;
                border-radius: 50%;
                background: rgba(16, 163, 127, 0.5);
                transform: scale(0);
                animation: rippleAnimation 0.6s ease-out;
                pointer-events: none;
                left: 0;
                top: 0;
            `;

        element.style.position = 'relative';
        element.appendChild(ripple);

        setTimeout(() => ripple.remove(), 600);
      }

      // üéØ MOBILE PLUS BUTTON - Toggle dropdown menu
      const mobilePlusBtn = document.getElementById('mobilePlusBtn');
      const mobilePlusDropdown = document.getElementById('mobilePlusDropdown');
      const plusVoiceBtn = document.getElementById('plusVoiceBtn');
      const plusFileBtn = document.getElementById('plusFileBtn');

      if (mobilePlusBtn && mobilePlusDropdown) {
        // Toggle dropdown on click
        mobilePlusBtn.addEventListener('click', e => {
          e.stopPropagation();
          mobilePlusBtn.classList.toggle('active');
          mobilePlusDropdown.classList.toggle('show');
        });

        // Close menu when clicking outside
        document.addEventListener('click', e => {
          if (!mobilePlusBtn.contains(e.target) && !mobilePlusDropdown.contains(e.target)) {
            mobilePlusBtn.classList.remove('active');
            mobilePlusDropdown.classList.remove('show');
          }
        });

        // Voice button - trigger voice chat
        if (plusVoiceBtn) {
          plusVoiceBtn.addEventListener('click', () => {
            mobilePlusBtn.classList.remove('active');
            mobilePlusDropdown.classList.remove('show');
            // Trigger voice chat
            const voiceChatBtn = document.getElementById('voiceChatBtn');
            if (voiceChatBtn) {
              voiceChatBtn.click();
            }
          });
        }

        // File button - trigger file upload
        if (plusFileBtn) {
          plusFileBtn.addEventListener('click', () => {
            mobilePlusBtn.classList.remove('active');
            mobilePlusDropdown.classList.remove('show');
            // Trigger file upload
            const mainFileInput = document.getElementById('mainFileInput');
            if (mainFileInput) {
              mainFileInput.click();
            }
          });
        }
      }

      // üìÅ DESKTOP FILE UPLOAD BUTTON - Trigger file input
      const fileUploadBtn = document.getElementById('fileUploadBtn');
      const mainFileInputDesktop = document.getElementById('mainFileInput');

      if (fileUploadBtn && mainFileInputDesktop) {
        fileUploadBtn.addEventListener('click', e => {
          e.preventDefault();
          e.stopPropagation();
          mainFileInputDesktop.click();
        });

        // Handle file selection
        mainFileInputDesktop.addEventListener('change', e => {
          const file = e.target.files[0];
          if (file) {
            console.log('[FileUpload] File selected:', file.name, file.type, file.size);
            handleFileUpload(file);
          }
        });
      }

      // üéõÔ∏è MOBILE TOGGLE BUTTON & SIDEBAR - Only close functionality
      const mobileToggleBtn = document.getElementById('mobileToggleBtn');
      const mobileSidebar = document.getElementById('mobileSidebar');
      const mobileSidebarClose = document.getElementById('mobileSidebarClose');
      const headerActions = document.querySelector('.header-actions');
      const menuDownload = document.getElementById('menuDownload');
      const menuShare = document.getElementById('menuShare');

      function closeMobileSidebar() {
        if (mobileSidebar) {
          mobileSidebar.classList.remove('open');
          if (headerActions) {
            headerActions.classList.remove('hide-on-sidebar-open');
          }
        }
      }

      // Mobile dropdown functionality
      const mobileDropdownBtn = document.getElementById('mobileDropdownBtn');
      const mobileDropdownMenu = document.getElementById('mobileDropdownMenu');

      if (mobileDropdownBtn && mobileDropdownMenu) {
        mobileDropdownBtn.addEventListener('click', e => {
          e.preventDefault();
          e.stopPropagation();
          mobileDropdownMenu.classList.toggle('show');
          mobileDropdownBtn.classList.toggle('open');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', e => {
          if (!e.target.closest('.mobile-logo-container')) {
            mobileDropdownMenu.classList.remove('show');
            mobileDropdownBtn.classList.remove('open');
          }
        });
      }

      // Toggle button only closes the sidebar (no opening)
      if (mobileToggleBtn) {
        mobileToggleBtn.addEventListener('click', closeMobileSidebar);
      }

      if (mobileSidebarClose) {
        mobileSidebarClose.addEventListener('click', closeMobileSidebar);
      }

      // Header download/share buttons open the sidebar on mobile
      const originalDownloadBtn = document.getElementById('downloadBtn');
      const originalShareBtn = document.getElementById('shareBtn');

      if (originalDownloadBtn && window.innerWidth <= 768) {
        originalDownloadBtn.addEventListener('click', e => {
          e.preventDefault();
          if (mobileSidebar) {
            mobileSidebar.classList.add('open');
            if (headerActions) {
              headerActions.classList.add('hide-on-sidebar-open');
            }
          }
        });
      }

      if (originalShareBtn && window.innerWidth <= 768) {
        originalShareBtn.addEventListener('click', e => {
          e.preventDefault();
          if (mobileSidebar) {
            mobileSidebar.classList.add('open');
            if (headerActions) {
              headerActions.classList.add('hide-on-sidebar-open');
            }
          }
        });
      }

      // Menu actions - actually perform download/share
      if (menuDownload) {
        menuDownload.addEventListener('click', () => {
          closeMobileSidebar();
          // Trigger actual download
          setTimeout(() => {
            if (originalDownloadBtn) {
              const clickEvent = new MouseEvent('click', {
                bubbles: true,
                cancelable: true,
                view: window,
              });
              // Remove our handler temporarily
              const handler = originalDownloadBtn.onclick;
              originalDownloadBtn.onclick = null;
              originalDownloadBtn.dispatchEvent(clickEvent);
              originalDownloadBtn.onclick = handler;
            }
          }, 300);
        });
      }

      if (menuShare) {
        menuShare.addEventListener('click', () => {
          closeMobileSidebar();
          // Trigger actual share
          setTimeout(() => {
            if (originalShareBtn) {
              const clickEvent = new MouseEvent('click', {
                bubbles: true,
                cancelable: true,
                view: window,
              });
              // Remove our handler temporarily
              const handler = originalShareBtn.onclick;
              originalShareBtn.onclick = null;
              originalShareBtn.dispatchEvent(clickEvent);
              originalShareBtn.onclick = handler;
            }
          }, 300);
        });
      }

      // üß† Neon Deep Thinking Icon
      if (elements.neonDeepThinkBtn) {
        elements.neonDeepThinkBtn.addEventListener('click', () => {
          state.selectedAiType = 'reasoning';
          toggleNeonIcon(elements.neonDeepThinkBtn);
        });
      }

      // üåê Neon Web Search Icon
      if (elements.neonWebSearchBtn) {
        elements.neonWebSearchBtn.addEventListener('click', () => {
          state.selectedAiType = 'web-search';
          toggleNeonIcon(elements.neonWebSearchBtn);
        });
      }

      // üñºÔ∏è Neon Image Generation Icon (LyDian AI)
      if (elements.neonImageBtn) {
        elements.neonImageBtn.addEventListener('click', () => {
          state.selectedAiType = 'image';
          toggleNeonIcon(elements.neonImageBtn);
          // No toast - only tooltip shows "Aktif"
        });
      }

      // üé• Video Generation Icon (LyDian AI)
      if (elements.neonVideoBtn) {
        elements.neonVideoBtn.addEventListener('click', () => {
          state.selectedAiType = 'video';
          toggleNeonIcon(elements.neonVideoBtn);
          // No toast - only tooltip shows "Aktif"
        });
      }

      // üé§ Voice Output Mode (LyDian AI TTS)
      if (elements.neonMicBtn) {
        elements.neonMicBtn.addEventListener('click', () => {
          state.selectedAiType = 'voice';
          toggleNeonIcon(elements.neonMicBtn);
        });
      }

      // üíª Code Mode Icon
      if (elements.neonCodeBtn) {
        elements.neonCodeBtn.addEventListener('click', () => {
          state.selectedAiType = 'code';
          state.selectedModel = 'code-model';
          toggleNeonIcon(elements.neonCodeBtn);
          // No toast message on click
        });
      }

      // ü§ñ MODEL SELECTOR BUTTONS (Advanced, Premium, Ultra, RAG)
      document.querySelectorAll('[data-model]').forEach(btn => {
        btn.addEventListener('click', () => {
          // Remove active from all model buttons
          document.querySelectorAll('[data-model]').forEach(b => b.classList.remove('active'));
          // Add active to clicked button
          btn.classList.add('active');
          // Update state
          state.selectedModel = btn.getAttribute('data-model');
          showToast(`AI Asistanƒ± Hazƒ±r`);
        });
      });

      // üîó Share Button with Modal
      if (elements.shareBtn) {
        elements.shareBtn.addEventListener('click', () => {
          shareConversation();
        });
      }

      // Plus button dropdown toggle
      if (elements.plusBtn && elements.plusDropdown) {
        elements.plusBtn.addEventListener('click', e => {
          e.stopPropagation();
          elements.plusDropdown.classList.toggle('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', e => {
          if (!elements.plusBtn.contains(e.target) && !elements.plusDropdown.contains(e.target)) {
            elements.plusDropdown.classList.remove('show');
          }
        });

        // Plus dropdown items
        const plusDropdownItems = document.querySelectorAll('.plus-dropdown-item');
        plusDropdownItems.forEach(item => {
          item.addEventListener('click', () => {
            const aiType = item.getAttribute('data-ai-type');
            state.selectedAiType = aiType;
            elements.plusDropdown.classList.remove('show');
            showToast(`AI Mode: ${aiType}`);
          });
        });
      }

      // Suggestion chips
      document.querySelectorAll('.suggestion-chip').forEach(chip => {
        chip.addEventListener('click', () => {
          elements.messageInput.value = chip.dataset.prompt;
          elements.messageInput.dispatchEvent(new Event('input'));
          elements.messageInput.focus();
        });
      });

      // ========== AI RECALL CLIENT ==========

      // Initialize AI Recall Client for general chat
      let recallClient = null;
      try {
        if (typeof RecallClient === 'undefined') {
          throw new Error('RecallClient class not loaded');
        }
        recallClient = new RecallClient({
          domain: 'general',
          mode: 'hybrid',
          onModeChange: status => {
            updateChatConnectionStatus(status);
          },
          onStatusChange: status => {
            console.log('[AI_CHAT] Status:', status);
          },
        });
        console.log('[AI_CHAT] RecallClient initialized successfully');
      } catch (initError) {
        console.error('[AI_CHAT] Failed to initialize RecallClient:', initError);
      }

      function updateChatConnectionStatus(status) {
        const indicator = document.querySelector('.recall-status-indicator');
        if (indicator) {
          indicator.setAttribute('data-status', status.effectiveMode || status.mode);
          const textEl = indicator.querySelector('.recall-status-text');
          if (textEl) {
            const labels = {
              online: 'üü¢ √áevrimi√ßi',
              offline: 'üî¥ √áevrimdƒ±≈üƒ±',
              hybrid: 'üü° Hibrit',
            };
            textEl.textContent = labels[status.effectiveMode || status.mode] || status.mode;
          }
        }
      }

      // ========== FUNCTIONS ==========

      async function sendMessage() {
        // Null check for messageInput
        if (!elements.messageInput) {
          console.error('[CHAT] Cannot send message - input element not found');
          return;
        }

        const message = elements.messageInput.value.trim();
        const hasPendingFile = state.pendingFile && state.pendingFile.name;

        // Must have either message or file
        if ((!message && !hasPendingFile) || state.isTyping) return;

        // Set typing state to prevent duplicate sends
        state.isTyping = true;

        // Capture pending file before clearing
        const currentFile = hasPendingFile ? { ...state.pendingFile } : null;

        // Add user message with file attachment if present
        if (currentFile) {
          addMessageWithFile('user', message || `üìé ${currentFile.name}`, currentFile);
        } else {
          addMessage('user', message);
        }

        // Trigger fire sparks animation
        triggerFireSparks();

        // Clear input and file
        elements.messageInput.value = '';
        elements.messageInput.style.height = 'auto';
        if (elements.sendBtn) elements.sendBtn.disabled = true;
        clearFilePreview();

        // Mobile: Close keyboard
        if (window.innerWidth <= 768) {
          elements.messageInput.blur();
        }

        // Reset stats
        if (elements.charCount) elements.charCount.textContent = '0';
        if (elements.tokenCount) elements.tokenCount.textContent = '0';
        if (elements.tokenCountHeader) elements.tokenCountHeader.textContent = '0';
        if (elements.desktopCharCount) elements.desktopCharCount.textContent = '0';
        if (elements.desktopTokenCount) elements.desktopTokenCount.textContent = '0';
        if (elements.mobileCharCount) elements.mobileCharCount.textContent = '0';
        if (elements.mobileTokenCount) elements.mobileTokenCount.textContent = '0';

        // Hide empty state
        if (elements.emptyState) {
          elements.emptyState.style.display = 'none';
        }

        // Show typing indicator
        showTypingIndicator();

        // Track start time for speed calculation
        const startTime = Date.now();

        try {
          let result;

          // If there's a file, analyze it
          if (currentFile) {
            result = await analyzeFileWithAI(currentFile, message);
          } else {
            // Check for URL analysis request
            const urlCheck = isUrlAnalysisRequest(message);

            if (urlCheck.isUrlRequest && urlCheck.urls.length > 0) {
              // URL detected - analyze it
              console.log('[CHAT] URL analysis request detected:', urlCheck.urls[0]);
              result = await analyzeUrlWithAI(urlCheck.urls[0], urlCheck.question);
            } else {
              // Check if RecallClient is available
              if (!recallClient) {
                throw new Error('AI client not initialized');
              }

              // Use RecallClient for AI responses
              result = await recallClient.chat(message, {
                domain: state.selectedAiType || 'general',
                language: 'tr-TR',
                preferOffline: false,
              });
            }
          }

          hideTypingIndicator();

          if (result.success || result.response || result.analysis) {
            const responseText = result.response || result.analysis;
            // Pass confidence if available from API
            addMessage('assistant', responseText, result.confidence || null);

            // Save chat after getting response
            saveCurrentChat();

            // Calculate response time
            const totalTime = Date.now() - startTime;
            const tokensPerSecond = (
              (responseText?.length || 100) /
              4 /
              (totalTime / 1000)
            ).toFixed(1);

            // Display speed
            if (elements.speedDisplay) {
              elements.speedDisplay.style.display = 'inline';
              elements.speedValue.textContent = tokensPerSecond;
            }
          } else {
            addMessage(
              'assistant',
              `‚ö†Ô∏è **Yanƒ±t Alƒ±namadƒ±**\n\n${result.error || 'L√ºtfen tekrar deneyin.'}`
            );
          }
          // Reset typing state on success
          state.isTyping = false;
        } catch (error) {
          console.error('[CHAT] Error:', error);
          hideTypingIndicator();
          addMessage(
            'assistant',
            `‚ö†Ô∏è **Baƒülantƒ± Hatasƒ±**\n\nAI sistemi ile ileti≈üim kurulamadƒ±. L√ºtfen tekrar deneyin.`
          );
          // Reset typing state on error
          state.isTyping = false;
        }
      }

      // Analyze file with AI (ChatGPT-style)
      async function analyzeFileWithAI(file, userQuestion) {
        try {
          // For non-images, we need to read the file as base64
          let base64Data = file.data;

          // If data is a data URL, extract the base64 part
          if (base64Data && base64Data.startsWith('data:')) {
            base64Data = base64Data.split(',')[1];
          }

          // If no base64 data (for documents), read from the file input
          if (!base64Data) {
            const fileInput = document.getElementById('mainFileInput');
            if (fileInput && fileInput.files && fileInput.files[0]) {
              base64Data = await readFileAsBase64(fileInput.files[0]);
            }
          }

          if (!base64Data) {
            throw new Error('Dosya verisi okunamadƒ±');
          }

          const response = await fetch('/api/files/analyze', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              file: base64Data,
              mimeType: file.type,
              fileName: file.name,
              question: userQuestion || '',
            }),
          });

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || 'Dosya analizi ba≈üarƒ±sƒ±z');
          }

          return await response.json();
        } catch (error) {
          console.error('[FILE_ANALYZE_ERR]', error);
          return { success: false, error: error.message };
        }
      }

      // Read file as base64
      function readFileAsBase64(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = () => {
            const result = reader.result;
            // Extract base64 from data URL
            const base64 = result.split(',')[1];
            resolve(base64);
          };
          reader.onerror = reject;
          reader.readAsDataURL(file);
        });
      }

      // ============================================================
      // URL DETECTION AND ANALYSIS (Claude-style URL Analysis)
      // ============================================================

      /**
       * Detect URLs in a message
       */
      function detectUrls(text) {
        const urlRegex = /(https?:\/\/[^\s<>"{}|\\^`[\]]+)/gi;
        const matches = text.match(urlRegex);
        return matches || [];
      }

      /**
       * Check if message is primarily a URL analysis request
       */
      function isUrlAnalysisRequest(text) {
        const urls = detectUrls(text);
        if (urls.length === 0) return { isUrlRequest: false };

        // Keywords that indicate URL analysis intent (Turkish + English)
        const analysisKeywords = [
          'analiz',
          'incele',
          '√∂zetle',
          'a√ßƒ±kla',
          'ne anlatƒ±yor',
          'ne diyor',
          'i√ßeriƒüi',
          'hakkƒ±nda',
          'oku',
          'bak',
          'kontrol',
          'analyze',
          'summarize',
          'explain',
          'what',
          'check',
          'read',
          'content',
        ];

        const lowerText = text.toLowerCase();
        const hasAnalysisKeyword = analysisKeywords.some(kw => lowerText.includes(kw));

        // If message contains URL and analysis keyword, or is mostly just a URL
        const textWithoutUrl = text.replace(/(https?:\/\/[^\s]+)/gi, '').trim();
        const isJustUrl = textWithoutUrl.length < 20;

        return {
          isUrlRequest: urls.length > 0 && (hasAnalysisKeyword || isJustUrl),
          urls: urls,
          question: textWithoutUrl || null,
        };
      }

      /**
       * Analyze URL content with AI
       */
      async function analyzeUrlWithAI(url, question) {
        try {
          const response = await fetch('/api/analyze-url', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              url: url,
              question: question || '',
            }),
          });

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || 'URL analizi ba≈üarƒ±sƒ±z');
          }

          const result = await response.json();

          if (result.success) {
            // Format response with URL info
            const formattedResponse = `üîó **URL Analizi**\nüìå **Ba≈ülƒ±k:** ${result.title}\nüåê **Kaynak:** ${result.url}\n\n---\n\n${result.analysis}`;
            return {
              success: true,
              response: formattedResponse,
              url: result.url,
              title: result.title,
            };
          } else {
            return { success: false, error: result.error };
          }
        } catch (error) {
          console.error('[URL_ANALYZE_ERR]', error);
          return { success: false, error: error.message };
        }
      }

      // Add message with file attachment (ChatGPT style)
      function addMessageWithFile(role, content, file) {
        const message = { role, content, timestamp: Date.now(), file };
        state.messages.push(message);

        if (elements.emptyState && elements.emptyState.style.display !== 'none') {
          elements.emptyState.style.display = 'none';
        }

        const messageEl = document.createElement('div');
        messageEl.className = `message ${role}`;

        const avatarSvg =
          '<svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>';

        const timeStr = new Date(message.timestamp).toLocaleTimeString('tr-TR', {
          hour: '2-digit',
          minute: '2-digit',
        });
        const dateStr = new Date(message.timestamp).toLocaleDateString('tr-TR', {
          day: '2-digit',
          month: '2-digit',
          year: 'numeric',
        });

        // Build file preview HTML
        let filePreviewHtml = '';
        const isImage = file.type && file.type.startsWith('image/');

        if (isImage && file.data) {
          filePreviewHtml = `
            <div class="message-file-preview">
              <img src="${file.data}" alt="${file.name}" class="message-image-preview" onclick="openImageModal(this.src)" />
            </div>
          `;
        } else {
          const fileIcon = getFileIcon(file.type);
          filePreviewHtml = `
            <div class="message-file-preview message-file-doc">
              ${fileIcon}
              <span class="file-name">${file.name}</span>
              <span class="file-size">${formatFileSize(file.size)}</span>
            </div>
          `;
        }

        messageEl.innerHTML = `
          <div class="message-avatar">${avatarSvg}</div>
          <div class="message-content">
            ${filePreviewHtml}
            ${content ? `<div class="message-text">${formatMessage(content)}</div>` : ''}
            <div class="message-timestamp">${timeStr} ‚Ä¢ ${dateStr}</div>
          </div>
        `;

        elements.messagesContainer.appendChild(messageEl);
        messageEl.scrollIntoView({ behavior: 'smooth', block: 'end' });
      }

      // Get file icon based on type
      function getFileIcon(mimeType) {
        if (mimeType?.includes('pdf')) {
          return '<svg viewBox="0 0 24 24" width="32" height="32" fill="#e53935"><path d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5V11H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"/></svg>';
        } else if (mimeType?.includes('word') || mimeType?.includes('document')) {
          return '<svg viewBox="0 0 24 24" width="32" height="32" fill="#1976d2"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/><path d="M8 12h8v2H8zm0 3h8v2H8z"/></svg>';
        } else {
          return '<svg viewBox="0 0 24 24" width="32" height="32" fill="#10a37f"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/></svg>';
        }
      }

      // Format file size
      function formatFileSize(bytes) {
        if (!bytes) return '';
        if (bytes < 1024) return bytes + ' B';
        if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
        return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
      }

      // Open image in modal
      function openImageModal(src) {
        const modal = document.createElement('div');
        modal.className = 'image-modal-overlay';
        modal.innerHTML = `
          <div class="image-modal-content">
            <img src="${src}" alt="Preview" />
            <button class="image-modal-close" onclick="this.parentElement.parentElement.remove()">
              <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 6L6 18M6 6l12 12"/>
              </svg>
            </button>
          </div>
        `;
        modal.onclick = e => {
          if (e.target === modal) modal.remove();
        };
        document.body.appendChild(modal);
      }

      function addMessage(role, content, confidence = null) {
        const message = { role, content, timestamp: Date.now(), confidence };
        state.messages.push(message);

        // ƒ∞lk mesaj g√∂nderildiƒüinde empty state'i gizle
        if (elements.emptyState && elements.emptyState.style.display !== 'none') {
          elements.emptyState.style.display = 'none';
        }

        const messageEl = document.createElement('div');
        messageEl.className = `message ${role}`;

        const avatarSvg =
          role === 'user'
            ? '<svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>'
            : '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><circle cx="12" cy="12" r="8" opacity="0.5"/><circle cx="12" cy="4" r="1.5"/><circle cx="12" cy="20" r="1.5"/><circle cx="4" cy="12" r="1.5"/><circle cx="20" cy="12" r="1.5"/></svg>';

        const timeStr = new Date(message.timestamp).toLocaleTimeString('tr-TR', {
          hour: '2-digit',
          minute: '2-digit',
        });
        const dateStr = new Date(message.timestamp).toLocaleDateString('tr-TR', {
          day: '2-digit',
          month: '2-digit',
          year: 'numeric',
        });

        // Build confidence badge HTML if available
        let confidenceBadgeHtml = '';
        if (role === 'assistant' && confidence) {
          const levelClass =
            confidence.level === 'high' ? 'high' : confidence.level === 'medium' ? 'medium' : 'low';
          const researchTip = confidence.suggestResearch
            ? '<span class="research-tip">Ara≈ütƒ±rma √∂nerilir</span>'
            : '';
          confidenceBadgeHtml = `
            <div class="response-confidence">
              <span class="confidence-badge confidence-${levelClass}">
                <svg viewBox="0 0 24 24" width="14" height="14">
                  <path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
                %${confidence.percentage} Doƒüruluk
              </span>
              ${researchTip}
            </div>
          `;
        }

        // Generate suggestion chips HTML for assistant messages
        let suggestionsHtml = '';
        if (role === 'assistant') {
          const suggestions = generateSuggestions(content, state.messages);
          if (suggestions.length > 0) {
            suggestionsHtml = `
              <div class="suggestion-chips-container">
                ${suggestions
                  .map(
                    s => `
                  <button class="suggestion-chip" data-suggestion="${escapeHtml(s.text)}">
                    <span>${escapeHtml(s.text)}</span>
                  </button>
                `
                  )
                  .join('')}
              </div>
            `;
          }
        }

        messageEl.innerHTML = `
                <div class="message-avatar">${avatarSvg}</div>
                <div class="message-content">
                    <div class="message-text">${formatMessage(content)}</div>
                    ${confidenceBadgeHtml}
                    <div class="message-timestamp">${timeStr} ‚Ä¢ ${dateStr}</div>
                    ${
                      role === 'assistant'
                        ? `
                        <div class="message-actions">
                            <button class="message-action-btn copy-btn-small" onclick="copyMessage(this)" title="Kopyala">
                                <svg viewBox="0 0 24 24" width="14" height="14"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                            </button>
                            <button class="message-action-btn" onclick="regenerateMessage(this)" title="Yeniden Olu≈ütur">
                                <svg viewBox="0 0 24 24" width="14" height="14"><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/></svg>
                            </button>
                        </div>
                        ${suggestionsHtml}
                    `
                        : `
                        <div class="message-actions user-actions">
                            <button class="message-action-btn copy-btn-small" onclick="copyMessage(this)" title="Kopyala">
                                <svg viewBox="0 0 24 24" width="14" height="14"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
                            </button>
                        </div>
                    `
                    }
                </div>
            `;

        elements.messagesContainer.appendChild(messageEl);
        messageEl.scrollIntoView({ behavior: 'smooth', block: 'end' });

        // Add click handlers for suggestion chips
        if (role === 'assistant') {
          const chips = messageEl.querySelectorAll('.suggestion-chip');
          chips.forEach(chip => {
            chip.addEventListener('click', () => {
              const suggestionText = chip.dataset.suggestion;
              if (suggestionText && elements.messageInput) {
                elements.messageInput.value = suggestionText;
                elements.messageInput.focus();
                elements.messageInput.dispatchEvent(new Event('input'));
                // Optionally auto-send
                // sendMessage();
              }
            });
          });
        }
      }

      function showTypingIndicator() {
        state.isTyping = true;
        const indicator = document.createElement('div');
        indicator.className = 'message assistant';
        indicator.id = 'typingIndicator';
        indicator.innerHTML = `
                <div class="message-avatar">
                    <svg viewBox="0 0 24 24"><path d="M20,18c1.1,0,2-0.9,2-2V6c0-1.1-0.9-2-2-2H4C2.9,4,2,4.9,2,6v10c0,1.1,0.9,2,2,2H0v2h24v-2H20z M4,6h16v10H4V6z"/></svg>
                </div>
                <div class="message-content">
                    <div class="typing-indicator">
                        <span class="typing-text">
                            D√º≈ü√ºn√ºyor<span class="typing-dots"><span></span><span></span><span></span></span>
                        </span>
                    </div>
                </div>
            `;
        elements.messagesContainer.appendChild(indicator);
        indicator.scrollIntoView({ behavior: 'smooth' });
      }

      function hideTypingIndicator() {
        state.isTyping = false;
        const indicator = document.getElementById('typingIndicator');
        if (indicator) {
          indicator.remove();
        }
      }

      function triggerFireSparks() {
        const container = document.getElementById('fireSparks');
        if (!container) return;

        // Create 25 sparks
        const sparkCount = 25;
        const colors = ['#10A37F', '#FF6B4A', '#FFFFFF']; // Teal, orange, white for dark theme

        for (let i = 0; i < sparkCount; i++) {
          const spark = document.createElement('div');
          spark.className = 'spark';

          // Random properties
          const startX = Math.random() * 100; // Random horizontal position (0-100%)
          const drift = (Math.random() - 0.5) * 100; // Random drift (-50px to +50px)
          const duration = 1.5 + Math.random() * 1; // Duration between 1.5s - 2.5s
          const delay = Math.random() * 0.3; // Stagger start times
          const size = 4 + Math.random() * 2; // Size between 4px - 6px
          const color = colors[Math.floor(Math.random() * colors.length)];

          // Apply styles
          spark.style.left = `${startX}%`;
          spark.style.width = `${size}px`;
          spark.style.height = `${size}px`;
          spark.style.background = color;
          spark.style.boxShadow = `0 0 4px ${color}`;
          spark.style.animationDuration = `${duration}s`;
          spark.style.animationDelay = `${delay}s`;
          spark.style.setProperty('--drift', `${drift}px`);

          container.appendChild(spark);

          // Remove spark after animation completes
          setTimeout(
            () => {
              spark.remove();
            },
            (duration + delay) * 1000
          );
        }
      }

      function formatMessage(text) {
        return text
          .split('\n')
          .map(line => `<p>${escapeHtml(line)}</p>`)
          .join('')
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
          .replace(/\*(.*?)\*/g, '<em>$1</em>')
          .replace(/`(.*?)`/g, '<code>$1</code>')
          .replace(/!\[(.*?)\]\((https?:\/\/[^\)]+)\)/g, function (match, alt, url) {
            return `<div style="position: relative; display: inline-block; margin: 10px 0;">
                        <img src="${url}" alt="${alt}" style="max-width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                        <a href="${url}" download target="_blank" style="position: absolute; bottom: 12px; right: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 8px 16px; border-radius: 8px; text-decoration: none; font-size: 13px; font-weight: 500; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4); transition: all 0.3s ease; display: flex; align-items: center; gap: 6px;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
                            </svg>
                            ƒ∞ndir
                        </a>
                    </div>`;
          }) // Markdown images with download button
          .replace(
            /\[([^\]]+)\]\((https?:\/\/[^\)]+)\)/g,
            '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>'
          ); // Markdown links
      }

      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      /**
       * Generate contextual suggestions based on conversation
       * ChatGPT-style follow-up suggestions
       */
      function generateSuggestions(aiResponse, messages) {
        const suggestions = [];
        const lastUserMessage =
          messages
            .filter(m => m.role === 'user')
            .pop()
            ?.content?.toLowerCase() || '';
        const responseLower = aiResponse.toLowerCase();

        // Konu bazlƒ± √∂neriler - ƒ∞KONLARLA
        const topicSuggestions = {
          // Programlama ve Teknoloji
          kod: [
            { text: 'Bu kodu optimize edebilir misin?', icon: '‚ö°' },
            { text: 'Hata ayƒ±klama i√ßin √∂nerilerin var mƒ±?', icon: 'üîß' },
            { text: 'Alternatif bir yakla≈üƒ±m g√∂sterir misin?', icon: 'üîÑ' },
          ],
          python: [
            { text: 'Bu kodu daha Pythonic yapabilir misin?', icon: 'üêç' },
            { text: 'Unit test √∂rnekleri ekler misin?', icon: '‚úÖ' },
            { text: 'Performans iyile≈ütirmeleri √∂ner', icon: 'üöÄ' },
          ],
          javascript: [
            { text: 'Modern ES6+ syntax ile yaz', icon: '‚ú®' },
            { text: 'TypeScript versiyonunu g√∂ster', icon: 'üìò' },
            { text: 'Error handling ekle', icon: 'üõ°Ô∏è' },
          ],

          // Genel Bilgi
          tarih: [
            { text: 'Bu d√∂nemin √∂nemli olaylarƒ± neler?', icon: 'üìú' },
            { text: 'Daha detaylƒ± anlatƒ±r mƒ±sƒ±n?', icon: 'üîç' },
            { text: 'G√ºn√ºm√ºze etkileri neler?', icon: 'üåç' },
          ],

          // Saƒülƒ±k
          saƒülƒ±k: [
            { text: 'Belirtiler ne anlama geliyor?', icon: 'ü©∫' },
            { text: 'Hangi uzmanƒ± g√∂rmeliyim?', icon: 'üë®‚Äç‚öïÔ∏è' },
            { text: '√ñnleme y√∂ntemleri neler?', icon: 'üí™' },
          ],

          // Finans
          finans: [
            { text: 'Yatƒ±rƒ±m stratejileri √∂ner', icon: 'üìà' },
            { text: 'Risk analizi yapabilir misin?', icon: '‚öñÔ∏è' },
            { text: 'Alternatif se√ßenekler neler?', icon: 'üí°' },
          ],

          // Eƒüitim
          √∂ƒüren: [
            { text: 'Pratik √∂rnekler verebilir misin?', icon: 'üìù' },
            { text: 'Kaynak √∂nerilerin var mƒ±?', icon: 'üìö' },
            { text: 'Adƒ±m adƒ±m anlat', icon: 'üéØ' },
          ],

          // Yemek ve Tarif
          tarif: [
            { text: 'Malzeme listesi verir misin?', icon: 'ü•ó' },
            { text: 'Pi≈üirme s√ºresi ne kadar?', icon: '‚è±Ô∏è' },
            { text: 'Vegan alternatifi var mƒ±?', icon: 'üå±' },
          ],

          // Seyahat
          seyahat: [
            { text: 'En iyi zaman ne zaman?', icon: 'üìÖ' },
            { text: 'B√ºt√ße √∂nerisi verir misin?', icon: 'üí∞' },
            { text: 'G√∂r√ºlmesi gereken yerler neler?', icon: 'üìç' },
          ],
        };

        // Genel √∂neriler (fallback) - ƒ∞KONLARLA
        const generalSuggestions = [
          { text: 'Daha detaylƒ± a√ßƒ±klar mƒ±sƒ±n?', icon: 'üîç' },
          { text: 'Ba≈üka √∂rnekler verebilir misin?', icon: 'üí°' },
          { text: 'Bu konuda nelere dikkat etmeliyim?', icon: '‚ö†Ô∏è' },
          { text: '√ñzet ge√ßebilir misin?', icon: 'üìã' },
        ];

        // Yanƒ±t i√ßeriƒüine g√∂re √∂neriler
        if (
          responseLower.includes('kod') ||
          responseLower.includes('function') ||
          responseLower.includes('class')
        ) {
          suggestions.push(...(topicSuggestions.kod || []));
        }
        if (responseLower.includes('python') || lastUserMessage.includes('python')) {
          suggestions.push(...(topicSuggestions.python || []));
        }
        if (
          responseLower.includes('javascript') ||
          responseLower.includes('js') ||
          lastUserMessage.includes('javascript')
        ) {
          suggestions.push(...(topicSuggestions.javascript || []));
        }
        if (
          responseLower.includes('tarih') ||
          responseLower.includes('y√ºzyƒ±l') ||
          responseLower.includes('d√∂nem')
        ) {
          suggestions.push(...(topicSuggestions.tarih || []));
        }
        if (
          responseLower.includes('saƒülƒ±k') ||
          responseLower.includes('hastalƒ±k') ||
          responseLower.includes('tedavi')
        ) {
          suggestions.push(...(topicSuggestions.saƒülƒ±k || []));
        }
        if (
          responseLower.includes('yatƒ±rƒ±m') ||
          responseLower.includes('finans') ||
          responseLower.includes('para')
        ) {
          suggestions.push(...(topicSuggestions.finans || []));
        }
        if (
          responseLower.includes('tarif') ||
          responseLower.includes('yemek') ||
          responseLower.includes('pi≈üir')
        ) {
          suggestions.push(...(topicSuggestions.tarif || []));
        }
        if (
          responseLower.includes('seyahat') ||
          responseLower.includes('gezi') ||
          responseLower.includes('tur')
        ) {
          suggestions.push(...(topicSuggestions.seyahat || []));
        }

        // Eƒüer konu bazlƒ± √∂neri bulunamadƒ±ysa genel √∂neriler
        if (suggestions.length === 0) {
          suggestions.push(...generalSuggestions);
        }

        // Benzersiz ve max 3 √∂neri d√∂nd√ºr
        const uniqueSuggestions = [...new Map(suggestions.map(s => [s.text, s])).values()];
        return uniqueSuggestions.slice(0, 3);
      }

      function startNewChat() {
        state.messages = [];
        state.currentChatId = null;
        elements.messagesContainer.innerHTML = `
                <div class="empty-state" id="emptyState">
                    <div class="particles" id="particles"></div>
                    <div class="user-welcome-text" id="userWelcomeText">
                        <div class="welcome-user-name" id="welcomeUserName">Ho≈ügeldiniz</div>
                        <div class="welcome-message">Size Nasƒ±l Yardƒ±mcƒ± Olabilirim?</div>
                    </div>
                    <div class="mini-spinner-container">
                        <div class="mini-spinner">
                            <svg viewBox="-60 -60 120 120" width="120" height="120" role="img" aria-label="LyDian orbit">
                                <defs>
                                    <radialGradient id="g-core-2" cx="50%" cy="50%" r="50%">
                                        <stop offset="0%" stop-color="#7C5CFF" stop-opacity="1" />
                                        <stop offset="60%" stop-color="#00E0FF" stop-opacity="0.4" />
                                        <stop offset="100%" stop-color="#0B0F19" stop-opacity="0" />
                                    </radialGradient>
                                    <linearGradient id="g-1-2" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" stop-color="#7C5CFF" />
                                        <stop offset="100%" stop-color="#00E0FF" />
                                    </linearGradient>
                                    <linearGradient id="g-2-2" x1="0%" y1="100%" x2="100%" y2="0%">
                                        <stop offset="0%" stop-color="#00E0FF" />
                                        <stop offset="100%" stop-color="#FF9D00" />
                                    </linearGradient>
                                    <linearGradient id="g-3-2" x1="100%" y1="0%" x2="0%" y2="100%">
                                        <stop offset="0%" stop-color="#FF9D00" />
                                        <stop offset="100%" stop-color="#7C5CFF" />
                                    </linearGradient>
                                </defs>
                                <circle r="48" fill="url(#g-core-2)" opacity="0.2" />
                                <g class="lydian-orbit-ring-1">
                                    <ellipse rx="50" ry="30" fill="none" stroke="url(#g-1-2)" stroke-opacity="0.7" stroke-width="0.8" />
                                    <circle cx="50" cy="0" r="2" fill="#00E0FF" />
                                    <circle cx="-50" cy="0" r="2" fill="#00E0FF" />
                                </g>
                                <g class="lydian-orbit-ring-2">
                                    <circle r="38" fill="none" stroke="url(#g-2-2)" stroke-opacity="0.8" stroke-width="0.8" />
                                    <circle cx="38" cy="0" r="1.5" fill="#FF9D00" />
                                    <circle cx="-38" cy="0" r="1.5" fill="#FF9D00" />
                                    <circle cx="0" cy="38" r="1.5" fill="#FF9D00" />
                                    <circle cx="0" cy="-38" r="1.5" fill="#FF9D00" />
                                </g>
                                <g class="lydian-orbit-ring-3">
                                    <circle r="25" fill="none" stroke="url(#g-3-2)" stroke-opacity="0.9" stroke-width="1" stroke-dasharray="1.5 5" />
                                </g>
                                <g class="lydian-lissajous">
                                    <circle r="2.5" fill="#7C5CFF" />
                                </g>
                                <circle r="12" fill="#111827" />
                                <circle r="12" fill="url(#g-core-2)" opacity="0.35" />
                                <circle r="0.8" fill="#7C5CFF" />
                            </svg>
                        </div>
                    </div>
                    <div class="suggestion-chips">
                        <div class="suggestion-chip" data-prompt="Kuantum bili≈üimi detaylƒ± a√ßƒ±kla">üî¨ Kuantum Bili≈üim</div>
                        <div class="suggestion-chip" data-prompt="Python'da makine √∂ƒürenimi √∂rneƒüi yaz">ü§ñ Python ML Kodu</div>
                        <div class="suggestion-chip" data-prompt="2024 yapay zeka trendleri neler?">‚ú® AI Trendleri</div>
                        <div class="suggestion-chip" data-prompt="Verimli √ßalƒ±≈üma teknikleri √∂ner">‚ö° Verimlilik ƒ∞pu√ßlarƒ±</div>
                    </div>
                </div>
            `;
        elements.emptyState = document.getElementById('emptyState');
        initParticles();

        document.querySelectorAll('.suggestion-chip').forEach(chip => {
          chip.addEventListener('click', () => {
            elements.messageInput.value = chip.dataset.prompt;
            elements.messageInput.dispatchEvent(new Event('input'));
            elements.messageInput.focus();
          });
        });
      }

      // üì• Download conversation in multiple formats
      function downloadConversation(format) {
        if (state.messages.length === 0) {
          showToast('‚ùå ƒ∞ndirilecek mesaj yok!');
          return;
        }

        let content = '';
        let mimeType = '';
        let filename = `chat-${Date.now()}`;

        switch (format) {
          case 'json':
            content = JSON.stringify(state.messages, null, 2);
            mimeType = 'application/json';
            filename += '.json';
            break;
          case 'txt':
            content = state.messages
              .map(m => `[${m.role.toUpperCase()}]: ${m.content}`)
              .join('\n\n');
            mimeType = 'text/plain';
            filename += '.txt';
            break;
          case 'md':
            content = '# LYDIAN Chat Export\n\n';
            content += state.messages
              .map(m => {
                const prefix = m.role === 'user' ? '### üë§ User' : '### ü§ñ Assistant';
                return `${prefix}\n\n${m.content}\n\n---\n`;
              })
              .join('\n');
            mimeType = 'text/markdown';
            filename += '.md';
            break;
          case 'csv':
            content = 'Role,Content,Timestamp\n';
            content += state.messages
              .map(m => {
                const escapedContent = (m.content || '').replace(/"/g, '""');
                return `"${m.role}","${escapedContent}","${new Date().toISOString()}"`;
              })
              .join('\n');
            mimeType = 'text/csv';
            filename += '.csv';
            break;
        }

        const blob = new Blob([content], { type: mimeType });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        showToast(`‚úÖ Sohbet ${format.toUpperCase()} olarak indirildi!`);
      }

      // üîó Share conversation - Secure encrypted share
      async function shareConversation() {
        if (state.messages.length === 0) {
          showToast('Payla≈üƒ±lacak mesaj yok', 'warning');
          return;
        }

        try {
          // Show loading
          showToast('Payla≈üƒ±m linki olu≈üturuluyor...', 'info');

          // Get title from first user message
          const title = getTitle();

          // Call secure share API
          const response = await fetch('/api/share/create', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              messages: state.messages,
              title,
              expiresIn: '24h',
              whatsAppOnly: true,
            }),
          });

          const result = await response.json();

          if (result.success) {
            showShareModal(result.shareUrl, result.expiresAt);
          } else {
            showToast(result.error || 'Payla≈üƒ±m ba≈üarƒ±sƒ±z', 'error');
          }
        } catch (error) {
          console.error('[SHARE_ERR]', error);
          showToast('Payla≈üƒ±m ba≈üarƒ±sƒ±z. L√ºtfen tekrar deneyin.', 'error');
        }
      }

      // üì§ Show share modal
      function showShareModal(shareUrl, expiresAt) {
        // Remove existing modal if any
        const existingModal = document.getElementById('shareModalOverlay');
        if (existingModal) existingModal.remove();

        const expiresDate = new Date(expiresAt).toLocaleString('tr-TR');
        const whatsappUrl = `https://wa.me/?text=${encodeURIComponent('LyDian AI Sohbet: ' + shareUrl)}`;

        const modal = document.createElement('div');
        modal.id = 'shareModalOverlay';
        modal.className = 'share-modal-overlay';
        modal.innerHTML = `
          <div class="share-modal">
            <div class="share-modal-header">
              <h3>Sohbeti Payla≈ü</h3>
              <button class="share-modal-close" onclick="this.closest('.share-modal-overlay').remove()">
                <svg viewBox="0 0 24 24" width="20" height="20">
                  <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                </svg>
              </button>
            </div>
            <div class="share-modal-content">
              <div class="share-warning">
                <svg viewBox="0 0 24 24" width="20" height="20">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="2"/>
                  <path d="M7 11V7a5 5 0 0110 0v4" fill="none" stroke="currentColor" stroke-width="2"/>
                </svg>
                <span>Bu link sadece WhatsApp √ºzerinden a√ßƒ±labilir ve 24 saat ge√ßerlidir.</span>
              </div>
              <div class="share-url-box">
                <input type="text" value="${shareUrl}" readonly id="shareUrlInput" />
                <button class="copy-btn" onclick="copyShareUrl()">
                  <svg viewBox="0 0 24 24" width="18" height="18">
                    <path fill="currentColor" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                  </svg>
                  Kopyala
                </button>
              </div>
              <a href="${whatsappUrl}" class="whatsapp-share-btn" target="_blank" rel="noopener">
                <svg viewBox="0 0 24 24" width="24" height="24">
                  <path fill="currentColor" d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                </svg>
                WhatsApp ile Payla≈ü
              </a>
              <div class="share-expiry">
                <svg viewBox="0 0 24 24" width="16" height="16">
                  <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                  <path d="M12 6v6l4 2" fill="none" stroke="currentColor" stroke-width="2"/>
                </svg>
                Link s√ºresi: ${expiresDate}
              </div>
            </div>
          </div>
        `;
        document.body.appendChild(modal);

        // Close on overlay click
        modal.addEventListener('click', e => {
          if (e.target === modal) modal.remove();
        });
      }

      // Copy share URL to clipboard
      function copyShareUrl() {
        const input = document.getElementById('shareUrlInput');
        if (input) {
          navigator.clipboard
            .writeText(input.value)
            .then(() => showToast('Link kopyalandƒ±!', 'success'))
            .catch(() => showToast('Kopyalama ba≈üarƒ±sƒ±z', 'error'));
        }
      }

      function copyToClipboard(text) {
        if (navigator.clipboard) {
          navigator.clipboard
            .writeText(text)
            .then(() => {
              showToast('‚úÖ Sohbet panoya kopyalandƒ±!');
            })
            .catch(() => {
              showToast('‚ùå Panoya kopyalanamadƒ±!');
            });
        } else {
          // Fallback for older browsers
          const textarea = document.createElement('textarea');
          textarea.value = text;
          document.body.appendChild(textarea);
          textarea.select();
          document.execCommand('copy');
          document.body.removeChild(textarea);
          showToast('‚úÖ Sohbet panoya kopyalandƒ±!');
        }
      }

      function getTitle() {
        const firstMessage = state.messages.find(m => m.role === 'user');
        if (firstMessage) {
          return (
            firstMessage.content.substring(0, 40) + (firstMessage.content.length > 40 ? '...' : '')
          );
        }
        return 'Yeni Sohbet';
      }

      function setTheme(themeName) {
        document.body.removeAttribute('data-theme');
        if (themeName !== 'dark') {
          document.body.setAttribute('data-theme', themeName);
        }
        // DEBUG: console.log('üé® Tema deƒüi≈ütirildi:', themeName);
      }

      function updateActiveThemeOption() {
        const currentTheme = localStorage.getItem('lydian_theme') || 'dark';
        document.querySelectorAll('.theme-option').forEach(option => {
          if (option.dataset.theme === currentTheme) {
            option.classList.add('active');
          } else {
            option.classList.remove('active');
          }
        });
      }

      // üìÅ Handle file upload
      function handleFileUpload(file) {
        // Max file size: 10MB
        const maxSize = 10 * 1024 * 1024;
        if (file.size > maxSize) {
          showToast("Dosya boyutu 10MB'dan buyuk olamaz");
          return;
        }

        // Check file type
        const isImage = file.type.startsWith('image/');
        const allowedTypes = [
          'image/',
          'application/pdf',
          'text/',
          'application/msword',
          'application/vnd.openxmlformats',
        ];
        const isAllowed = allowedTypes.some(
          type => file.type.startsWith(type) || file.type.includes(type)
        );

        if (!isAllowed) {
          showToast('Bu dosya turu desteklenmiyor');
          return;
        }

        // Show toast for feedback
        showToast(`Dosya yukleniyor: ${file.name}`);

        // For images, show preview in input area
        if (isImage) {
          const reader = new FileReader();
          reader.onload = function (e) {
            // Store the image data for sending with the message
            state.pendingFile = {
              name: file.name,
              type: file.type,
              size: file.size,
              data: e.target.result,
            };

            // Show preview badge
            showFilePreview(file.name, e.target.result, true);
          };
          reader.readAsDataURL(file);
        } else {
          // For documents, store reference
          state.pendingFile = {
            name: file.name,
            type: file.type,
            size: file.size,
          };

          // Show file badge
          showFilePreview(file.name, null, false);
        }
      }

      // Show file preview badge near input - ChatGPT style
      function showFilePreview(fileName, imageData, isImage) {
        // Remove existing preview
        const existing = document.getElementById('filePreviewBadge');
        if (existing) existing.remove();

        const badge = document.createElement('div');
        badge.id = 'filePreviewBadge';
        badge.style.cssText = `
          display: inline-flex;
          align-items: center;
          gap: 10px;
          padding: ${isImage ? '6px 10px 6px 6px' : '10px 14px'};
          background: rgba(32, 33, 36, 0.95);
          border: 1px solid rgba(255, 255, 255, 0.12);
          border-radius: ${isImage ? '12px' : '10px'};
          margin-bottom: 10px;
          max-width: 280px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
          animation: slideInUp 0.2s ease-out;
        `;

        const preview =
          isImage && imageData
            ? `<img src="${imageData}" style="width: 56px; height: 56px; object-fit: cover; border-radius: 8px; flex-shrink: 0;" />`
            : `<div style="width: 40px; height: 40px; background: rgba(16, 163, 127, 0.15); border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                 <svg viewBox="0 0 24 24" width="22" height="22" fill="none" stroke="#10a37f" stroke-width="2">
                   <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                   <polyline points="14 2 14 8 20 8"/>
                 </svg>
               </div>`;

        // Get file extension
        const ext = fileName.split('.').pop().toUpperCase();
        const fileTypeLabel = isImage ? 'G√∂rsel' : ext;

        badge.innerHTML = `
          ${preview}
          <div style="flex: 1; min-width: 0; display: flex; flex-direction: column; gap: 2px;">
            <span style="color: #fff; font-size: 0.85rem; font-weight: 500; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
              ${fileName}
            </span>
            <span style="color: rgba(255,255,255,0.5); font-size: 0.75rem;">${fileTypeLabel}</span>
          </div>
          <button onclick="clearFilePreview()" style="background: rgba(255,255,255,0.08); border: none; color: rgba(255,255,255,0.6); cursor: pointer; padding: 6px; border-radius: 6px; display: flex; align-items: center; justify-content: center; transition: all 0.2s; flex-shrink: 0;" onmouseover="this.style.background='rgba(239,68,68,0.2)'; this.style.color='#ef4444';" onmouseout="this.style.background='rgba(255,255,255,0.08)'; this.style.color='rgba(255,255,255,0.6)';">
            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
          </button>
        `;

        // Insert before input wrapper
        const inputWrapper = document.querySelector('.input-wrapper');
        if (inputWrapper && inputWrapper.parentNode) {
          inputWrapper.parentNode.insertBefore(badge, inputWrapper);
        }
      }

      // Clear file preview
      function clearFilePreview() {
        const badge = document.getElementById('filePreviewBadge');
        if (badge) badge.remove();
        state.pendingFile = null;
        // Clear file input
        const fileInput = document.getElementById('mainFileInput');
        if (fileInput) fileInput.value = '';
      }

      function showToast(message) {
        let toast = document.getElementById('toast');
        if (!toast) {
          toast = document.createElement('div');
          toast.id = 'toast';
          toast.style.cssText = `
                    position: fixed;
                    bottom: 2rem;
                    right: 2rem;
                    background: rgba(26, 26, 26, 0.98);
                    color: #FFFFFF;
                    padding: 1rem 1.5rem;
                    border-radius: 14px;
                    border: 1px solid #10A37F;
                    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.4);
                    font-size: 0.95rem;
                    font-weight: 600;
                    z-index: 10000;
                    opacity: 0;
                    transform: translateY(20px);
                    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                    pointer-events: none;
                `;
          document.body.appendChild(toast);
        }

        toast.textContent = message;
        setTimeout(() => {
          toast.style.opacity = '1';
          toast.style.transform = 'translateY(0)';
        }, 10);

        setTimeout(() => {
          toast.style.opacity = '0';
          toast.style.transform = 'translateY(20px)';
        }, 2500);
      }

      function initParticles() {
        const particlesContainer = document.getElementById('particles');
        if (!particlesContainer) return;

        particlesContainer.innerHTML = '';
        for (let i = 0; i < 30; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          particle.style.left = Math.random() * 100 + '%';
          particle.style.animationDelay = Math.random() * 10 + 's';
          particle.style.animationDuration = 10 + Math.random() * 5 + 's';
          particlesContainer.appendChild(particle);
        }
      }

      // Copy message
      window.copyMessage = async function (button) {
        const messageContent = button.closest('.message-content').querySelector('.message-text');
        const text = messageContent.innerText;

        try {
          await navigator.clipboard.writeText(text);
          const originalText = button.innerHTML;
          button.innerHTML = `
                    <svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
                    Kopyalandƒ±!
                `;
          button.style.color = '#10A37F';

          setTimeout(() => {
            button.innerHTML = originalText;
            button.style.color = '';
          }, 2000);
        } catch (error) {
          console.error('Kopyalama hatasƒ±:', error);
          alert('Kopyalama ba≈üarƒ±sƒ±z oldu!');
        }
      };

      // Regenerate message
      window.regenerateMessage = async function (button) {
        if (state.isTyping) {
          alert('L√ºtfen mevcut yanƒ±t tamamlanana kadar bekleyin.');
          return;
        }

        const messageElements = Array.from(elements.messagesContainer.querySelectorAll('.message'));
        const currentMessageEl = button.closest('.message');
        const currentIndex = messageElements.indexOf(currentMessageEl);

        let lastUserMessage = null;
        for (let i = currentIndex - 1; i >= 0; i--) {
          if (messageElements[i].classList.contains('user')) {
            const messageText = messageElements[i].querySelector('.message-text');
            lastUserMessage = messageText.innerText;
            break;
          }
        }

        if (!lastUserMessage) {
          alert('Yeniden olu≈üturulacak mesaj bulunamadƒ±!');
          return;
        }

        currentMessageEl.remove();
        const messageIndex = state.messages.findIndex(
          (msg, idx) => msg.role === 'assistant' && idx === currentIndex
        );
        if (messageIndex !== -1) {
          state.messages.splice(messageIndex, 1);
        }

        showTypingIndicator();

        try {
          // Clean history: remove timestamp property for API compatibility
          const cleanHistory = state.messages.slice(-10).map(msg => ({
            role: msg.role,
            content: msg.content,
          }));

          const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Accept-Language': 'tr-TR',
              'Content-Language': 'tr',
            },
            body: JSON.stringify({
              model: 'LYDIAN_QUANTUM', // LyDian primary engine
              message: lastUserMessage,
              temperature: 0.9,
              max_tokens: 8000, // Maximum detail
              history: cleanHistory,
              language: 'tr',
              locale: 'tr-TR',
            }),
          });

          if (!response.ok) {
            throw new Error(`API Error: ${response.status}`);
          }

          const data = await response.json();
          hideTypingIndicator();

          if (data.success && data.response) {
            addMessage('assistant', data.response);
            // DEBUG: console.log('üîÑ Message regenerated successfully');
          } else {
            throw new Error('Invalid response from API');
          }
        } catch (error) {
          console.error('‚ùå Regeneration Error:', error);
          hideTypingIndicator();
          addMessage(
            'assistant',
            `‚ö†Ô∏è **Yeniden Olu≈üturma Hatasƒ±**\n\nMesaj yeniden olu≈üturulamadƒ±.\n\n*Hata: ${error.message}*`
          );
        }
      };

      // User menu dropdown toggle
      const userMenuBtn = document.getElementById('userMenuBtn');
      const userDropdown = document.getElementById('userDropdown');

      /* DEBUG: console.log('üîç User menu elements:', {
        userMenuBtn: !!userMenuBtn,
        userDropdown: !!userDropdown,
      }); */

      if (userMenuBtn && userDropdown) {
        userMenuBtn.addEventListener('click', e => {
          e.stopPropagation();
          // DEBUG: console.log('üë§ User menu clicked');
          userDropdown.classList.toggle('active');
          userMenuBtn.classList.toggle('active');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', e => {
          if (!userMenuBtn.contains(e.target) && !userDropdown.contains(e.target)) {
            userDropdown.classList.remove('active');
            userMenuBtn.classList.remove('active');
          }
        });
        // DEBUG: console.log('‚úÖ User menu listener added');
      } else {
        console.error('‚ùå User menu elements not found');
      }

      // Sidebar search functionality
      const sidebarSearch = document.getElementById('sidebarSearch');
      if (sidebarSearch) {
        sidebarSearch.addEventListener('input', e => {
          const searchTerm = e.target.value.toLowerCase().trim();
          const chatItems = elements.chatHistory.querySelectorAll('.chat-item');

          chatItems.forEach(item => {
            const title = item.querySelector('.chat-item-title')?.textContent.toLowerCase() || '';
            const preview =
              item.querySelector('.chat-item-preview')?.textContent.toLowerCase() || '';

            if (title.includes(searchTerm) || preview.includes(searchTerm)) {
              item.style.display = '';
            } else {
              item.style.display = 'none';
            }
          });
        });
      }

      // ========== USER NAME DISPLAY ==========

      function loadUserName() {
        try {
          // Get user data from localStorage (set during login)
          const userDataStr = localStorage.getItem('lydian_user');
          if (userDataStr) {
            const userData = JSON.parse(userDataStr);
            const userName = userData.name || userData.username || 'Misafir';
            updateWelcomeText(userName);
          } else {
            // Default fallback
            updateWelcomeText('Ho≈ügeldiniz');
          }
        } catch (e) {
          console.warn('Could not load user name:', e);
          updateWelcomeText('Ho≈ügeldiniz');
        }
      }

      function updateWelcomeText(userName) {
        const welcomeUserName = document.getElementById('welcomeUserName');
        if (welcomeUserName) {
          welcomeUserName.textContent = userName;
        }
      }

      // ========== INITIALIZATION ==========

      window.addEventListener('DOMContentLoaded', () => {
        // Mobilde sidebar kapalƒ± ba≈ülasƒ±n
        if (window.innerWidth <= 768) {
          elements.sidebar.classList.add('collapsed');
        }

        // Mobile keyboard handler - SIMPLE & SAFE approach
        if (window.innerWidth <= 768) {
          const messageInput = document.getElementById('messageInput');
          const messagesContainer = document.getElementById('messagesContainer');

          if (messageInput) {
            // On focus: just scroll messages to bottom after keyboard opens
            messageInput.addEventListener('focus', () => {
              setTimeout(() => {
                if (messagesContainer) {
                  messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }
                // Ensure input is visible - simple native scroll
                messageInput.scrollIntoView({ block: 'nearest' });
              }, 350);
            });
          }
        }

        // Load saved theme
        const savedTheme = localStorage.getItem('lydian_theme') || 'dark';
        setTheme(savedTheme);

        // Initialize particles
        initParticles();

        // Load and display user name from login
        loadUserName();

        // Load chat history (only valid chat objects with id, title, messages)
        const chatKeys = Object.keys(localStorage).filter(key => key.startsWith('chat_'));
        chatKeys.forEach(key => {
          try {
            const chatData = JSON.parse(localStorage.getItem(key));
            // Validate it's a proper chat object (not shared or other data)
            if (chatData && chatData.id && chatData.messages && Array.isArray(chatData.messages)) {
              addChatToHistory(chatData);
            }
          } catch (e) {
            console.warn('Invalid chat data for key:', key);
          }
        });

        // DEBUG: console.log('üöÄ LyDian Quantum Chat initialized');
      });

      function addChatToHistory(chatData) {
        const chatItem = document.createElement('div');
        chatItem.className = 'chat-item';
        chatItem.dataset.chatId = chatData.id;
        chatItem.innerHTML = `
                <div class="chat-item-content">
                    <div class="chat-item-title">${chatData.title}</div>
                    <div class="chat-item-preview">${new Date(chatData.timestamp).toLocaleDateString('tr-TR')}</div>
                </div>
                <button class="chat-item-delete" onclick="deleteChatFromHistory('${chatData.id}', event)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                    </svg>
                </button>
            `;

        // Click handler for chat item (not delete button)
        chatItem.addEventListener('click', e => {
          if (!e.target.closest('.chat-item-delete')) {
            loadChat(chatData.id);
          }
        });

        elements.chatHistory.insertBefore(chatItem, elements.chatHistory.firstChild);
      }

      // Save current chat to localStorage
      function saveCurrentChat() {
        if (state.messages.length === 0) return;

        // Create or update chat ID
        if (!state.currentChatId) {
          state.currentChatId = `chat_${Date.now()}`;
        }

        // Get first user message as title (max 50 chars)
        const firstUserMessage = state.messages.find(msg => msg.role === 'user');
        const title = firstUserMessage
          ? firstUserMessage.content.substring(0, 50) +
            (firstUserMessage.content.length > 50 ? '...' : '')
          : 'Yeni Sohbet';

        const chatData = {
          id: state.currentChatId,
          title: title,
          timestamp: Date.now(),
          messages: state.messages,
        };

        // Save to localStorage
        localStorage.setItem(state.currentChatId, JSON.stringify(chatData));

        // Check if already in chat history UI
        const existingItem = document.querySelector(`[data-chat-id="${state.currentChatId}"]`);
        if (!existingItem) {
          // Add to chat history UI only if it's a new chat
          addChatToHistory(chatData);
        }

        // DEBUG: console.log('üíæ Chat saved:', state.currentChatId);
      }

      // Delete chat from history
      window.deleteChatFromHistory = function (chatId, event) {
        event.stopPropagation();

        if (confirm('Bu sohbeti silmek istediƒüinizden emin misiniz?')) {
          // Remove from DOM
          const chatItem = document.querySelector(`[data-chat-id="${chatId}"]`);
          if (chatItem) {
            chatItem.style.animation = 'slideOutLeft 0.3s ease';
            setTimeout(() => {
              chatItem.remove();
            }, 300);
          }

          // Remove chat data from localStorage (CRITICAL FIX)
          localStorage.removeItem(chatId);

          // Also remove from chatHistory array (if exists)
          const savedChats = JSON.parse(localStorage.getItem('chatHistory') || '[]');
          const updatedChats = savedChats.filter(chat => chat.id !== chatId);
          localStorage.setItem('chatHistory', JSON.stringify(updatedChats));

          // DEBUG: console.log('üóëÔ∏è Chat deleted:', chatId);
        }
      };

      function loadChat(chatId) {
        const chatData = JSON.parse(localStorage.getItem(chatId));
        if (chatData) {
          state.messages = chatData.messages;
          state.currentChatId = chatId;
          renderMessages();
        }
      }

      function renderMessages() {
        elements.messagesContainer.innerHTML = '';
        state.messages.forEach(msg => {
          addMessage(msg.role, msg.content);
        });
      }

      // ============================================================
      // ‚úÖ UNLIMITED GUEST ACCESS - TIMER DISABLED
      // User requested: Remove 5-minute limit, make chat unlimited
      // ============================================================
      (async function initGuestTimer() {
        // DEBUG: console.log('‚úÖ Guest chat timer DISABLED - unlimited access enabled');

        // Clear any existing timer data from localStorage
        localStorage.removeItem('guestChatStartTime');

        // No timer functionality - unlimited access for all users
        // This allows both logged-in and guest users to use chat without restrictions
        return; // Exit early - no timer needed

        // Create timer UI element with modern animated hourglass
        const timerElement = document.createElement('div');
        timerElement.className = 'guest-timer';
        timerElement.innerHTML = `
                <div class="guest-timer-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <defs>
                            <linearGradient id="hourglassGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#FF6B4A"/>
                                <stop offset="100%" style="stop-color:#FF8A6D"/>
                            </linearGradient>
                        </defs>
                        <!-- Hourglass Frame -->
                        <path d="M8 4 L24 4 L24 6 L20 10 L16 14 L20 18 L24 22 L24 24 L24 28 L8 28 L8 24 L8 22 L12 18 L16 14 L12 10 L8 6 L8 4 Z"
                              stroke="url(#hourglassGradient)" stroke-width="2" fill="none"/>
                        <!-- Top Sand -->
                        <path d="M10 6 L22 6 L18 10 L14 10 Z" fill="url(#hourglassGradient)" opacity="0.6">
                            <animate attributeName="d"
                                     dur="3s"
                                     repeatCount="indefinite"
                                     values="M10 6 L22 6 L18 10 L14 10 Z;
                                             M10 6 L22 6 L17 11 L15 11 Z;
                                             M10 6 L22 6 L16.5 12 L15.5 12 Z"/>
                        </path>
                        <!-- Bottom Sand -->
                        <path d="M10 26 L22 26 L18 22 L14 22 Z" fill="url(#hourglassGradient)" opacity="0.6">
                            <animate attributeName="d"
                                     dur="3s"
                                     repeatCount="indefinite"
                                     values="M10 26 L22 26 L18 22 L14 22 Z;
                                             M10 26 L22 26 L17 21 L15 21 Z;
                                             M10 26 L22 26 L16 19 L16 19 Z"/>
                        </path>
                        <!-- Falling Sand Particles -->
                        <circle cx="16" cy="13" r="0.5" fill="#FF6B4A">
                            <animate attributeName="cy" dur="1s" repeatCount="indefinite" values="13;18;13"/>
                            <animate attributeName="opacity" dur="1s" repeatCount="indefinite" values="1;0.3;1"/>
                        </circle>
                    </svg>
                </div>
                <div class="guest-timer-text">
                    <div class="guest-timer-label">Kalan S√ºre</div>
                    <div class="guest-timer-time" id="guestTimerDisplay">05:00</div>
                </div>
            `;
        document.body.appendChild(timerElement);

        const timerDisplay = document.getElementById('guestTimerDisplay');

        // Update countdown every second
        const countdownInterval = setInterval(() => {
          const startTime = parseInt(localStorage.getItem('guestChatStartTime'));
          const fiveMinutesInMs = 5 * 60 * 1000; // 5 minutes
          const elapsedTime = Date.now() - startTime;
          const remainingTime = fiveMinutesInMs - elapsedTime;

          // If time is up, redirect
          if (remainingTime <= 0) {
            clearInterval(countdownInterval);
            alert(
              '5 dakikalƒ±k √ºcretsiz deneme s√ºreniz doldu. Devam etmek i√ßin l√ºtfen giri≈ü yapƒ±n veya kayƒ±t olun.'
            );
            window.location.href = '/auth.html';
            return;
          }

          // Calculate minutes and seconds
          const totalSeconds = Math.floor(remainingTime / 1000);
          const minutes = Math.floor(totalSeconds / 60);
          const seconds = totalSeconds % 60;

          // Format as MM:SS
          const formattedTime = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
          timerDisplay.textContent = formattedTime;

          // Add warning state when less than 1 minute remaining
          if (remainingTime < 60000) {
            timerElement.classList.add('warning');
          }
        }, 1000);

        // Calculate initial remaining time
        const startTime = parseInt(localStorage.getItem('guestChatStartTime'));
        const fiveMinutesInMs = 5 * 60 * 1000;
        const elapsedTime = currentTime - startTime;
        const remainingTime = fiveMinutesInMs - elapsedTime;

        // If time is already up, redirect immediately
        if (remainingTime <= 0) {
          // DEBUG: console.log('‚è∞ Guest time expired - redirecting to auth page');
          alert(
            '5 dakikalƒ±k √ºcretsiz deneme s√ºreniz doldu. Devam etmek i√ßin l√ºtfen giri≈ü yapƒ±n veya kayƒ±t olun.'
          );
          window.location.href = '/auth.html';
          return;
        }

        // DEBUG: console.log(`‚è∞ Guest timer - ${Math.floor(remainingTime / 1000)} seconds remaining`);
      })();
    </script>

    <!-- Translation System -->
    <!-- <script src="/js/translation.js"></script> DISABLED -->
    <script src="/js/mobile-menu-handler.js"></script>
    <!-- Visitor Location & VPN Detection -->
    <script src="/js/visitor-info.js"></script>
    <!-- Voice Chat Module -->
    <script src="/js/voice-chat.js"></script>
    <!-- File Analyzer Module -->
    <script src="/js/file-analyzer.js"></script>
  </body>
</html>
